import"./chunk-BONXZWWT.js";import{a as ti}from"./chunk-AMCW56AE.js";import{b as ii,e as Ee}from"./chunk-RC4ZV7A2.js";import{a as Ei}from"./chunk-VILVOQXR.js";import{b as K}from"./chunk-WNVXENDG.js";import{a as I}from"./chunk-AWJWBZOU.js";import{a as ge}from"./chunk-ZU7Q4APP.js";import{m as Z}from"./chunk-LKADUWP6.js";import"./chunk-6CQPCFUJ.js";import{a as ei}from"./chunk-ODBDBKE7.js";import"./chunk-XPPSGRKL.js";import{a as Ze,h as ve}from"./chunk-4HN4PAFJ.js";import{b as Xe}from"./chunk-VT372YOS.js";import{f as He,g as We,i as _e}from"./chunk-AV73RGVI.js";import{c as q,e as Je,f as Ye}from"./chunk-N4CCYIXR.js";import{F as Ce}from"./chunk-UAEYNMJW.js";import{A as be,B as z,C as G,G as A,b as ze,c as re,e as x,g as ce,h as de,k as le,n as se,o as Ge,p as me,q as ue,r as pe,s as fe,v as Ke,x as he,z as xe}from"./chunk-YPFPCNBD.js";import{Aa as R,Ba as h,Ca as r,D as U,Da as o,Db as ae,Ea as g,H as F,Ia as M,Ja as P,Ka as m,Lb as oe,N as _,O as v,R as Ue,Ra as H,Rb as L,Sa as qe,U as S,Va as W,Xa as c,Ya as V,Za as b,_a as ne,_b as Qe,bc as Le,c as $,cb as E,da as d,ha as De,hb as Be,ia as ie,ib as $e,k as O,lb as je,na as Ae,pb as w,qb as Re,ta as k,tb as X,u as j,v as Q,va as p,wa as f,x as ke,xa as te,z as N,za as D}from"./chunk-U6U25BWF.js";import"./chunk-B3LSNZRN.js";import"./chunk-WUBXWBRT.js";import"./chunk-B52GHH4C.js";import"./chunk-KZ3CI6ZI.js";import"./chunk-HC6MZPB3.js";import"./chunk-SV2ZKNWA.js";import"./chunk-IA5KSSRM.js";import"./chunk-RS5W3JWO.js";import"./chunk-XENCGOZ2.js";import"./chunk-XZRAAXKF.js";import"./chunk-7D6K5XYM.js";import"./chunk-OBXDPQ3V.js";import"./chunk-QY5CJPR3.js";import"./chunk-MCRJI3T3.js";import"./chunk-ZD4SBDZ6.js";import"./chunk-NCLOD2DI.js";import"./chunk-UYQ7EZNZ.js";import"./chunk-BAKMWPBW.js";import"./chunk-AESNPOCP.js";import"./chunk-H3ZVKW6B.js";import"./chunk-HMK4XMX7.js";import"./chunk-E7UUDSES.js";import"./chunk-JQ3FRJ6A.js";import"./chunk-3IVKBF6N.js";import"./chunk-NMYJD6OP.js";import"./chunk-C5RQ2IC2.js";import"./chunk-SV7S5NYR.js";import{a as Ie,b as Ne,i as gi,j as C}from"./chunk-LVXXLD6S.js";var hi=gi(Ei());var Me=A.apiUrl,ni=a=>C(null,null,function*(){return O(a.get(`${Me}/beneficiarios`))}),ai=(a,l)=>C(null,null,function*(){return O(a.post(`${Me}/beneficiarios`,l))}),oi=(a,l)=>C(null,null,function*(){return O(a.delete(`${Me}/beneficiarios/${l}`))});var Si=A.apiUrl,ri=(a,l)=>C(null,null,function*(){let t=`${Si}/usuarios/cambiar-password`;return O(a.put(t,l))});var Fi=A.apiUrl,ci=(a,l)=>C(null,null,function*(){let t=`${Fi}/usuarios/${l}`;return O(a.get(t))});var yi=A.apiUrl,di=(a,l)=>C(null,null,function*(){let t=new URLSearchParams;l.tipo_documento_id!==void 0&&t.set("tipo_documento_id",String(l.tipo_documento_id)),t.set("numero_documento",l.numero_documento);let e=`${yi}/personas/facturacion?${t.toString()}`;return yield O(a.get(e))});var li=(()=>{let l=class l{constructor(){this.http=F(L),this.alertaService=F(ge),this.queryClient=F(be),this.authService=F(Ye),this._i18nDatePicker=S(Ze),this.i18nDatePicker=this._i18nDatePicker.asReadonly(),this.perfilQuery=G(()=>({queryKey:["perfil",this.authService.usuario()?.id],queryFn:()=>C(this,null,function*(){let e=this.authService.usuario()?.id;if(!e)throw new Error("Usuario no autenticado");let{data:n}=yield ci(this.http,e);if(!n)throw new Error("No se pudo obtener el perfil del usuario");return n}),enabled:w(()=>!!this.authService.usuario()?.id),staleTime:5*60*1e3,gcTime:10*60*1e3})),this.ciudadesQuery=G(()=>({queryKey:["ciudades"],queryFn:()=>He(this.http),staleTime:30*60*1e3,gcTime:60*60*1e3})),this.regimenesTributariosQuery=G(()=>({queryKey:["regimenes-tributarios"],queryFn:()=>We(this.http),select:e=>e,staleTime:60*60*1e3,gcTime:2*60*60*1e3})),this.actualizarPerfilMutation=z(()=>({mutationFn:e=>C(this,null,function*(){return yield ii(this.http,e,!0,!0)}),onSuccess:(e,n)=>{this.queryClient.invalidateQueries({queryKey:["perfil"]}),this.queryClient.setQueryData(["perfil",n.id],n)},onError:e=>{console.error("Error al actualizar el perfil:",e)}})),this.cambiarPasswordMutation=z(()=>({mutationFn:e=>C(this,null,function*(){return yield ri(this.http,e)}),onSuccess:e=>{},onError:e=>{throw console.error("Error al cambiar la contrase\xF1a:",e),e}})),this.usuario=w(()=>this.perfilQuery.data()),this.ciudades=w(()=>this.ciudadesQuery.data()?.data||[]),this.ciudadesCargando=w(()=>this.ciudadesQuery.isLoading()),this.ciudadesError=w(()=>this.ciudadesQuery.error()),this.regimenesTributarios=w(()=>this.regimenesTributariosQuery.data()?.data||[]),this.regimenesTributariosCargando=w(()=>this.regimenesTributariosQuery.isLoading()),this.regimenesTributariosError=w(()=>this.regimenesTributariosQuery.error()),this.cargando=w(()=>this.perfilQuery.isLoading()||this.actualizarPerfilMutation.isPending()||this.cambiarPasswordMutation.isPending()),this.error=w(()=>this.perfilQuery.error())}obtenerPerfilUsuario(){return C(this,null,function*(){try{return yield this.perfilQuery.refetch(),this.perfilQuery.data()||null}catch(e){return console.error("Error al obtener el perfil:",e),null}})}actualizarPerfil(e){return C(this,null,function*(){try{return yield this.actualizarPerfilMutation.mutateAsync(e),!0}catch(n){return console.error("Error al actualizar el perfil:",n),!1}})}invalidarPerfil(){this.queryClient.invalidateQueries({queryKey:["perfil"]})}refrescarPerfil(){return C(this,null,function*(){return yield this.perfilQuery.refetch()})}cambiarPassword(e){return C(this,null,function*(){try{let n=yield this.cambiarPasswordMutation.mutateAsync(e);if(n.status==="success")return!0;throw new Error(n.message||n.error||"Error al cambiar la contrase\xF1a")}catch(n){throw console.error("Error al cambiar la contrase\xF1a:",n),n?.error?.message?new Error(n.error.message):n?.message?new Error(n.message):new Error("Error al cambiar la contrase\xF1a. Por favor, int\xE9ntalo de nuevo.")}})}filtrarCiudades(e){let n=this.ciudades();return!e||e.trim()===""?n:n.filter(i=>i.nombre.toLowerCase().includes(e.toLowerCase()))}buscarCiudadPorId(e){return this.ciudades().find(n=>n.id===e)}buscarCiudadPorNombre(e){return this.ciudades().find(n=>n.nombre.toLowerCase()===e.toLowerCase())}refrescarCiudades(){return C(this,null,function*(){return yield this.ciudadesQuery.refetch()})}invalidarCiudades(){this.queryClient.invalidateQueries({queryKey:["ciudades"]})}buscarPersonaFact(e){return C(this,null,function*(){try{return(yield di(this.http,e)).data||null}catch(n){throw console.error("Error buscando persona de facturaci\xF3n:",n),n}})}};l.\u0275fac=function(n){return new(n||l)},l.\u0275prov=U({token:l,factory:l.\u0275fac,providedIn:"root"});let a=l;return a})();var si=(()=>{let l=class l{constructor(){if(this.bc=null,this.STORE_NAME="kv",this.DB_NAME="app-storage",this.DB_VERSION=1,this.dbPromise=this.initDB(),typeof BroadcastChannel<"u")try{this.bc=new BroadcastChannel("storage-events")}catch{this.bc=null}}getItem(e){return C(this,null,function*(){let n=yield this.dbPromise;return new Promise((i,s)=>{let B=n.transaction(this.STORE_NAME,"readonly").objectStore(this.STORE_NAME).get(e);B.onsuccess=()=>{let Se=B.result;i(Se?.value??null)},B.onerror=()=>s(B.error)})})}setItem(e,n){return C(this,null,function*(){let s=(yield this.dbPromise).transaction(this.STORE_NAME,"readwrite");s.objectStore(this.STORE_NAME).put({key:e,value:n}),yield this.waitTx(s),this.broadcast({key:e,newValue:n})})}removeItem(e){return C(this,null,function*(){let i=(yield this.dbPromise).transaction(this.STORE_NAME,"readwrite");i.objectStore(this.STORE_NAME).delete(e),yield this.waitTx(i),this.broadcast({key:e,newValue:null})})}clear(){return C(this,null,function*(){let n=(yield this.dbPromise).transaction(this.STORE_NAME,"readwrite");n.objectStore(this.STORE_NAME).clear(),yield this.waitTx(n)})}getJSON(e){return C(this,null,function*(){let n=yield this.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch(i){return console.error(`[IndexedDbService] Error parsing JSON for key: ${e}`,i),null}})}setJSON(e,n){return C(this,null,function*(){yield this.setItem(e,JSON.stringify(n))})}listen(e){if(!this.bc)return()=>{};let n=i=>{let s=i.data;s?.key&&e(s)};return this.bc.addEventListener("message",n),()=>this.bc?.removeEventListener("message",n)}broadcast(e){try{this.bc?.postMessage(e)}catch{}}initDB(){return new Promise((e,n)=>{let i=indexedDB.open(this.DB_NAME,this.DB_VERSION);i.onupgradeneeded=()=>{let s=i.result;s.objectStoreNames.contains(this.STORE_NAME)||s.createObjectStore(this.STORE_NAME,{keyPath:"key"})},i.onsuccess=()=>e(i.result),i.onerror=()=>n(i.error),i.onblocked=()=>console.warn("[IndexedDbService] Database open blocked")})}waitTx(e){return new Promise((n,i)=>{e.oncomplete=()=>n(),e.onerror=()=>i(e.error||new Error("IndexedDB transaction error")),e.onabort=()=>i(e.error||new Error("IndexedDB transaction aborted"))})}};l.\u0275fac=function(n){return new(n||l)},l.\u0275prov=U({token:l,factory:l.\u0275fac,providedIn:"root"});let a=l;return a})();var mi=(()=>{let l=class l{constructor(){this.idb=F(si)}setPerfilCompletado(e){return C(this,null,function*(){try{yield this.idb.setJSON(q.PROFILE_COMPLETED,e)}catch(n){console.error("Error guardando estado del perfil:",n)}})}obtenerPerfilCompletado(){return C(this,null,function*(){try{return yield this.idb.getJSON(q.PROFILE_COMPLETED)}catch(e){return console.error("Error obteniendo estado del perfil:",e),null}})}setTerminosAceptados(e){return C(this,null,function*(){try{yield this.idb.setJSON(q.TERMS_ACCEPTED,e)}catch(n){console.error("Error guardando estado de t\xE9rminos:",n)}})}getTerminosAceptados(){return C(this,null,function*(){try{return yield this.idb.getJSON(q.TERMS_ACCEPTED)}catch(e){return console.error("Error obteniendo estado de t\xE9rminos:",e),null}})}isComingFromLogin(){return C(this,null,function*(){let[e,n]=yield Promise.all([this.obtenerPerfilCompletado(),this.getTerminosAceptados()]);return e===null&&n===null})}limpiarEstadosValidacion(){return C(this,null,function*(){try{yield Promise.all([this.idb.removeItem(q.PROFILE_COMPLETED),this.idb.removeItem(q.TERMS_ACCEPTED)])}catch(e){console.error("Error limpiando estados de validaci\xF3n:",e)}})}tieneEstadosValidos(){return C(this,null,function*(){let[e,n]=yield Promise.all([this.obtenerPerfilCompletado(),this.getTerminosAceptados()]);return e!==null&&n!==null})}};l.\u0275fac=function(n){return new(n||l)},l.\u0275prov=U({token:l,factory:l.\u0275fac,providedIn:"root"});let a=l;return a})();var ui=(()=>{let l=class l{constructor(){this.http=F(L),this.queryClient=F(be),this.beneficiariosQuery=G(()=>({queryKey:["beneficiarios"],queryFn:()=>ni(this.http),select:e=>e?.data??[],staleTime:5*60*1e3})),this.crearMutation=z(()=>({mutationFn:e=>C(this,null,function*(){return yield ai(this.http,e)}),onSuccess:e=>{this.queryClient.invalidateQueries({queryKey:["beneficiarios"]})}})),this.eliminarMutation=z(()=>({mutationFn:e=>C(this,null,function*(){return yield oi(this.http,e)}),onSuccess:()=>{this.queryClient.invalidateQueries({queryKey:["beneficiarios"]})}})),this.lista=w(()=>this.beneficiariosQuery.data()),this.isLoading=w(()=>this.beneficiariosQuery.isLoading()),this.isFetching=w(()=>this.beneficiariosQuery.isFetching()),this.error=w(()=>this.beneficiariosQuery.error()),this.restantes=w(()=>Math.max(0,5-(this.lista()?.length??0)))}};l.\u0275fac=function(n){return new(n||l)},l.\u0275prov=U({token:l,factory:l.\u0275fac,providedIn:"root"});let a=l;return a})();var Ve=a=>({"input input-bordered h-11 rounded-box":!0,"input-error":a}),pi=a=>({"select input-bordered h-11 rounded-box":!0,"input-error":a});function Ti(a,l){if(a&1&&(r(0,"div",20),c(1),o()),a&2){let t=m(2);d(),b(" ",t.formUtils.obtenerErrorDelCampo(t.form,"nombre")," ")}}function Ii(a,l){if(a&1&&(r(0,"div",20),c(1),o()),a&2){let t=m(2);d(),b(" ",t.formUtils.obtenerErrorDelCampo(t.form,"apellido")," ")}}function Di(a,l){if(a&1&&(r(0,"option",24),c(1),o()),a&2){let t=l.$implicit;h("value",t.id),d(),ne(" ",t.codigo," - ",t.nombre," ")}}function Ri(a,l){if(a&1&&(r(0,"div",20),c(1),o()),a&2){let t=m(2);d(),b(" ",t.formUtils.obtenerErrorDelCampo(t.form,"tipoDocumento")," ")}}function Mi(a,l){if(a&1&&(r(0,"div",20),c(1),o()),a&2){let t=m(2);d(),b(" ",t.formUtils.obtenerErrorDelCampo(t.form,"documento")," ")}}function Vi(a,l){if(a&1&&(r(0,"div",20),c(1),o()),a&2){let t=m(2);d(),b(" ",t.formUtils.obtenerErrorDelCampo(t.form,"parentesco")," ")}}function Oi(a,l){a&1&&g(0,"span",39)}function Ni(a,l){if(a&1){let t=M();r(0,"div",4)(1,"div",14)(2,"form",15),P("ngSubmit",function(){_(t);let n=m();return v(n.guardar())}),r(3,"div",16)(4,"label",17),c(5,"Nombre "),r(6,"span",18),c(7,"*"),o()(),g(8,"input",19),p(9,Ti,2,1,"div",20),o(),r(10,"div",16)(11,"label",17),c(12,"Apellido "),r(13,"span",18),c(14,"*"),o()(),g(15,"input",21),p(16,Ii,2,1,"div",20),o(),r(17,"div",16)(18,"label",17),c(19,"Tipo Doc. "),r(20,"span",18),c(21,"*"),o()(),r(22,"select",22)(23,"option",23),c(24,"Seleccione"),o(),D(25,Di,2,3,"option",24,te),o(),p(27,Ri,2,1,"div",20),o(),r(28,"div",16)(29,"label",17),c(30,"Documento "),r(31,"span",18),c(32,"*"),o()(),g(33,"input",25),p(34,Mi,2,1,"div",20),o(),r(35,"div",26)(36,"label",17),c(37,"Parentesco "),r(38,"span",18),c(39,"*"),o()(),r(40,"select",27)(41,"option",23),c(42,"Seleccione"),o(),r(43,"optgroup",28)(44,"option",29),c(45,"Padre"),o(),r(46,"option",30),c(47,"Madre"),o(),r(48,"option",31),c(49,"Hijo(a)"),o()(),r(50,"optgroup",32)(51,"option",33),c(52,"Hermano(a)"),o(),r(53,"option",34),c(54,"Abuelo(a)"),o(),r(55,"option",35),c(56,"Nieto(a)"),o()()(),p(57,Vi,2,1,"div",20),o(),r(58,"div",36)(59,"button",37),P("click",function(){_(t);let n=m();return v(n.cancelar())}),c(60," Cancelar "),o(),r(61,"button",38),p(62,Oi,1,0,"span",39),c(63," Guardar "),o()()()()()}if(a&2){let t=m();d(2),h("formGroup",t.form),d(6),h("ngClass",E(13,Ve,t.esInvalido("nombre"))),d(),f(t.esInvalido("nombre")?9:-1),d(6),h("ngClass",E(15,Ve,t.esInvalido("apellido"))),d(),f(t.esInvalido("apellido")?16:-1),d(6),h("ngClass",E(17,pi,t.esInvalido("tipoDocumento"))),d(3),R(t.appService.tipoDocQuery.data()),d(2),f(t.esInvalido("tipoDocumento")?27:-1),d(6),h("ngClass",E(19,Ve,t.esInvalido("documento"))),d(),f(t.esInvalido("documento")?34:-1),d(6),h("ngClass",E(21,pi,t.esInvalido("parentesco"))),d(17),f(t.esInvalido("parentesco")?57:-1),d(4),h("disabled",t.form.invalid||t.creando()),d(),f(t.creando()?62:-1)}}function ki(a,l){a&1&&(r(0,"div",8),g(1,"span",40),c(2," Cargando... "),o())}function Ui(a,l){a&1&&(r(0,"div",9),c(1,"No hay beneficiarios"),o())}function Ai(a,l){a&1&&g(0,"span",39)}function qi(a,l){if(a&1){let t=M();r(0,"div",4)(1,"div",14)(2,"div",41)(3,"div",42)(4,"div",43)(5,"span",44),c(6,"Nombre: "),o(),r(7,"span",45),c(8),o()(),r(9,"div",43)(10,"span",44),c(11,"Apellido: "),o(),r(12,"span",45),c(13),o()(),r(14,"div",43)(15,"span",44),c(16,"Tipo Doc.: "),o(),r(17,"span",46),c(18),o()(),r(19,"div",43)(20,"span",44),c(21,"Documento: "),o(),r(22,"span",47),c(23),o()(),r(24,"div",43)(25,"span",44),c(26,"Parentesco: "),o(),r(27,"span",48),c(28),o()()(),r(29,"div",49)(30,"button",50),P("click",function(){let n=_(t).$implicit,i=m(2);return v(i.eliminar(n.id))}),p(31,Ai,1,0,"span",39),g(32,"app-web-icon",51),o()()()()()}if(a&2){let t=l.$implicit,e=m(2);d(8),V(t.nombre),d(5),V(t.apellido),d(5),V(t.tipo_documento.codigo),d(5),V(t.documento),d(5),V(t.parentesco),d(2),h("disabled",e.eliminandoId()===t.id),d(),f(e.eliminandoId()===t.id?31:-1)}}function Bi(a,l){if(a&1&&(r(0,"div",10),D(1,qi,33,7,"div",4,te),o()),a&2){let t=m();d(),R(t.lista())}}function $i(a,l){a&1&&(r(0,"tr")(1,"td",52),g(2,"span",53),c(3," Cargando... "),o()())}function ji(a,l){a&1&&(r(0,"tr")(1,"td",52),c(2,"No hay beneficiarios"),o()())}function Qi(a,l){a&1&&g(0,"span",39)}function Li(a,l){if(a&1){let t=M();r(0,"tr")(1,"td",54),c(2),o(),r(3,"td",54),c(4),o(),r(5,"td",55),c(6),o(),r(7,"td",56),c(8),o(),r(9,"td",57),c(10),o(),r(11,"td",58)(12,"button",50),P("click",function(){let n=_(t).$implicit,i=m();return v(i.eliminar(n.id))}),p(13,Qi,1,0,"span",39),g(14,"app-web-icon",51),o()()()}if(a&2){let t=l.$implicit,e=m();d(2),V(t.nombre),d(2),V(t.apellido),d(2),b(" ",t.tipo_documento.codigo," "),d(2),b(" ",t.documento," "),d(2),V(t.parentesco),d(2),h("disabled",e.eliminandoId()===t.id),d(),f(e.eliminandoId()===t.id?13:-1)}}var fi=(()=>{let l=class l{constructor(){this.fb=F(he),this.svc=F(ui),this.appService=F(_e),this.formUtils=I,this.mostrandoFormulario=S(!1),this.eliminandoId=S(null),this.form=this.fb.group({nombre:["",[x.required]],apellido:["",[x.required]],tipoDocumento:["",[x.required]],documento:["",[x.required,x.pattern(I.patronSoloNumeros),x.minLength(7)]],parentesco:["",[x.required]]})}get lista(){return this.svc.lista}get cargando(){return this.svc.isFetching}get restantes(){return this.svc.restantes}get creando(){return this.svc.crearMutation.isPending}esInvalido(e){return this.formUtils.esCampoInvalido(this.form,e)}abrirFormulario(){this.mostrandoFormulario.set(!0)}cancelar(){this.mostrandoFormulario.set(!1),this.form.reset()}tdCodigo(e){let i=(this.appService.tipoDocQuery.data()||[]).find(s=>s.id===e||s.codigo===e);return i?`${i.codigo}`:e}guardar(){return C(this,null,function*(){if(this.form.invalid){this.form.markAllAsTouched();return}if(this.restantes()===0)return;let e=this.form.value;try{yield this.svc.crearMutation.mutateAsync(e),this.cancelar()}catch{}})}eliminar(e){return C(this,null,function*(){this.eliminandoId.set(e);try{yield this.svc.eliminarMutation.mutateAsync(e)}finally{this.eliminandoId.set(null)}})}};l.\u0275fac=function(n){return new(n||l)},l.\u0275cmp=ie({type:l,selectors:[["app-beneficiarios"]],decls:34,vars:7,consts:[[1,"flex","flex-col","gap-3"],[1,"flex","items-center","justify-between"],[1,"text-lg","font-semibold"],[1,"text-sm","opacity-80"],[1,"card","bg-base-100","shadow-sm"],[1,"flex","justify-end","mb-2"],[1,"btn","btn-primary","max-sm:btn-sm","sm:h-11",3,"click","disabled"],[1,"sm:hidden"],[1,"flex","items-center","justify-center","py-6"],[1,"text-center","py-6"],[1,"space-y-3"],[1,"hidden","sm:block"],[1,"table","table-fixed","w-full"],[1,"text-right"],[1,"card-body","p-3"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-3",3,"ngSubmit","formGroup"],[1,"flex","flex-col"],[1,"label","text-sm","font-[600]"],[1,"text-error"],["type","text","formControlName","nombre",3,"ngClass"],[1,"text-xs","text-error"],["type","text","formControlName","apellido",3,"ngClass"],["formControlName","tipoDocumento",3,"ngClass"],["value","","disabled","","selected",""],[3,"value"],["type","text","inputSoloNumeros","","formControlName","documento",3,"ngClass"],[1,"flex","flex-col","md:col-span-2"],["formControlName","parentesco",3,"ngClass"],["label","Primer grado"],["value","padre"],["value","madre"],["value","hijo"],["label","Segundo grado"],["value","hermano"],["value","abuelo"],["value","nieto"],[1,"md:col-span-2","flex","justify-end","gap-2"],["type","button",1,"btn","max-sm:btn-sm","btn-ghost","sm:h-11",3,"click"],["type","submit",1,"btn","max-sm:btn-sm","btn-primary","sm:h-11",3,"disabled"],[1,"loading","loading-spinner","loading-sm","mr-1"],[1,"loading","loading-spinner","loading-sm","mr-2"],[1,"flex","justify-between","items-start","gap-3"],[1,"flex-1","space-y-1"],[1,"text-sm"],[1,"opacity-70"],[1,"font-medium","break-words"],[1,"font-semibold"],[1,"font-semibold","break-all"],[1,"capitalize"],[1,"flex","items-center"],[1,"btn","btn-error","btn-soft","btn-xs","btn-square",3,"click","disabled"],["nombreIcono","trash-outline","estilos","w-5 h-5"],["colspan","6",1,"text-center"],[1,"loading","loading-spinner","loading-sm"],[1,"whitespace-normal","break-words"],[1,"whitespace-normal","font-semibold"],[1,"whitespace-normal","font-semibold","break-all"],[1,"whitespace-normal","capitalize"],[1,"text-right","whitespace-normal"]],template:function(n,i){if(n&1&&(r(0,"div",0)(1,"div",1),g(2,"h3",2),r(3,"div",3),c(4),o()(),p(5,Ni,64,23,"div",4),r(6,"div",5)(7,"button",6),P("click",function(){return i.mostrandoFormulario()?i.cancelar():i.abrirFormulario()}),c(8),o()(),r(9,"div",7),p(10,ki,3,0,"div",8)(11,Ui,2,0,"div",9)(12,Bi,3,0,"div",10),o(),r(13,"div",11)(14,"table",12)(15,"thead")(16,"tr")(17,"th"),c(18,"Nombre"),o(),r(19,"th"),c(20,"Apellido"),o(),r(21,"th"),c(22,"Tipo Doc."),o(),r(23,"th"),c(24,"Documento"),o(),r(25,"th"),c(26,"Parentesco"),o(),r(27,"th",13),c(28,"Acciones"),o()()(),r(29,"tbody"),p(30,$i,4,0,"tr"),p(31,ji,3,0,"tr"),D(32,Li,15,7,"tr",null,te),o()()()()),n&2){let s,u;d(4),b(" Puedes agregar ",i.restantes()," beneficiarios m\xE1s "),d(),f(i.mostrandoFormulario()?5:-1),d(2),h("disabled",i.restantes()===0),d(),b(" ",i.mostrandoFormulario()?"Cerrar":"Crear beneficiario"," "),d(2),f(i.cargando()?10:(((s=i.lista())==null?null:s.length)??0)===0?11:12),d(20),f(i.cargando()?30:-1),d(),f(!i.cargando()&&(((u=i.lista())==null?null:u.length)??0)===0?31:-1),d(),R(i.lista())}},dependencies:[oe,ae,xe,le,pe,fe,re,ue,ce,de,se,me,Ce,Ee,ve],encapsulation:2});let a=l;return a})();var zi=["fechaNacimientoPicker"],Gi=["contenedorCalendario"],Ki=["alertaPerfil"],Ji=["inputAvatar"],T=a=>({"input input-bordered w-full h-11 rounded-box placeholder:text-gray-400 placeholder:text-xs md:placeholder:text-sm":!0,"input-error":a}),Yi=a=>({"pika-single grow w-full h-11 rounded-box placeholder:text-xs md:placeholder:text-sm":!0,"input-error":a}),J=a=>({"select input-bordered w-full h-11 rounded-box placeholder:text-gray-400 placeholder:text-xs md:placeholder:text-sm":!0,"input-error":a}),xi=a=>({"input input-bordered w-full h-11 rounded-box placeholder:text-gray-400 placeholder:accent-base-300 placeholder:text-sm":!0,"input-error":a}),Oe=a=>({"input input-bordered w-full h-11 rounded-box placeholder:text-gray-400 placeholder:text-sm":!0,"input-error":a}),Y=(a,l)=>l.id,bi=(a,l)=>l.codigo;function Hi(a,l){if(a&1&&c(0),a&2){let t=l;ne(" ",t.nombre," ",t.apellido," ")}}function Wi(a,l){a&1&&c(0," Cargando... ")}function Xi(a,l){a&1&&(c(0),Be(1,"upperFirst")),a&2&&b(" ",$e(1,1,l.tipoUsuario[0])," ")}function Zi(a,l){a&1&&c(0," - ")}function et(a,l){a&1&&(r(0,"div",24)(1,"div",91),g(2,"app-web-icon",92),r(3,"div")(4,"h3",93),c(5,"Completa tu perfil"),o(),r(6,"div",94),c(7," Para continuar usando la aplicaci\xF3n, necesitas completar toda tu informaci\xF3n personal. "),o()()()())}function it(a,l){if(a&1&&(r(0,"div",32),c(1),o()),a&2){let t=m();d(),b(" ",t.formUtils.obtenerErrorDelCampo(t.perfilForm,"nombre")," ")}}function tt(a,l){if(a&1&&(r(0,"div",32),c(1),o()),a&2){let t=m();d(),b(" ",t.formUtils.obtenerErrorDelCampo(t.perfilForm,"apellido")," ")}}function nt(a,l){if(a&1&&(r(0,"div",32),c(1),o()),a&2){let t=m();d(),b(" ",t.formUtils.obtenerErrorDelCampo(t.perfilForm,"telefono")," ")}}function at(a,l){if(a&1&&(r(0,"div",32),c(1),o()),a&2){let t=m();d(),b(" ",t.formUtils.obtenerErrorDelCampo(t.perfilForm,"fechaNacimiento")," ")}}function ot(a,l){if(a&1&&(r(0,"option",50),c(1),o()),a&2){let t=l.$implicit;h("value",t.id),d(),b(" ",`${t.codigo} - ${t.nombre}`," ")}}function rt(a,l){if(a&1&&(r(0,"div",32),c(1),o()),a&2){let t=m();d(),b(" ",t.formUtils.obtenerErrorDelCampo(t.perfilForm,"tipoDocumento")," ")}}function ct(a,l){if(a&1&&(r(0,"div",32),c(1),o()),a&2){let t=m();d(),b(" ",t.formUtils.obtenerErrorDelCampo(t.perfilForm,"documento")," ")}}function dt(a,l){if(a&1){let t=M();r(0,"div",96),P("click",function(){let n=_(t).$implicit,i=m(2);return v(i.seleccionarCiudad(n))}),c(1),o()}if(a&2){let t=l.$implicit,e=l.$index,n=m(2);W("highlighted",e===n.indiceOpcionSeleccionada()),h("id","ciudad-option-"+e),k("aria-selected",e===n.indiceOpcionSeleccionada()),d(),b(" ",t.nombre," ")}}function lt(a,l){if(a&1&&(r(0,"div",57),D(1,dt,2,5,"div",95,Y),o()),a&2){let t=m();d(),R(t.ciudadesFiltradas())}}function st(a,l){a&1&&(r(0,"div",58)(1,"div",97),c(2," No se encontraron ciudades "),o()())}function mt(a,l){if(a&1&&(r(0,"div",32),c(1),o()),a&2){let t=m();d(),b(" ",t.formUtils.obtenerErrorDelCampo(t.perfilForm,"ciudadExpedicion")," ")}}function ut(a,l){if(a&1&&(r(0,"div",32),c(1),o()),a&2){let t=m();d(),b(" ",t.formUtils.obtenerErrorDelCampo(t.perfilForm,"email")," ")}}function pt(a,l){if(a&1&&(r(0,"div",32),c(1),o()),a&2){let t=m();d(),b(" ",t.formUtils.obtenerErrorDelCampo(t.perfilForm,"direccion")," ")}}function ft(a,l){if(a&1){let t=M();r(0,"div",96),P("click",function(){let n=_(t).$implicit,i=m(2);return v(i.seleccionarCiudadResidencia(n))}),c(1),o()}if(a&2){let t=l.$implicit,e=l.$index,n=m(2);W("highlighted",e===n.indiceOpcionSeleccionadaResidencia()),h("id","ciudad-residencia-option-"+e),k("aria-selected",e===n.indiceOpcionSeleccionadaResidencia()),d(),b(" ",t.nombre," ")}}function ht(a,l){if(a&1&&(r(0,"div",57),D(1,ft,2,5,"div",95,Y),o()),a&2){let t=m();d(),R(t.ciudadesResidenciaFiltradas())}}function xt(a,l){a&1&&(r(0,"div",58)(1,"div",97),c(2," No se encontraron ciudades "),o()())}function bt(a,l){if(a&1&&(r(0,"div",32),c(1),o()),a&2){let t=m();d(),b(" ",t.formUtils.obtenerErrorDelCampo(t.perfilForm,"ciudadResidencia")," ")}}function Ct(a,l){if(a&1&&(r(0,"div",32),c(1),o()),a&2){let t=m();d(),b(" ",t.formUtils.obtenerErrorDelCampo(t.perfilForm,"tipoPersona")," ")}}function _t(a,l){a&1&&c(0," Cargando... ")}function vt(a,l){a&1&&c(0," Seleccione ")}function gt(a,l){if(a&1&&(r(0,"option",50),c(1),o()),a&2){let t=l.$implicit;h("value",t.codigo),d(),b(" ",t.nombre," ")}}function Et(a,l){if(a&1&&(r(0,"div",32),c(1),o()),a&2){let t=m();d(),b(" ",t.formUtils.obtenerErrorDelCampo(t.perfilForm,"regimenTributario")," ")}}function St(a,l){a&1&&(r(0,"div",71),c(1," Error al cargar reg\xEDmenes tributarios. Por favor, recarga la p\xE1gina. "),o())}function Ft(a,l){if(a&1&&(r(0,"option",50),c(1),o()),a&2){let t=l.$implicit;h("value",t.id),d(),b(" ",`${t.codigo} - ${t.nombre}`," ")}}function yt(a,l){if(a&1&&(r(0,"div",32),c(1),o()),a&2){let t=m(2);d(),b(" ",t.formUtils.obtenerErrorDelCampo(t.facturacionForm,"tipoDocumento")," ")}}function Pt(a,l){if(a&1&&(r(0,"div",32),c(1),o()),a&2){let t=m(2);d(),b(" ",t.formUtils.obtenerErrorDelCampo(t.facturacionForm,"documento")," ")}}function wt(a,l){if(a&1&&(r(0,"div",32),c(1),o()),a&2){let t=m(3);d(),b(" ",t.formUtils.obtenerErrorDelCampo(t.facturacionForm,"digitoVerificacion")," ")}}function Tt(a,l){if(a&1&&(r(0,"div",102)(1,"label",124),c(2," DV "),r(3,"span",30),c(4,"*"),o()(),g(5,"input",125),p(6,wt,2,1,"div",32),o()),a&2){let t=m(2);d(5),h("ngClass",E(2,T,t.formUtils.esCampoInvalido(t.facturacionForm,"digitoVerificacion"))),d(),f(t.formUtils.esCampoInvalido(t.facturacionForm,"digitoVerificacion")?6:-1)}}function It(a,l){if(a&1){let t=M();r(0,"div",96),P("click",function(){let n=_(t).$implicit,i=m(3);return v(i.seleccionarCiudadFactExpedicion(n))}),c(1),o()}if(a&2){let t=l.$implicit,e=l.$index,n=m(3);W("highlighted",e===n.indiceOpcionSeleccionadaFactExpedicion()),h("id","ciudad-fact-exp-option-"+e),k("aria-selected",e===n.indiceOpcionSeleccionadaFactExpedicion()),d(),b(" ",t.nombre," ")}}function Dt(a,l){if(a&1&&(r(0,"div",57),D(1,It,2,5,"div",95,Y),o()),a&2){let t=m(2);d(),R(t.ciudadesFactFiltradasExpedicion())}}function Rt(a,l){a&1&&(r(0,"div",58)(1,"div",97),c(2," No se encontraron ciudades "),o()())}function Mt(a,l){if(a&1&&(r(0,"div",32),c(1),o()),a&2){let t=m(2);d(),b(" ",t.formUtils.obtenerErrorDelCampo(t.facturacionForm,"ciudadExpedicion")," ")}}function Vt(a,l){if(a&1&&(r(0,"div",32),c(1),o()),a&2){let t=m(2);d(),b(" ",t.formUtils.obtenerErrorDelCampo(t.facturacionForm,"nombre")," ")}}function Ot(a,l){if(a&1&&(r(0,"div",32),c(1),o()),a&2){let t=m(2);d(),b(" ",t.formUtils.obtenerErrorDelCampo(t.facturacionForm,"apellido")," ")}}function Nt(a,l){if(a&1&&(r(0,"div",32),c(1),o()),a&2){let t=m(2);d(),b(" ",t.formUtils.obtenerErrorDelCampo(t.facturacionForm,"telefono")," ")}}function kt(a,l){if(a&1&&(r(0,"div",32),c(1),o()),a&2){let t=m(2);d(),b(" ",t.formUtils.obtenerErrorDelCampo(t.facturacionForm,"email")," ")}}function Ut(a,l){if(a&1&&(r(0,"div",32),c(1),o()),a&2){let t=m(2);d(),b(" ",t.formUtils.obtenerErrorDelCampo(t.facturacionForm,"direccion")," ")}}function At(a,l){if(a&1){let t=M();r(0,"div",96),P("click",function(){let n=_(t).$implicit,i=m(3);return v(i.seleccionarCiudadFactResidencia(n))}),c(1),o()}if(a&2){let t=l.$implicit,e=l.$index,n=m(3);W("highlighted",e===n.indiceOpcionSeleccionadaFactResidencia()),h("id","ciudad-fact-res-option-"+e),k("aria-selected",e===n.indiceOpcionSeleccionadaFactResidencia()),d(),b(" ",t.nombre," ")}}function qt(a,l){if(a&1&&(r(0,"div",57),D(1,At,2,5,"div",95,Y),o()),a&2){let t=m(2);d(),R(t.ciudadesFactFiltradasResidencia())}}function Bt(a,l){a&1&&(r(0,"div",58)(1,"div",97),c(2," No se encontraron ciudades "),o()())}function $t(a,l){if(a&1&&(r(0,"div",32),c(1),o()),a&2){let t=m(2);d(),b(" ",t.formUtils.obtenerErrorDelCampo(t.facturacionForm,"ciudadResidencia")," ")}}function jt(a,l){if(a&1&&(r(0,"div",32),c(1),o()),a&2){let t=m(2);d(),b(" ",t.formUtils.obtenerErrorDelCampo(t.facturacionForm,"tipoPersona")," ")}}function Qt(a,l){a&1&&c(0," Cargando... ")}function Lt(a,l){a&1&&c(0," Seleccione ")}function zt(a,l){if(a&1&&(r(0,"option",50),c(1),o()),a&2){let t=l.$implicit;h("value",t.codigo),d(),V(t.nombre)}}function Gt(a,l){if(a&1&&(r(0,"div",32),c(1),o()),a&2){let t=m(2);d(),b(" ",t.formUtils.obtenerErrorDelCampo(t.facturacionForm,"regimenTributario")," ")}}function Kt(a,l){a&1&&(r(0,"div",71),c(1," Error al cargar reg\xEDmenes tributarios. Por favor, recarga la p\xE1gina. "),o())}function Jt(a,l){if(a&1){let t=M();r(0,"fieldset",76)(1,"legend",44),c(2," Informaci\xF3n de Facturaci\xF3n "),o(),r(3,"div",45)(4,"div",46)(5,"label",98),c(6," Tipo Doc. "),r(7,"span",30),c(8,"*"),o()(),r(9,"select",99)(10,"option",49),c(11,"Seleccione"),o(),D(12,Ft,2,2,"option",50,Y),o(),p(14,yt,2,1,"div",32),o(),r(15,"div",51)(16,"label",100),c(17," Documento "),r(18,"span",30),c(19,"*"),o()(),g(20,"input",101),p(21,Pt,2,1,"div",32),o(),p(22,Tt,7,4,"div",102),o(),r(23,"div",45)(24,"div",28)(25,"label",103),c(26," Ciudad de Expedici\xF3n "),r(27,"span",30),c(28,"*"),o()(),r(29,"div",55)(30,"input",104),P("input",function(n){_(t);let i=m();return v(i.onCiudadFactExpedicionInputChange(n))})("keydown",function(n){_(t);let i=m();return v(i.onCiudadFactExpedicionKeyDown(n))})("focus",function(){_(t);let n=m();return v(n.mostrarOpcionesCiudadesFactExpedicion.set(!0))})("blur",function(){_(t);let n=m();return v(n.ocultarOpcionesCiudadesFactExpedicion())}),o(),p(31,Dt,3,0,"div",57),p(32,Rt,3,0,"div",58),o(),p(33,Mt,2,1,"div",32),o()(),r(34,"div",105)(35,"div",28)(36,"label",106),c(37," Nombre "),r(38,"span",30),c(39,"*"),o()(),g(40,"input",107),p(41,Vt,2,1,"div",32),o(),r(42,"div",28)(43,"label",108),c(44," Apellido "),r(45,"span",30),c(46,"*"),o()(),g(47,"input",109),p(48,Ot,2,1,"div",32),o()(),r(49,"div",110)(50,"div",28)(51,"label",111),c(52," Tel\xE9fono "),r(53,"span",30),c(54,"*"),o()(),g(55,"input",112),p(56,Nt,2,1,"div",32),o(),r(57,"div",28)(58,"label",113),c(59," Email "),r(60,"span",30),c(61,"*"),o()(),g(62,"input",114),p(63,kt,2,1,"div",32),o()(),r(64,"div",115)(65,"div",28)(66,"label",116),c(67," Direcci\xF3n "),r(68,"span",30),c(69,"*"),o()(),r(70,"input",117),P("keydown",function(n){_(t);let i=m();return v(i.bloquearPuntoYComa(n))})("input",function(){_(t);let n=m();return v(n.sanearDireccionInput("facturacion.direccion"))}),o(),p(71,Ut,2,1,"div",32),o(),r(72,"div",28)(73,"label",118),c(74," Ciudad "),r(75,"span",30),c(76,"*"),o()(),r(77,"div",55)(78,"input",119),P("input",function(n){_(t);let i=m();return v(i.onCiudadFactResidenciaInputChange(n))})("keydown",function(n){_(t);let i=m();return v(i.onCiudadFactResidenciaKeyDown(n))})("focus",function(){_(t);let n=m();return v(n.mostrarOpcionesCiudadesFactResidencia.set(!0))})("blur",function(){_(t);let n=m();return v(n.ocultarOpcionesCiudadesFactResidencia())}),o(),p(79,qt,3,0,"div",57),p(80,Bt,3,0,"div",58),o(),p(81,$t,2,1,"div",32),o()(),r(82,"div",27)(83,"div",28)(84,"label",120),c(85," Tipo de Persona "),r(86,"span",30),c(87,"*"),o()(),r(88,"select",121)(89,"option",49),c(90,"Seleccione"),o(),r(91,"option",67),c(92,"Persona Natural"),o(),r(93,"option",68),c(94,"Persona Jur\xEDdica"),o()(),p(95,jt,2,1,"div",32),o(),r(96,"div",28)(97,"label",122),c(98," R\xE9gimen Tributario "),r(99,"span",30),c(100,"*"),o()(),r(101,"select",123)(102,"option",49),p(103,Qt,1,0)(104,Lt,1,0),o(),D(105,zt,2,2,"option",50,bi),o(),p(107,Gt,2,1,"div",32),p(108,Kt,2,0,"div",71),o()()()}if(a&2){let t=m();d(9),h("ngClass",E(37,J,t.formUtils.esCampoInvalido(t.facturacionForm,"tipoDocumento"))),d(3),R(t.appService.tipoDocQuery.data()),d(2),f(t.formUtils.esCampoInvalido(t.facturacionForm,"tipoDocumento")?14:-1),d(6),h("ngClass",E(39,T,t.formUtils.esCampoInvalido(t.facturacionForm,"documento"))),d(),f(t.formUtils.esCampoInvalido(t.facturacionForm,"documento")?21:-1),d(),f(t.esNitFacturacion()?22:-1),d(8),h("value",t.ciudadFactTerminoBusquedaExpedicion())("disabled",t.facturacionForm.disabled)("ngClass",E(41,T,t.formUtils.esCampoInvalido(t.facturacionForm,"ciudadExpedicion"))),k("aria-expanded",t.mostrarOpcionesCiudadesFactExpedicion())("aria-activedescendant",t.indiceOpcionSeleccionadaFactExpedicion()>=0?"ciudad-fact-exp-option-"+t.indiceOpcionSeleccionadaFactExpedicion():null),d(),f(t.mostrarOpcionesCiudadesFactExpedicion()&&t.ciudadesFactFiltradasExpedicion().length>0&&!t.facturacionForm.disabled?31:-1),d(),f(t.mostrarOpcionesCiudadesFactExpedicion()&&t.ciudadesFactFiltradasExpedicion().length===0&&t.ciudadFactTerminoBusquedaExpedicion()&&!t.facturacionForm.disabled?32:-1),d(),f(t.formUtils.esCampoInvalido(t.facturacionForm,"ciudadExpedicion")?33:-1),d(7),h("ngClass",E(43,T,t.formUtils.esCampoInvalido(t.facturacionForm,"nombre"))),d(),f(t.formUtils.esCampoInvalido(t.facturacionForm,"nombre")?41:-1),d(6),h("ngClass",E(45,T,t.formUtils.esCampoInvalido(t.facturacionForm,"apellido"))),d(),f(t.formUtils.esCampoInvalido(t.facturacionForm,"apellido")?48:-1),d(7),h("ngClass",E(47,T,t.formUtils.esCampoInvalido(t.facturacionForm,"telefono"))),d(),f(t.formUtils.esCampoInvalido(t.facturacionForm,"telefono")?56:-1),d(6),h("ngClass",E(49,T,t.formUtils.esCampoInvalido(t.facturacionForm,"email"))),d(),f(t.formUtils.esCampoInvalido(t.facturacionForm,"email")?63:-1),d(7),h("ngClass",E(51,xi,t.formUtils.esCampoInvalido(t.facturacionForm,"direccion"))),d(),f(t.formUtils.esCampoInvalido(t.facturacionForm,"direccion")?71:-1),d(7),h("value",t.ciudadFactTerminoBusquedaResidencia())("disabled",t.facturacionForm.disabled)("ngClass",E(53,T,t.formUtils.esCampoInvalido(t.facturacionForm,"ciudadResidencia"))),k("aria-expanded",t.mostrarOpcionesCiudadesFactResidencia())("aria-activedescendant",t.indiceOpcionSeleccionadaFactResidencia()>=0?"ciudad-fact-res-option-"+t.indiceOpcionSeleccionadaFactResidencia():null),d(),f(t.mostrarOpcionesCiudadesFactResidencia()&&t.ciudadesFactFiltradasResidencia().length>0&&!t.facturacionForm.disabled?79:-1),d(),f(t.mostrarOpcionesCiudadesFactResidencia()&&t.ciudadesFactFiltradasResidencia().length===0&&t.ciudadFactTerminoBusquedaResidencia()&&!t.facturacionForm.disabled?80:-1),d(),f(t.formUtils.esCampoInvalido(t.facturacionForm,"ciudadResidencia")?81:-1),d(7),h("ngClass",E(55,J,t.formUtils.esCampoInvalido(t.facturacionForm,"tipoPersona"))),d(7),f(t.formUtils.esCampoInvalido(t.facturacionForm,"tipoPersona")?95:-1),d(6),h("ngClass",E(57,J,t.formUtils.esCampoInvalido(t.facturacionForm,"regimenTributario"))),d(2),f(t.perfilService.regimenesTributariosCargando()?103:104),d(2),R(t.perfilService.regimenesTributarios()),d(2),f(t.formUtils.esCampoInvalido(t.facturacionForm,"regimenTributario")?107:-1),d(),f(t.perfilService.regimenesTributariosError()?108:-1)}}function Yt(a,l){a&1&&(g(0,"span",126),c(1," Guardando... "))}function Ht(a,l){a&1&&c(0," Completar Perfil y Continuar ")}function Wt(a,l){a&1&&c(0," Guardar Cambios ")}function Xt(a,l){if(a&1&&p(0,Ht,1,0)(1,Wt,1,0),a&2){let t=m();f(t.isCompleteProfileMode()?0:1)}}function Zt(a,l){if(a&1&&(r(0,"div",32),c(1),o()),a&2){let t=m();d(),b(" ",t.formUtils.obtenerErrorDelCampo(t.passwordForm,"currentPassword")," ")}}function en(a,l){if(a&1&&(r(0,"div",32),c(1),o()),a&2){let t=m();d(),b(" ",t.formUtils.obtenerErrorDelCampo(t.passwordForm,"newPassword")," ")}}function tn(a,l){if(a&1&&(r(0,"div",32),c(1),o()),a&2){let t=m();d(),b(" ",t.formUtils.obtenerErrorDelCampo(t.passwordForm,"confirmPassword")," ")}}function nn(a,l){a&1&&(g(0,"span",126),c(1," Cambiando... "))}function an(a,l){a&1&&c(0," Cambiar Contrase\xF1a ")}function on(a,l){if(a&1){let t=M();r(0,"input",127),P("change",function(){_(t);let n=m();return v(n.cambiarTab("beneficiarios"))}),o(),r(1,"div",22),g(2,"app-beneficiarios"),o()}if(a&2){let t=m();h("checked",t.selectedTab()==="beneficiarios")}}function rn(a,l){}var Na=(()=>{let l=class l{constructor(){this.fb=F(he),this.injector=F(Ue),this.router=F(Le),this.route=F(Qe),this.destroy$=new $,this.alertaService=F(ge),this.navigationService=F(Xe),this.validationCache=F(mi),this.globalLoader=F(Je),this.http=F(L),this.inicializandoFormulario=!1,this.perfilService=F(li),this.appService=F(_e),this.formUtils=I,this.avatarUrl=S(""),this.isCompleteProfileMode=w(()=>this.route.snapshot.queryParams.completeProfile==="true"),this.selectedTab=S("perfil"),this.ciudadTerminoBusqueda=S(""),this.ciudadesFiltradas=S([]),this.mostrarOpcionesCiudades=S(!1),this.ciudadSeleccionada=S(null),this.indiceOpcionSeleccionada=S(-1),this.ciudadSearchSubject=new $,this.ciudadResidenciaTerminoBusqueda=S(""),this.ciudadesResidenciaFiltradas=S([]),this.mostrarOpcionesCiudadesResidencia=S(!1),this.ciudadResidenciaSeleccionada=S(null),this.indiceOpcionSeleccionadaResidencia=S(-1),this.ciudadResidenciaSearchSubject=new $,this.ciudadFactTerminoBusquedaExpedicion=S(""),this.ciudadesFactFiltradasExpedicion=S([]),this.mostrarOpcionesCiudadesFactExpedicion=S(!1),this.ciudadFactSeleccionadaExpedicion=S(null),this.indiceOpcionSeleccionadaFactExpedicion=S(-1),this.ciudadFactExpedicionSearchSubject=new $,this.ciudadFactTerminoBusquedaResidencia=S(""),this.ciudadesFactFiltradasResidencia=S([]),this.mostrarOpcionesCiudadesFactResidencia=S(!1),this.ciudadFactSeleccionadaResidencia=S(null),this.indiceOpcionSeleccionadaFactResidencia=S(-1),this.ciudadFactResidenciaSearchSubject=new $,this.esEgresado=w(()=>{let e=this.perfilService.usuario();return e?e.tipoUsuario.includes(ti.Egresado):!1}),this.perfilForm=this.fb.group({nombre:["",[x.required]],apellido:["",[x.required]],email:["",[x.required,x.pattern(I.patronEmail)]],telefono:["",[x.required,x.pattern(I.patronSoloNumeros),x.minLength(10)]],direccion:["",[x.required]],fechaNacimiento:[""],documento:["",[x.required,x.pattern(I.patronSoloNumeros),x.minLength(7)]],tipoDocumento:["",[x.required]],digitoVerificacion:[""],ciudadExpedicion:["",[x.required]],ciudadResidencia:["",[x.required]],tipoPersona:["",[x.required]],regimenTributario:["",[x.required]],usaFacturacionDiferente:[!1],facturacion:this.fb.group({nombre:[""],apellido:[""],email:[""],telefono:[""],documento:[""],tipoDocumento:[""],digitoVerificacion:[""],ciudadExpedicion:[""],direccion:[""],ciudadResidencia:[""],tipoPersona:[""],regimenTributario:[""]})}),this.passwordForm=this.fb.group({currentPassword:["",[x.required]],newPassword:["",[x.required,x.minLength(6),x.pattern(I.patronContrasena)]],confirmPassword:["",[x.required]]},{validators:[I.sonCamposIguales("newPassword","confirmPassword")]}),this.fechaNacimientoPicker=X.required("fechaNacimientoPicker"),this.contenedorCalendario=X.required("contenedorCalendario"),this.alertaPerfil=X.required("alertaPerfil",{read:De}),this.inputAvatar=X.required("inputAvatar")}get cargando(){return this.perfilService.cargando()}get cambiandoPassword(){return this.perfilService.cambiarPasswordMutation.isPending()}ngOnInit(){this.globalLoader.hide(),this.configurarAutocompleteCiudades(),this.perfilForm.get("usaFacturacionDiferente")?.valueChanges.pipe(N(this.destroy$)).subscribe(e=>{let n=this.facturacionForm;Object.values(n.controls).forEach(i=>{i.clearValidators(),i.updateValueAndValidity({emitEvent:!1})}),e?(n.enable({emitEvent:!1}),n.get("nombre")?.addValidators([x.required]),n.get("apellido")?.addValidators([x.required]),n.get("email")?.addValidators([x.required,x.pattern(I.patronEmail)]),n.get("telefono")?.addValidators([x.required,x.pattern(I.patronSoloNumeros),x.minLength(10)]),n.get("documento")?.addValidators([x.required,x.pattern(I.patronSoloNumeros),x.minLength(7)]),n.get("tipoDocumento")?.addValidators([x.required]),n.get("ciudadExpedicion")?.addValidators([x.required]),n.get("direccion")?.addValidators([x.required]),n.get("ciudadResidencia")?.addValidators([x.required]),n.get("tipoPersona")?.addValidators([x.required]),n.get("regimenTributario")?.addValidators([x.required]),Object.values(n.controls).forEach(i=>i.updateValueAndValidity({emitEvent:!1}))):(n.reset(),n.disable({emitEvent:!1}))}),this.perfilForm.get("usaFacturacionDiferente")?.value||this.facturacionForm.disable({emitEvent:!1}),this.perfilForm.get("tipoDocumento")?.valueChanges.pipe(N(this.destroy$)).subscribe(()=>{this.actualizarValidacionesPerfilDocumento()}),this.perfilForm.get("facturacion.tipoDocumento")?.valueChanges.pipe(N(this.destroy$)).subscribe(()=>{this.actualizarValidacionesFacturacionDocumento()}),this.actualizarValidacionesPerfilDocumento(),this.actualizarValidacionesFacturacionDocumento(),this.facturacionForm.get("documento")?.valueChanges.pipe(ke(""),j(500),Q(),N(this.destroy$)).subscribe(e=>C(this,null,function*(){if(this.inicializandoFormulario)return;let n=this.perfilForm.get("usaFacturacionDiferente")?.value,i=this.facturacionForm.get("tipoDocumento")?.value;if(!n||!i||this.facturacionForm.disabled)return;let s=this.facturacionForm.get("documento");if(!(!s||!s.dirty)&&!(!e||String(e).trim().length<7))try{let u=yield this.perfilService.buscarPersonaFact({tipo_documento_id:parseInt(i,10),numero_documento:String(e)});if(!u)return;let Se=(this.appService.tipoDocQuery.data()||[]).find(Te=>parseInt(Te.id,10)===parseInt(i,10))?.codigo||"";if(!(yield this.alertaService.confirmacion({tipo:"question",titulo:"Cargar datos de facturaci\xF3n",mensaje:`Se encontraron datos de facturaci\xF3n para el documento <strong>${Se} ${u.numero_documento} ${u.primer_nombre} ${u.primer_apellido}</strong>. \xBFDeseas cargarlos y bloquear el formulario?`,referencia:this.alertaPerfil(),botones:[{texto:"Cancelar",tipo:"cancelar",estilo:"btn-ghost"},{texto:"Aceptar",tipo:"confirmar",estilo:"btn-secondary"}]}))){let Te=this.facturacionForm.get("documento")?.value,vi=this.facturacionForm.get("tipoDocumento")?.value;this.facturacionForm.patchValue({nombre:"",apellido:"",email:"",telefono:"",digitoVerificacion:"",ciudadExpedicion:"",direccion:"",ciudadResidencia:"",tipoPersona:"",regimenTributario:""},{emitEvent:!1}),this.facturacionForm.get("documento")?.setValue(Te,{emitEvent:!1}),this.facturacionForm.get("tipoDocumento")?.setValue(vi,{emitEvent:!1}),this.ciudadFactSeleccionadaExpedicion.set(null),this.ciudadFactTerminoBusquedaExpedicion.set(""),this.ciudadFactSeleccionadaResidencia.set(null),this.ciudadFactTerminoBusquedaResidencia.set("");return}let Ci=`${u.primer_nombre} ${u.segundo_nombre??""}`.trim(),_i=`${u.primer_apellido} ${u.segundo_apellido??""}`.trim(),Fe=this.perfilService.buscarCiudadPorId(u.ciudad_expedicion_id),ye=this.perfilService.buscarCiudadPorId(u.ciudad_residencia_id),Pe,we;u.es_persona_facturacion?[Pe,we]=u.direccion.split(";"):(Pe=u.usuario?.email||"",we=u.direccion||""),this.facturacionForm.patchValue({nombre:Ci,apellido:_i,documento:u.numero_documento,tipoDocumento:u.tipo_documento_id,direccion:we||"",email:Pe||"",telefono:u.celular||"",ciudadExpedicion:u.ciudad_expedicion_id||"",ciudadResidencia:u.ciudad_residencia_id||"",tipoPersona:u.tipo_persona||"",regimenTributario:u.regimen_tributario_id||"",digitoVerificacion:u.digito_verificacion||""},{emitEvent:!1}),Fe&&(this.ciudadFactSeleccionadaExpedicion.set(Fe),this.ciudadFactTerminoBusquedaExpedicion.set(Fe.nombre)),ye&&(this.ciudadFactSeleccionadaResidencia.set(ye),this.ciudadFactTerminoBusquedaResidencia.set(ye.nombre)),this.facturacionForm.get("ciudadExpedicion")?.disable({emitEvent:!1}),this.facturacionForm.get("ciudadResidencia")?.disable({emitEvent:!1}),this.facturacionForm.disable({emitEvent:!1}),this.actualizarValidacionesFacturacionDocumento()}catch{}})),Re(()=>{let e=this.perfilService.usuario();e&&this.cargarDatosEnFormulario(e)},{injector:this.injector})}ngAfterViewInit(){setTimeout(()=>{this.initializePikaday()},0)}configurarAutocompleteCiudades(){this.ciudadSearchSubject.pipe(j(300),Q(),N(this.destroy$)).subscribe(e=>{this.filtrarCiudades(e)}),this.ciudadResidenciaSearchSubject.pipe(j(300),Q(),N(this.destroy$)).subscribe(e=>{this.filtrarCiudadesResidencia(e)}),this.ciudadFactExpedicionSearchSubject.pipe(j(300),Q(),N(this.destroy$)).subscribe(e=>{let n=this.perfilService.filtrarCiudades(e);this.ciudadesFactFiltradasExpedicion.set(n)}),this.ciudadFactResidenciaSearchSubject.pipe(j(300),Q(),N(this.destroy$)).subscribe(e=>{let n=this.perfilService.filtrarCiudades(e);this.ciudadesFactFiltradasResidencia.set(n)}),Re(()=>{let e=this.perfilService.ciudades();e&&e.length>0&&(this.ciudadesFiltradas.set(e),this.ciudadesResidenciaFiltradas.set(e),this.ciudadesFactFiltradasExpedicion.set(e),this.ciudadesFactFiltradasResidencia.set(e))},{injector:this.injector})}filtrarCiudades(e){let n=this.perfilService.filtrarCiudades(e);this.ciudadesFiltradas.set(n)}filtrarCiudadesResidencia(e){let n=this.perfilService.filtrarCiudades(e);this.ciudadesResidenciaFiltradas.set(n)}onCiudadInputChange(e){let i=e.target.value;this.ciudadTerminoBusqueda.set(i),this.mostrarOpcionesCiudades.set(!0),this.indiceOpcionSeleccionada.set(-1),this.ciudadSearchSubject.next(i);let s=this.ciudadSeleccionada();(!s||s.nombre!==i)&&(this.perfilForm.get("ciudadExpedicion")?.setValue(""),this.ciudadSeleccionada.set(null)),this.anunciarCambioAutocompletado("ciudad",i)}onCiudadKeyDown(e){let n=this.ciudadesFiltradas(),i=this.indiceOpcionSeleccionada();switch(e.key){case"ArrowDown":e.preventDefault();let s=i<n.length-1?i+1:0;this.indiceOpcionSeleccionada.set(s),this.anunciarSeleccionCiudad(n[s]);break;case"ArrowUp":e.preventDefault();let u=i>0?i-1:n.length-1;this.indiceOpcionSeleccionada.set(u),this.anunciarSeleccionCiudad(n[u]);break;case"Enter":e.preventDefault(),i>=0&&n[i]&&(this.seleccionarCiudad(n[i]),this.anunciarSeleccionCiudad(n[i],!0));break;case"Escape":e.preventDefault(),this.mostrarOpcionesCiudades.set(!1),this.indiceOpcionSeleccionada.set(-1),this.anunciarCambioAutocompletado("ciudad","Lista cerrada");break;case"Home":e.preventDefault(),n.length>0&&(this.indiceOpcionSeleccionada.set(0),this.anunciarSeleccionCiudad(n[0]));break;case"End":e.preventDefault(),n.length>0&&(this.indiceOpcionSeleccionada.set(n.length-1),this.anunciarSeleccionCiudad(n[n.length-1]));break}}onCiudadResidenciaInputChange(e){let i=e.target.value;this.ciudadResidenciaTerminoBusqueda.set(i),this.mostrarOpcionesCiudadesResidencia.set(!0),this.indiceOpcionSeleccionadaResidencia.set(-1),this.ciudadResidenciaSearchSubject.next(i);let s=this.ciudadResidenciaSeleccionada();(!s||s.nombre!==i)&&(this.perfilForm.get("ciudadResidencia")?.setValue(""),this.ciudadResidenciaSeleccionada.set(null)),this.anunciarCambioAutocompletado("ciudad-residencia",i)}onCiudadResidenciaKeyDown(e){let n=this.ciudadesResidenciaFiltradas(),i=this.indiceOpcionSeleccionadaResidencia();switch(e.key){case"ArrowDown":e.preventDefault();let s=i<n.length-1?i+1:0;this.indiceOpcionSeleccionadaResidencia.set(s),this.anunciarSeleccionCiudad(n[s]);break;case"ArrowUp":e.preventDefault();let u=i>0?i-1:n.length-1;this.indiceOpcionSeleccionadaResidencia.set(u),this.anunciarSeleccionCiudad(n[u]);break;case"Enter":e.preventDefault(),i>=0&&n[i]&&(this.seleccionarCiudadResidencia(n[i]),this.anunciarSeleccionCiudad(n[i],!0));break;case"Escape":e.preventDefault(),this.mostrarOpcionesCiudadesResidencia.set(!1),this.indiceOpcionSeleccionadaResidencia.set(-1),this.anunciarCambioAutocompletado("ciudad-residencia","Lista cerrada");break;case"Home":e.preventDefault(),n.length>0&&(this.indiceOpcionSeleccionadaResidencia.set(0),this.anunciarSeleccionCiudad(n[0]));break;case"End":e.preventDefault(),n.length>0&&(this.indiceOpcionSeleccionadaResidencia.set(n.length-1),this.anunciarSeleccionCiudad(n[n.length-1]));break}}onCiudadFactExpedicionInputChange(e){if(this.facturacionForm.disabled)return;let i=e.target.value;this.ciudadFactTerminoBusquedaExpedicion.set(i),this.mostrarOpcionesCiudadesFactExpedicion.set(!0),this.indiceOpcionSeleccionadaFactExpedicion.set(-1),this.ciudadFactExpedicionSearchSubject.next(i);let s=this.ciudadFactSeleccionadaExpedicion();(!s||s.nombre!==i)&&(this.perfilForm.get("facturacion.ciudadExpedicion")?.setValue(""),this.ciudadFactSeleccionadaExpedicion.set(null)),this.anunciarCambioAutocompletado("ciudad-fact-expedicion",i)}onCiudadFactExpedicionKeyDown(e){let n=this.ciudadesFactFiltradasExpedicion(),i=this.indiceOpcionSeleccionadaFactExpedicion();switch(e.key){case"ArrowDown":e.preventDefault();let s=i<n.length-1?i+1:0;this.indiceOpcionSeleccionadaFactExpedicion.set(s),this.anunciarSeleccionCiudad(n[s]);break;case"ArrowUp":e.preventDefault();let u=i>0?i-1:n.length-1;this.indiceOpcionSeleccionadaFactExpedicion.set(u),this.anunciarSeleccionCiudad(n[u]);break;case"Enter":e.preventDefault(),i>=0&&n[i]&&(this.seleccionarCiudadFactExpedicion(n[i]),this.anunciarSeleccionCiudad(n[i],!0));break;case"Escape":e.preventDefault(),this.mostrarOpcionesCiudadesFactExpedicion.set(!1),this.indiceOpcionSeleccionadaFactExpedicion.set(-1),this.anunciarCambioAutocompletado("ciudad-fact-expedicion","Lista cerrada");break;case"Home":e.preventDefault(),n.length>0&&(this.indiceOpcionSeleccionadaFactExpedicion.set(0),this.anunciarSeleccionCiudad(n[0]));break;case"End":e.preventDefault(),n.length>0&&(this.indiceOpcionSeleccionadaFactExpedicion.set(n.length-1),this.anunciarSeleccionCiudad(n[n.length-1]));break}}seleccionarCiudadFactExpedicion(e){this.ciudadFactSeleccionadaExpedicion.set(e),this.ciudadFactTerminoBusquedaExpedicion.set(e.nombre),this.mostrarOpcionesCiudadesFactExpedicion.set(!1),this.indiceOpcionSeleccionadaFactExpedicion.set(-1),this.perfilForm.get("facturacion.ciudadExpedicion")?.setValue(e.id)}ocultarOpcionesCiudadesFactExpedicion(){setTimeout(()=>{this.mostrarOpcionesCiudadesFactExpedicion.set(!1),this.indiceOpcionSeleccionadaFactExpedicion.set(-1)},150)}onCiudadFactResidenciaInputChange(e){if(this.facturacionForm.disabled)return;let i=e.target.value;this.ciudadFactTerminoBusquedaResidencia.set(i),this.mostrarOpcionesCiudadesFactResidencia.set(!0),this.indiceOpcionSeleccionadaFactResidencia.set(-1),this.ciudadFactResidenciaSearchSubject.next(i);let s=this.ciudadFactSeleccionadaResidencia();(!s||s.nombre!==i)&&(this.perfilForm.get("facturacion.ciudadResidencia")?.setValue(""),this.ciudadFactSeleccionadaResidencia.set(null)),this.anunciarCambioAutocompletado("ciudad-fact-residencia",i)}onCiudadFactResidenciaKeyDown(e){let n=this.ciudadesFactFiltradasResidencia(),i=this.indiceOpcionSeleccionadaFactResidencia();switch(e.key){case"ArrowDown":e.preventDefault();let s=i<n.length-1?i+1:0;this.indiceOpcionSeleccionadaFactResidencia.set(s),this.anunciarSeleccionCiudad(n[s]);break;case"ArrowUp":e.preventDefault();let u=i>0?i-1:n.length-1;this.indiceOpcionSeleccionadaFactResidencia.set(u),this.anunciarSeleccionCiudad(n[u]);break;case"Enter":e.preventDefault(),i>=0&&n[i]&&(this.seleccionarCiudadFactResidencia(n[i]),this.anunciarSeleccionCiudad(n[i],!0));break;case"Escape":e.preventDefault(),this.mostrarOpcionesCiudadesFactResidencia.set(!1),this.indiceOpcionSeleccionadaFactResidencia.set(-1),this.anunciarCambioAutocompletado("ciudad-fact-residencia","Lista cerrada");break;case"Home":e.preventDefault(),n.length>0&&(this.indiceOpcionSeleccionadaFactResidencia.set(0),this.anunciarSeleccionCiudad(n[0]));break;case"End":e.preventDefault(),n.length>0&&(this.indiceOpcionSeleccionadaFactResidencia.set(n.length-1),this.anunciarSeleccionCiudad(n[n.length-1]));break}}seleccionarCiudadFactResidencia(e){this.ciudadFactSeleccionadaResidencia.set(e),this.ciudadFactTerminoBusquedaResidencia.set(e.nombre),this.mostrarOpcionesCiudadesFactResidencia.set(!1),this.indiceOpcionSeleccionadaFactResidencia.set(-1),this.perfilForm.get("facturacion.ciudadResidencia")?.setValue(e.id)}ocultarOpcionesCiudadesFactResidencia(){setTimeout(()=>{this.mostrarOpcionesCiudadesFactResidencia.set(!1),this.indiceOpcionSeleccionadaFactResidencia.set(-1)},150)}bloquearPuntoYComa(e){e.key===";"&&e.preventDefault()}sanearDireccionInput(e){let n=this.perfilForm.get(e);if(!n)return;let i=n.value||"";i.includes(";")&&n.setValue(i.replace(/;/g,""),{emitEvent:!1})}seleccionarCiudad(e){this.ciudadSeleccionada.set(e),this.ciudadTerminoBusqueda.set(e.nombre),this.mostrarOpcionesCiudades.set(!1),this.indiceOpcionSeleccionada.set(-1),this.perfilForm.get("ciudadExpedicion")?.setValue(e.id)}seleccionarCiudadResidencia(e){this.ciudadResidenciaSeleccionada.set(e),this.ciudadResidenciaTerminoBusqueda.set(e.nombre),this.mostrarOpcionesCiudadesResidencia.set(!1),this.indiceOpcionSeleccionadaResidencia.set(-1),this.perfilForm.get("ciudadResidencia")?.setValue(e.id)}ocultarOpcionesCiudades(){setTimeout(()=>{this.mostrarOpcionesCiudades.set(!1),this.indiceOpcionSeleccionada.set(-1)},150)}ocultarOpcionesCiudadesResidencia(){setTimeout(()=>{this.mostrarOpcionesCiudadesResidencia.set(!1),this.indiceOpcionSeleccionadaResidencia.set(-1)},150)}limpiarAutocomplete(){this.ciudadTerminoBusqueda.set(""),this.ciudadSeleccionada.set(null),this.mostrarOpcionesCiudades.set(!1),this.indiceOpcionSeleccionada.set(-1),this.perfilForm.get("ciudadExpedicion")?.setValue(""),this.ciudadResidenciaTerminoBusqueda.set(""),this.ciudadResidenciaSeleccionada.set(null),this.mostrarOpcionesCiudadesResidencia.set(!1),this.indiceOpcionSeleccionadaResidencia.set(-1),this.perfilForm.get("ciudadResidencia")?.setValue(""),this.ciudadFactTerminoBusquedaExpedicion.set(""),this.ciudadFactSeleccionadaExpedicion.set(null),this.mostrarOpcionesCiudadesFactExpedicion.set(!1),this.indiceOpcionSeleccionadaFactExpedicion.set(-1),this.perfilForm.get("facturacion.ciudadExpedicion")?.setValue(""),this.ciudadFactTerminoBusquedaResidencia.set(""),this.ciudadFactSeleccionadaResidencia.set(null),this.mostrarOpcionesCiudadesFactResidencia.set(!1),this.indiceOpcionSeleccionadaFactResidencia.set(-1),this.perfilForm.get("facturacion.ciudadResidencia")?.setValue("")}initializePikaday(){this.pikaday=new hi.default({field:this.fechaNacimientoPicker()?.nativeElement,yearRange:[1950,new Date().getFullYear()-16],maxDate:new Date(new Date().getFullYear()-16,new Date().getMonth(),new Date().getDate()),i18n:this.perfilService.i18nDatePicker(),format:"DD/MM/YYYY",onSelect:e=>{let n=Z(e,"dd/MM/yyyy");this.perfilForm.get("fechaNacimiento")?.setValue(n)}}),this.perfilForm.get("fechaNacimiento")?.valueChanges.subscribe(e=>{if(e){let n=K(e,"dd/MM/yyyy",new Date);this.pikaday.setDate(n,!0)}else this.pikaday.setDate(null)})}get ciudades(){return this.perfilService.ciudades()}cargarDatosEnFormulario(e){this.inicializandoFormulario=!0;try{let n="";if(e.fechaNacimiento){let s=e.fechaNacimiento.split("T")[0];n=Z(K(s,"yyyy-MM-dd",new Date),"dd/MM/yyyy")}let i=null;if(e.facturacion!==null&&Object.keys(e.facturacion).length>0){let[s,u]=e.facturacion.direccion.split(";");i={nombre:`${e.facturacion.primer_nombre} ${e.facturacion.segundo_nombre??""}`.trim(),apellido:`${e.facturacion.primer_apellido} ${e.facturacion.segundo_apellido??""}`.trim(),email:s||"",telefono:e.facturacion.celular||"",documento:e.facturacion.numero_documento||"",tipoDocumento:e.facturacion.tipo_documento_id||"",ciudadExpedicion:e.facturacion.ciudad_expedicion_id||"",direccion:u||"",ciudadResidencia:e.facturacion.ciudad_residencia_id||"",digitoVerificacion:e.facturacion.digito_verificacion||"",tipoPersona:e.facturacion.tipo_persona||"",regimenTributario:e.facturacion.regimen_tributario_id||""}}if(this.perfilForm.patchValue({nombre:e.nombre,apellido:e.apellido,email:e.email,telefono:e.telefono,direccion:e.direccion,documento:e.documento,tipoDocumento:e.tipoDocumento,fechaNacimiento:n,digitoVerificacion:e.digitoVerificacion||"",ciudadExpedicion:e.ciudadExpedicion||"",ciudadResidencia:e.ciudadResidencia||"",tipoPersona:e.tipoPersona||"",regimenTributario:e.regimenTributario||"",facturacion:i}),e.facturacion&&e.facturacion.es_persona_facturacion&&e.facturacion.persona_facturacion_id&&(this.perfilForm.get("usaFacturacionDiferente")?.setValue(!0,{emitEvent:!1}),this.facturacionForm.disable({emitEvent:!1})),e.ciudadExpedicion){let s=this.perfilService.buscarCiudadPorId(e.ciudadExpedicion);s&&(this.ciudadSeleccionada.set(s),this.ciudadTerminoBusqueda.set(s.nombre))}if(e.facturacion?.ciudad_expedicion_id){let s=this.perfilService.buscarCiudadPorId(e.facturacion.ciudad_expedicion_id);s&&(this.ciudadFactSeleccionadaExpedicion.set(s),this.ciudadFactTerminoBusquedaExpedicion.set(s.nombre))}if(e.facturacion&&e.facturacion.ciudad_residencia_id){let s=this.perfilService.buscarCiudadPorId(e.facturacion.ciudad_residencia_id);s&&(this.ciudadFactSeleccionadaResidencia.set(s),this.ciudadFactTerminoBusquedaResidencia.set(s.nombre))}if(e.ciudadResidencia){let s=this.perfilService.buscarCiudadPorId(e.ciudadResidencia);s&&(this.ciudadResidenciaSeleccionada.set(s),this.ciudadResidenciaTerminoBusqueda.set(s.nombre))}if(this.perfilForm.controls.email.disable(),e.documento&&this.perfilForm.controls.documento.disable(),e.tipoDocumento&&this.perfilForm.controls.tipoDocumento.disable(),this.pikaday&&n){let s=K(n,"dd/MM/yyyy",new Date);this.pikaday.setDate(s,!0)}this.actualizarValidacionesPerfilDocumento(),this.actualizarValidacionesFacturacionDocumento()}finally{this.inicializandoFormulario=!1}}get facturacionForm(){return this.perfilForm.get("facturacion")}guardarCambios(){return C(this,null,function*(){if(this.perfilForm.invalid){this.perfilForm.markAllAsTouched(),this.anunciarValidacion("Formulario",!1,"contiene campos requeridos sin completar");let y=this.encontrarPrimerCampoConError();y&&this.manejarFocoEnError(y);return}this.anunciarEstadoCarga("Guardando cambios del perfil...","loading");let e=this.perfilForm.value.fechaNacimiento?Z(K(this.perfilForm.value.fechaNacimiento,"dd/MM/yyyy",new Date),"yyyy-MM-dd"):"",n="",i=this.perfilForm.get("usaFacturacionDiferente")?.value,s=this.perfilForm.get("facturacion").getRawValue();i&&s?.fechaNacimiento&&(n=Z(K(s.fechaNacimiento,"dd/MM/yyyy",new Date),"yyyy-MM-dd"));let u=Ne(Ie(Ie({},this.perfilService.usuario()),this.perfilForm.value),{fechaNacimiento:e,facturacion:i?s:null});try{if(yield this.perfilService.actualizarPerfilMutation.mutateAsync(u),this.anunciarEstadoCarga("Perfil actualizado exitosamente","success"),this.alertaService.success("Perfil actualizado exitosamente.",5e3,this.alertaPerfil(),"fixed flex p-4 transition-all ease-in-out bottom-4 right-4"),this.manejarFocoPostAccion("boton-guardar",500),!this.isCompleteProfileMode())return;this.validationCache.setPerfilCompletado(!0),yield new Promise(y=>setTimeout(y,100));try{yield this.navigationService.navegarAPrimeraPaginaDisponible(),setTimeout(()=>{let y=this.router.url.split("?")[0];this.router.navigateByUrl(y,{replaceUrl:!0})},100)}catch{let B=yield this.router.navigate(["/reservas"])}}catch{this.anunciarEstadoCarga("Error al guardar los cambios","error"),this.alertaService.error("Error al actualizar el perfil. Por favor, int\xE9ntalo de nuevo.",5e3,this.alertaPerfil(),"fixed flex p-4 transition-all ease-in-out bottom-4 right-4")}})}cambiarTab(e){this.selectedTab.set(e.toString())}cambiarPassword(){return C(this,null,function*(){if(this.passwordForm.invalid){this.passwordForm.markAllAsTouched(),this.anunciarValidacion("Formulario de contrase\xF1a",!1,"contiene campos requeridos sin completar");return}this.anunciarEstadoCarga("Cambiando contrase\xF1a...","loading");let e={currentPassword:this.passwordForm.value.currentPassword,newPassword:this.passwordForm.value.newPassword};try{(yield this.perfilService.cambiarPassword(e))&&(this.anunciarEstadoCarga("Contrase\xF1a actualizada exitosamente","success"),this.alertaService.success("Contrase\xF1a actualizada exitosamente.",5e3,this.alertaPerfil(),"fixed flex p-4 transition-all ease-in-out bottom-4 right-4"),this.passwordForm.reset())}catch(n){console.error("Error al cambiar contrase\xF1a:",n);let i=n?.message||"Error al cambiar la contrase\xF1a. Por favor, int\xE9ntalo de nuevo.";this.anunciarEstadoCarga("Error al cambiar la contrase\xF1a","error"),this.alertaService.error(i,5e3,this.alertaPerfil(),"fixed flex p-4 transition-all ease-in-out bottom-4 right-4")}})}anunciarCambioAutocompletado(e,n){let i=document.getElementById("accesibilidad-live-region");i&&(i.textContent=n)}anunciarSeleccionCiudad(e,n=!1){let i=n?`${e.nombre} seleccionada`:`${e.nombre}`;this.anunciarCambioAutocompletado("ciudad",i)}anunciarEstadoCarga(e,n="loading"){let i=document.getElementById("estado-live-region");i&&(i.setAttribute("aria-live",n==="error"?"assertive":"polite"),i.textContent=e)}manejarFocoPostAccion(e,n=100){setTimeout(()=>{let i=document.getElementById(e);i&&(i.focus(),this.anunciarCambioAutocompletado("navegacion",`Enfocado en ${i.getAttribute("aria-label")||e}`))},n)}manejarFocoEnError(e){let n=document.getElementById(e);n&&(n.focus(),n.scrollIntoView({behavior:"smooth",block:"center"}),this.anunciarValidacion(e,!1,"Campo con error, requiere atenci\xF3n"))}encontrarPrimerCampoConError(){let e=["nombre","apellido","telefono","fechaNacimiento","tipoDocumento","documento","ciudadExpedicion","email","direccion","ciudadResidencia","tipoPersona","regimenTributario"];for(let n of e){let i=this.perfilForm.get(n);if(i&&i.invalid&&i.touched)return n}if(this.perfilForm.get("usaFacturacionDiferente")?.value){let n=["facturacion.nombre","facturacion.apellido","facturacion.telefono","facturacion.email","facturacion.documento","facturacion.direccion"];for(let i of n){let s=this.perfilForm.get(i);if(s&&s.invalid&&s.touched)return i.replace("facturacion.","f")}}return null}anunciarValidacion(e,n,i){let s=document.getElementById("validacion-live-region");if(s){let u=n?`${e} v\xE1lido`:`${e}: ${i||"contiene errores"}`;s.textContent=u}}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.pikaday&&this.pikaday.destroy()}esNitPerfil(){let e=parseInt(this.perfilForm.get("tipoDocumento")?.value,10);if(!e)return!1;let n=this.appService.tipoDocQuery.data()?.find(i=>parseInt(i.id,10)===e);return!!n&&n.codigo?.toUpperCase()==="NT"}esNitFacturacion(){let e=parseInt(this.perfilForm.get("facturacion.tipoDocumento")?.value,10);if(!e)return!1;let n=this.appService.tipoDocQuery.data()?.find(i=>parseInt(i.id,10)===e);return!!n&&n.codigo?.toUpperCase()==="NT"}actualizarValidacionesPerfilDocumento(){let e=this.esNitPerfil(),n=this.perfilForm.get("digitoVerificacion");n&&(n.clearValidators(),n.updateValueAndValidity({emitEvent:!1}))}actualizarValidacionesFacturacionDocumento(){let e=this.esNitFacturacion(),n=this.perfilForm.get("facturacion");if(!n)return;if(!this.perfilForm.get("usaFacturacionDiferente")?.value||n.disabled){let s=n.get("digitoVerificacion");s?.clearValidators(),s?.updateValueAndValidity({emitEvent:!1});return}let i=n.get("digitoVerificacion");i&&(e?i.setValidators([x.required,x.pattern(I.patronSoloNumeros),x.minLength(1),x.maxLength(1)]):(i.clearValidators(),i.setValue("",{emitEvent:!1})),i.updateValueAndValidity({emitEvent:!1}))}};l.\u0275fac=function(n){return new(n||l)},l.\u0275cmp=ie({type:l,selectors:[["app-perfil-main"]],viewQuery:function(n,i){n&1&&(H(i.fechaNacimientoPicker,zi,5),H(i.contenedorCalendario,Gi,5),H(i.alertaPerfil,Ki,5,De),H(i.inputAvatar,Ji,5)),n&2&&qe(4)},hostAttrs:[1,"flex","flex-col","grow","w-full","h-full","overflow-y-auto"],decls:204,vars:87,consts:[["fechaNacimientoPicker",""],["contenedorCalendario",""],["alertaPerfil",""],[1,"flex","flex-col","w-full","relative","max-sm:pt-2","sm:px-2"],["href","#contenido-principal",1,"sr-only","focus:not-sr-only","focus:absolute","focus:top-2","focus:left-2","bg-primary","text-primary-content","px-4","py-2","rounded","z-50"],["href","#navegacion-tabs",1,"sr-only","focus:not-sr-only","focus:absolute","focus:top-2","focus:left-48","bg-secondary","text-secondary-content","px-4","py-2","rounded","z-50"],["href","#formulario-perfil",1,"sr-only","focus:not-sr-only","focus:absolute","focus:top-2","focus:left-96","bg-accent","text-accent-content","px-4","py-2","rounded","z-50"],["id","accesibilidad-live-region","aria-live","polite","aria-atomic","true",1,"sr-only"],["id","estado-live-region","aria-live","polite","aria-atomic","true",1,"sr-only"],["id","validacion-live-region","aria-live","assertive","aria-atomic","true",1,"sr-only"],[1,"w-full","sticky","top-0","z-20"],[1,"flex","w-full","max-w-4xl","mx-auto","justify-between","pb-1","bg-base-300"],[1,"flex","flex-col","justify-center"],[1,"text-3xl","font-bold","text-base-content","mb-2"],[1,"lg:col-span-1"],[1,"rounded-box","bg-base-100","shadow-md"],[1,"card-body","p-1","md:p-2","items-center","text-center"],[1,"text-lg","lg:text-xl","font-semibold"],[1,"badge","badge-primary"],["id","contenido-principal"],["id","navegacion-tabs",1,"lg:col-span-2","tabs","w-full","max-w-4xl","overflow-hidden","mx-auto","max-md:tabs-box","tabs-lift"],["type","radio","name","my_tabs","aria-label","Informaci\xF3n personal",1,"tab","h-9","md:h-[var(--tab-height)]","font-bold","text-base","lg:text-lg","w-full","md:w-auto",3,"change","checked"],[1,"tab-content","bg-base-100","p-2","md:p-4","h-[100svh]","overflow-y-auto","max-sm:rounded-b-lg"],["id","formulario-perfil",1,"overflow-y-auto","relative",3,"ngSubmit","formGroup"],[1,"w-full","max-w-4xl","mx-auto","mb-2"],[1,"mb-2","px-1"],[1,"text-lg","font-semibold","text-base-content","mb-4","px-1"],[1,"flex","flex-col","md:flex-row","w-full","gap-2","md:gap-3"],[1,"flex","flex-col","w-full","md:w-1/2"],["for","nombre",1,"label","text-sm","font-[600]","text-base-content","mb-1"],[1,"text-error"],["type","text","id","nombre","formControlName","nombre","placeholder","Nombre",3,"ngClass"],[1,"text-sm","text-error"],["for","apellido",1,"label","text-sm","font-[600]","text-base-content","mb-1"],["type","text","id","apellido","formControlName","apellido","placeholder","Apellido",3,"ngClass"],[1,"my-2","px-1"],["for","telefono",1,"label","text-sm","font-[600]","text-base-content","mb-1"],["type","tel","id","telefono","inputSoloNumeros","","formControlName","telefono","placeholder","1234567890",3,"ngClass"],["for","fechaNacimiento",1,"label","text-sm","font-[600]","text-base-content","mb-1"],[1,"input","input-bordered","w-full","h-11","rounded-box"],["type","text","id","fechaNacimiento","placeholder","dd/mm/yyyy","formControlName","fechaNacimiento",3,"ngClass"],[3,"nombreIcono","estilos"],[1,"w-full","relative"],[1,"my-3","px-1"],[1,"text-lg","font-semibold","text-base-content","mb-4"],[1,"flex","flex-col","md:flex-row","w-full","gap-2","md:gap-3","mb-4"],[1,"flex","flex-col","w-full","md:w-2/6"],["for","tipoDocumento",1,"label","text-sm","font-[600]","text-base-content","mb-1"],["type","text","id","tipoDocumento","formControlName","tipoDocumento",3,"ngClass"],["value","","disabled","","selected",""],[3,"value"],[1,"flex","flex-col","w-full","md:w-3/6"],["for","documento",1,"label","text-sm","font-[600]","text-base-content","mb-1"],["type","text","id","documento","inputSoloNumeros","","inputmode","numeric","formControlName","documento","placeholder","123456789",3,"ngClass"],["for","ciudadExpedicion",1,"label","text-sm","font-[600]","text-base-content","mb-1"],[1,"relative"],["type","text","id","ciudadExpedicion","placeholder","Escriba para buscar una ciudad...","autocomplete","off","role","combobox",3,"input","keydown","focus","blur","value","ngClass"],["role","listbox",1,"absolute","z-10","w-full","mt-1","bg-base-100","shadow-lg","border-base-300","border","rounded-lg","max-h-60","overflow-y-auto"],[1,"absolute","z-10","w-full","mt-1","bg-base-100","shadow-lg","border-base-300","border","rounded-lg","max-h-60","overflow-y-auto","animate-fade-in","text-sm"],[1,"flex","flex-col","w-full","mb-4"],[1,"label","text-sm","font-[600]","text-base-content","mb-1"],["type","email","id","email","formControlName","email","placeholder","micorreo@unab.edu.co",3,"ngClass"],["type","text","id","direccion","formControlName","direccion","placeholder","Calle X # 123A-45",3,"keydown","input","ngClass"],["for","ciudadResidencia",1,"label","text-sm","font-[600]","text-base-content","mb-1"],["type","text","id","ciudadResidencia","placeholder","Escriba para buscar una ciudad...","autocomplete","off","role","combobox",3,"input","keydown","focus","blur","value","ngClass"],["for","tipoPersona",1,"label","text-sm","font-[600]","text-base-content","mb-1"],["id","tipoPersona","formControlName","tipoPersona",3,"ngClass"],["value","natural"],["value","juridica"],["for","regimenTributario",1,"label","text-sm","font-[600]","text-base-content","mb-1"],["id","regimenTributario","formControlName","regimenTributario",3,"ngClass"],[1,"text-sm","text-warning"],[1,"my-4","px-1"],[1,"flex","items-center","gap-3","cursor-pointer"],["type","checkbox","formControlName","usaFacturacionDiferente",1,"checkbox","checkbox-primary"],[1,"text-sm","font-[600]","text-base-content"],["formGroupName","facturacion",1,"my-4","p-3","rounded-box","border-2","border-secondary","bg-base-200/30"],[1,"card-actions","justify-end"],["id","boton-guardar","type","submit","aria-label","Guardar cambios del perfil",1,"btn","btn-primary","max-sm:btn-sm","sm:h-11",3,"disabled"],["type","radio","name","my_tabs","aria-label","Cambiar Contrase\xF1a",1,"tab","h-9","md:h-[var(--tab-height)]","font-bold","text-base","lg:text-lg","w-full","md:w-auto","before:bg-none",3,"change","checked"],[1,"h-full",3,"ngSubmit","formGroup"],[1,"space-y-4"],[1,"flex","flex-col","w-full"],["for","currentPassword",1,"label","text-sm","font-[600]","text-base-content","mb-1"],["type","password","id","currentPassword","formControlName","currentPassword","autocomplete","current-password","placeholder","Ingresa tu contrase\xF1a actual",3,"ngClass"],["for","newPassword",1,"label","text-sm","font-[600]","text-base-content","mb-1"],["type","password","id","newPassword","formControlName","newPassword","autocomplete","new-password","placeholder","Ingresa tu nueva contrase\xF1a",3,"ngClass"],["for","confirmPassword",1,"label","text-sm","font-[600]","text-base-content","mb-1"],["type","password","id","confirmPassword","formControlName","confirmPassword","autocomplete","new-password","placeholder","Confirma tu nueva contrase\xF1a",3,"ngClass"],[1,"card-actions","justify-end","mt-2","md:mt-6"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"alert","alert-info","rounded-lg"],["estilos","h-6 w-6","nombreIcono","information-circle-outline"],[1,"font-bold"],[1,"text-xs"],["role","option",1,"py-3","px-4","cursor-pointer","border-b","border-base-100/10","transition-colors","duration-200","hover:bg-base-100","last:border-b-0","animate-fade-in","text-sm",3,"id","highlighted"],["role","option",1,"py-3","px-4","cursor-pointer","border-b","border-base-100/10","transition-colors","duration-200","hover:bg-base-100","last:border-b-0","animate-fade-in","text-sm",3,"click","id"],[1,"py-3","px-4","text-gray-500","italic"],["for","ftipoDocumento",1,"label","text-sm","font-[600]","text-base-content","mb-1"],["id","ftipoDocumento","formControlName","tipoDocumento",3,"ngClass"],["for","fdocumento",1,"label","text-sm","font-[600]","text-base-content","mb-1"],["id","fdocumento","type","text","inputSoloNumeros","","inputmode","numeric","formControlName","documento","placeholder","123456789",3,"ngClass"],[1,"flex","flex-col","w-full","md:w-1/6"],["for","fciudadExpedicion",1,"label","text-sm","font-[600]","text-base-content","mb-1"],["id","fciudadExpedicion","type","text","placeholder","Escriba para buscar una ciudad...","autocomplete","off","role","combobox",3,"input","keydown","focus","blur","value","disabled","ngClass"],[1,"mb-2","px-1","flex","flex-col","md:flex-row","w-full","gap-2","md:gap-3"],["for","fnombre",1,"label","text-sm","font-[600]","text-base-content","mb-1"],["id","fnombre","type","text","formControlName","nombre","placeholder","Nombre (facturaci\xF3n)",3,"ngClass"],["for","fapellido",1,"label","text-sm","font-[600]","text-base-content","mb-1"],["id","fapellido","type","text","formControlName","apellido","placeholder","Apellido (facturaci\xF3n)",3,"ngClass"],[1,"my-2","px-1","flex","flex-col","md:flex-row","w-full","gap-2","md:gap-3"],["for","ftelefono",1,"label","text-sm","font-[600]","text-base-content","mb-1"],["id","ftelefono","type","tel","inputSoloNumeros","","formControlName","telefono","placeholder","1234567890",3,"ngClass"],["for","femail",1,"label","text-sm","font-[600]","text-base-content","mb-1"],["id","femail","type","email","formControlName","email","placeholder","facturacion@correo.com",3,"ngClass"],[1,"flex","flex-col","md:flex-row","w-full","px-1","gap-2","md:gap-3","mb-4"],["for","fdireccion",1,"label","text-sm","font-[600]","text-base-content","mb-1"],["type","text","id","fdireccion","formControlName","direccion","placeholder","Calle X # 123A-45",3,"keydown","input","ngClass"],["for","fciudadResidencia",1,"label","text-sm","font-[600]","text-base-content","mb-1"],["type","text","id","fciudadResidencia","placeholder","Escriba para buscar una ciudad...","autocomplete","off","role","combobox",3,"input","keydown","focus","blur","value","disabled","ngClass"],["for","ftipoPersona",1,"label","text-sm","font-[600]","text-base-content","mb-1"],["id","ftipoPersona","formControlName","tipoPersona",3,"ngClass"],["for","fregimenTributario",1,"label","text-sm","font-[600]","text-base-content","mb-1"],["id","fregimenTributario","formControlName","regimenTributario",3,"ngClass"],["for","fdigitoVerificacion",1,"label","text-sm","font-[600]","text-base-content","mb-1"],["id","fdigitoVerificacion","type","text","formControlName","digitoVerificacion","placeholder","0","maxlength","1",3,"ngClass"],[1,"loading","loading-spinner","loading-sm"],["type","radio","name","my_tabs","aria-label","Beneficiarios",1,"tab","h-9","md:h-[var(--tab-height)]","font-bold","text-base","lg:text-lg","w-full","md:w-auto","before:bg-none",3,"change","checked"]],template:function(n,i){if(n&1){let s=M();r(0,"div",3)(1,"a",4),c(2," Saltar al contenido principal "),o(),r(3,"a",5),c(4," Saltar a navegaci\xF3n de pesta\xF1as "),o(),r(5,"a",6),c(6," Saltar al formulario "),o(),g(7,"div",7)(8,"div",8)(9,"div",9),r(10,"div",10)(11,"div",11)(12,"div",12)(13,"h1",13),c(14,"Mi Perfil"),o()(),r(15,"div",14)(16,"div",15)(17,"div",16)(18,"h3",17),p(19,Hi,1,2)(20,Wi,1,0),o(),r(21,"div",18),p(22,Xi,2,3)(23,Zi,1,0),o()()()()()(),r(24,"main",19)(25,"div",20)(26,"input",21),P("change",function(){return _(s),v(i.cambiarTab("perfil"))}),o(),r(27,"div",22)(28,"form",23),P("ngSubmit",function(){return _(s),v(i.guardarCambios())}),p(29,et,8,0,"div",24),r(30,"fieldset",25)(31,"legend",26),c(32," Informaci\xF3n Personal "),o(),r(33,"div",27)(34,"div",28)(35,"label",29),c(36," Nombre "),r(37,"span",30),c(38,"*"),o()(),g(39,"input",31),p(40,it,2,1,"div",32),o(),r(41,"div",28)(42,"label",33),c(43," Apellido "),r(44,"span",30),c(45,"*"),o()(),g(46,"input",34),p(47,tt,2,1,"div",32),o()()(),r(48,"fieldset",35)(49,"legend",26),c(50," Informaci\xF3n de Contacto "),o(),r(51,"div",27)(52,"div",28)(53,"label",36),c(54," Tel\xE9fono "),r(55,"span",30),c(56,"*"),o()(),g(57,"input",37),p(58,nt,2,1,"div",32),o(),r(59,"div",28)(60,"label",38),c(61," Fecha de Nacimiento "),r(62,"span",30),c(63,"*"),o()(),r(64,"label",39),g(65,"input",40,0)(67,"app-web-icon",41),o(),g(68,"div",42,1),p(70,at,2,1,"div",32),o()()(),r(71,"fieldset",43)(72,"legend",44),c(73," Informaci\xF3n del Documento "),o(),r(74,"div",45)(75,"div",46)(76,"label",47),c(77," Tipo Doc. "),r(78,"span",30),c(79,"*"),o()(),r(80,"select",48)(81,"option",49),c(82,"Seleccione"),o(),D(83,ot,2,2,"option",50,Y),o(),p(85,rt,2,1,"div",32),o(),r(86,"div",51)(87,"label",52),c(88," Documento "),r(89,"span",30),c(90,"*"),o()(),g(91,"input",53),p(92,ct,2,1,"div",32),o()(),r(93,"div",45)(94,"div",28)(95,"label",54),c(96," Ciudad de Expedici\xF3n "),r(97,"span",30),c(98,"*"),o()(),r(99,"div",55)(100,"input",56),P("input",function(y){return _(s),v(i.onCiudadInputChange(y))})("keydown",function(y){return _(s),v(i.onCiudadKeyDown(y))})("focus",function(){return _(s),v(i.mostrarOpcionesCiudades.set(!0))})("blur",function(){return _(s),v(i.ocultarOpcionesCiudades())}),o(),p(101,lt,3,0,"div",57),p(102,st,3,0,"div",58),o(),p(103,mt,2,1,"div",32),o()()(),r(104,"fieldset",35)(105,"legend",26),c(106," Informaci\xF3n de Ubicaci\xF3n "),o(),r(107,"div",59)(108,"label",60),c(109,"Email "),r(110,"span",30),c(111,"*"),o()(),g(112,"input",61),p(113,ut,2,1,"div",32),o(),r(114,"div",27)(115,"div",28)(116,"label",60),c(117,"Direcci\xF3n "),r(118,"span",30),c(119,"*"),o()(),r(120,"input",62),P("keydown",function(y){return _(s),v(i.bloquearPuntoYComa(y))})("input",function(){return _(s),v(i.sanearDireccionInput("direccion"))}),o(),p(121,pt,2,1,"div",32),o(),r(122,"div",28)(123,"label",63),c(124," Ciudad "),r(125,"span",30),c(126,"*"),o()(),r(127,"div",55)(128,"input",64),P("input",function(y){return _(s),v(i.onCiudadResidenciaInputChange(y))})("keydown",function(y){return _(s),v(i.onCiudadResidenciaKeyDown(y))})("focus",function(){return _(s),v(i.mostrarOpcionesCiudadesResidencia.set(!0))})("blur",function(){return _(s),v(i.ocultarOpcionesCiudadesResidencia())}),o(),p(129,ht,3,0,"div",57),p(130,xt,3,0,"div",58),o(),p(131,bt,2,1,"div",32),o()()(),r(132,"fieldset",43)(133,"legend",44),c(134," Informaci\xF3n Tributaria "),o(),r(135,"div",27)(136,"div",28)(137,"label",65),c(138," Tipo de Persona "),r(139,"span",30),c(140,"*"),o()(),r(141,"select",66)(142,"option",49),c(143,"Seleccione"),o(),r(144,"option",67),c(145,"Persona Natural"),o(),r(146,"option",68),c(147,"Persona Jur\xEDdica"),o()(),p(148,Ct,2,1,"div",32),o(),r(149,"div",28)(150,"label",69),c(151," R\xE9gimen Tributario "),r(152,"span",30),c(153,"*"),o()(),r(154,"select",70)(155,"option",49),p(156,_t,1,0)(157,vt,1,0),o(),D(158,gt,2,2,"option",50,bi),o(),p(160,Et,2,1,"div",32),p(161,St,2,0,"div",71),o()()(),r(162,"div",72)(163,"label",73),g(164,"input",74),r(165,"span",75),c(166," La informaci\xF3n de facturaci\xF3n es diferente a la del usuario "),o()()(),p(167,Jt,109,59,"fieldset",76),r(168,"div",77)(169,"button",78),p(170,Yt,2,0)(171,Xt,2,1),o()()()(),r(172,"input",79),P("change",function(){return _(s),v(i.cambiarTab("password"))}),o(),r(173,"div",22)(174,"form",80),P("ngSubmit",function(){return _(s),v(i.cambiarPassword())}),r(175,"div",81)(176,"div",82)(177,"label",83),c(178," Contrase\xF1a Actual "),r(179,"span",30),c(180,"*"),o()(),g(181,"input",84),p(182,Zt,2,1,"div",32),o(),r(183,"div",82)(184,"label",85),c(185," Nueva Contrase\xF1a "),r(186,"span",30),c(187,"*"),o()(),g(188,"input",86),p(189,en,2,1,"div",32),o(),r(190,"div",82)(191,"label",87),c(192," Confirmar Nueva Contrase\xF1a "),r(193,"span",30),c(194,"*"),o()(),g(195,"input",88),p(196,tn,2,1,"div",32),o()(),r(197,"div",89)(198,"button",90),p(199,nn,2,0)(200,an,1,0),o()()()(),p(201,on,3,1),o()()(),Ae(202,rn,0,0,"ng-template",null,2,je)}if(n&2){let s,u,y;d(19),f((s=i.perfilService.usuario())?19:20,s),d(3),f((u=i.perfilService.usuario())?22:23,u),d(4),h("checked",i.selectedTab()==="perfil"),d(2),h("formGroup",i.perfilForm),d(),f(i.isCompleteProfileMode()?29:-1),d(10),h("ngClass",E(57,T,i.formUtils.esCampoInvalido(i.perfilForm,"nombre"))),d(),f(i.formUtils.esCampoInvalido(i.perfilForm,"nombre")?40:-1),d(6),h("ngClass",E(59,T,i.formUtils.esCampoInvalido(i.perfilForm,"apellido"))),d(),f(i.formUtils.esCampoInvalido(i.perfilForm,"apellido")?47:-1),d(10),h("ngClass",E(61,T,i.formUtils.esCampoInvalido(i.perfilForm,"telefono"))),d(),f(i.formUtils.esCampoInvalido(i.perfilForm,"telefono")?58:-1),d(7),h("ngClass",E(63,Yi,i.formUtils.esCampoInvalido(i.perfilForm,"fechaNacimiento"))),d(2),h("nombreIcono","calendar-outline")("estilos","h-5 w-5"),d(3),f(i.formUtils.esCampoInvalido(i.perfilForm,"fechaNacimiento")?70:-1),d(10),h("ngClass",E(65,J,i.formUtils.esCampoInvalido(i.perfilForm,"tipoDocumento"))),d(3),R(i.appService.tipoDocQuery.data()),d(2),f(i.formUtils.esCampoInvalido(i.perfilForm,"tipoDocumento")?85:-1),d(6),h("ngClass",E(67,T,i.formUtils.esCampoInvalido(i.perfilForm,"documento"))),d(),f(i.formUtils.esCampoInvalido(i.perfilForm,"documento")?92:-1),d(8),h("value",i.ciudadTerminoBusqueda())("ngClass",E(69,T,i.formUtils.esCampoInvalido(i.perfilForm,"ciudadExpedicion"))),k("aria-expanded",i.mostrarOpcionesCiudades())("aria-activedescendant",i.indiceOpcionSeleccionada()>=0?"ciudad-option-"+i.indiceOpcionSeleccionada():null),d(),f(i.mostrarOpcionesCiudades()&&i.ciudadesFiltradas().length>0?101:-1),d(),f(i.mostrarOpcionesCiudades()&&i.ciudadesFiltradas().length===0&&i.ciudadTerminoBusqueda()?102:-1),d(),f(i.formUtils.esCampoInvalido(i.perfilForm,"ciudadExpedicion")?103:-1),d(9),h("ngClass",E(71,T,i.formUtils.esCampoInvalido(i.perfilForm,"email"))),d(),f(i.formUtils.esCampoInvalido(i.perfilForm,"email")?113:-1),d(7),h("ngClass",E(73,xi,i.formUtils.esCampoInvalido(i.perfilForm,"direccion"))),d(),f(i.formUtils.esCampoInvalido(i.perfilForm,"direccion")?121:-1),d(7),h("value",i.ciudadResidenciaTerminoBusqueda())("ngClass",E(75,T,i.formUtils.esCampoInvalido(i.perfilForm,"ciudadResidencia"))),k("aria-expanded",i.mostrarOpcionesCiudadesResidencia())("aria-activedescendant",i.indiceOpcionSeleccionadaResidencia()>=0?"ciudad-residencia-option-"+i.indiceOpcionSeleccionadaResidencia():null),d(),f(i.mostrarOpcionesCiudadesResidencia()&&i.ciudadesResidenciaFiltradas().length>0?129:-1),d(),f(i.mostrarOpcionesCiudadesResidencia()&&i.ciudadesResidenciaFiltradas().length===0&&i.ciudadResidenciaTerminoBusqueda()?130:-1),d(),f(i.formUtils.esCampoInvalido(i.perfilForm,"ciudadResidencia")?131:-1),d(10),h("ngClass",E(77,J,i.formUtils.esCampoInvalido(i.perfilForm,"tipoPersona"))),d(7),f(i.formUtils.esCampoInvalido(i.perfilForm,"tipoPersona")?148:-1),d(6),h("ngClass",E(79,J,i.formUtils.esCampoInvalido(i.perfilForm,"regimenTributario"))),d(2),f(i.perfilService.regimenesTributariosCargando()?156:157),d(2),R(i.perfilService.regimenesTributarios()),d(2),f(i.formUtils.esCampoInvalido(i.perfilForm,"regimenTributario")?160:-1),d(),f(i.perfilService.regimenesTributariosError()?161:-1),d(6),f((y=i.perfilForm.get("usaFacturacionDiferente"))!=null&&y.value?167:-1),d(2),h("disabled",i.perfilForm.invalid||i.perfilService.cargando()),d(),f(i.perfilService.cargando()?170:171),d(2),h("checked",i.selectedTab()==="password"),d(2),h("formGroup",i.passwordForm),d(7),h("ngClass",E(81,Oe,i.formUtils.esCampoInvalido(i.passwordForm,"currentPassword"))),d(),f(i.formUtils.esCampoInvalido(i.passwordForm,"currentPassword")?182:-1),d(6),h("ngClass",E(83,Oe,i.formUtils.esCampoInvalido(i.passwordForm,"newPassword"))),d(),f(i.formUtils.esCampoInvalido(i.passwordForm,"newPassword")?189:-1),d(6),h("ngClass",E(85,Oe,i.formUtils.esCampoInvalido(i.passwordForm,"confirmPassword"))),d(),f(i.formUtils.esCampoInvalido(i.passwordForm,"confirmPassword")?196:-1),d(2),h("disabled",i.passwordForm.invalid||i.perfilService.cargando()),d(),f(i.perfilService.cargando()?199:200),d(2),f(i.esEgresado()?201:-1)}},dependencies:[Ce,oe,ae,xe,le,pe,fe,re,ze,ue,ce,de,Ke,se,me,Ge,Ee,ve,ei,fi],styles:[".perfil-container[_ngcontent-%COMP%]{max-width:800px;margin:0 auto}.perfil-header[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;margin-bottom:20px;padding:20px 0}.perfil-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:24px;font-weight:600;margin:16px 0 4px;color:var(--ion-color-dark)}.perfil-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--ion-color-medium);margin:0}.perfil-avatar[_ngcontent-%COMP%]{width:120px;height:120px;border:4px solid var(--ion-color-light);box-shadow:0 4px 10px #0000001a}ion-card[_ngcontent-%COMP%]{border-radius:12px;box-shadow:0 4px 16px #0000000d;margin:16px 0}ion-card[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--padding-start: 0;--border-color: var(--ion-color-light);--padding-bottom: 8px;--padding-top: 8px}ion-button[_ngcontent-%COMP%]{--border-radius: 8px;font-weight:500}"]});let a=l;return a})();export{Na as PerfilMainPage};
