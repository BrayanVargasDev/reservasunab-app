import{a as W}from"./chunk-M4CGKRW4.js";import{a as J,b as L}from"./chunk-IYAUDCXT.js";import{i as G}from"./chunk-OCOUEVTR.js";import"./chunk-LHBRERJU.js";import"./chunk-WXQYSXFO.js";import"./chunk-AMCW56AE.js";import"./chunk-WNVXENDG.js";import"./chunk-ZU7Q4APP.js";import{a as K}from"./chunk-PQQVET5C.js";import"./chunk-KTGXZBKE.js";import{m as H}from"./chunk-LKADUWP6.js";import"./chunk-6CQPCFUJ.js";import"./chunk-AI3LD7IZ.js";import{a as z}from"./chunk-ODBDBKE7.js";import"./chunk-XPPSGRKL.js";import{h as O}from"./chunk-4HN4PAFJ.js";import"./chunk-AV73RGVI.js";import{f as N}from"./chunk-N4CCYIXR.js";import"./chunk-UAEYNMJW.js";import{C as A,G as h}from"./chunk-YPFPCNBD.js";import{Aa as j,Ba as x,Ca as t,D as _,Da as r,Db as U,Ea as d,H as p,Ia as k,Ib as B,Ja as u,Ka as v,Lb as V,N as R,O as E,Rb as q,U as C,Xa as s,Za as c,ba as I,bc as Q,c as f,da as l,hb as g,ia as T,ib as D,jb as P,pb as $,u as w,v as y,xa as M,z as S,za as F}from"./chunk-U6U25BWF.js";import"./chunk-B3LSNZRN.js";import"./chunk-WUBXWBRT.js";import"./chunk-B52GHH4C.js";import"./chunk-KZ3CI6ZI.js";import"./chunk-HC6MZPB3.js";import"./chunk-SV2ZKNWA.js";import"./chunk-IA5KSSRM.js";import"./chunk-RS5W3JWO.js";import"./chunk-XENCGOZ2.js";import"./chunk-XZRAAXKF.js";import"./chunk-7D6K5XYM.js";import"./chunk-OBXDPQ3V.js";import"./chunk-QY5CJPR3.js";import"./chunk-MCRJI3T3.js";import"./chunk-ZD4SBDZ6.js";import"./chunk-NCLOD2DI.js";import"./chunk-UYQ7EZNZ.js";import"./chunk-BAKMWPBW.js";import"./chunk-AESNPOCP.js";import"./chunk-H3ZVKW6B.js";import"./chunk-HMK4XMX7.js";import"./chunk-E7UUDSES.js";import"./chunk-JQ3FRJ6A.js";import"./chunk-3IVKBF6N.js";import"./chunk-NMYJD6OP.js";import"./chunk-C5RQ2IC2.js";import"./chunk-SV7S5NYR.js";import{j as b}from"./chunk-LVXXLD6S.js";var X=(()=>{let a=class a{constructor(){this.http=p(q),this.authService=p(N),this._filtroTexto=C(""),this.filtroTexto=$(()=>this._filtroTexto()),this.misReservasQuery=A(()=>({queryKey:["misReservas",this._filtroTexto()],queryFn:()=>G(this.http,this._filtroTexto()),select:e=>e.data}))}setFiltroTexto(e){this._filtroTexto.set(e)}limpiarFiltro(){this._filtroTexto.set("")}};a.\u0275fac=function(n){return new(n||a)},a.\u0275prov=_({token:a,factory:a.\u0275fac,providedIn:"root"});let o=a;return o})();var te=["class","page"];function ie(o,a){if(o&1){let i=k();t(0,"div",10)(1,"div",12)(2,"div",13),d(3,"img",14),r(),t(4,"div",15)(5,"h3",16),s(6),r(),t(7,"span",17),s(8),r(),t(9,"span",17),s(10),r(),t(11,"span",17),s(12),r()(),t(13,"div",18)(14,"div",19)(15,"span",20),s(16),r(),t(17,"span",17),s(18),g(19,"date"),r()(),t(20,"div",21)(21,"span",17),s(22,"Estado:"),r(),t(23,"span",22),s(24),g(25,"upperFirst"),r()(),t(26,"div",23)(27,"button",24),u("click",function(){let n=R(i).$implicit,m=v();return E(m.verDetalleReserva(n.id))}),d(28,"app-web-icon",25),t(29,"span",26),s(30,"Ver detalles"),r(),t(31,"span",27),s(32,"Ver"),r()()()()()()}if(o&2){let i=a.$implicit,e=v();l(3),x("src",e.getImagenUrl(i.espacio.imagen!=null&&i.espacio.imagen.ubicacion?i.espacio.imagen==null?null:i.espacio.imagen.ubicacion:"assets/images/placeholder.png"),I)("alt",i.espacio.imagen!=null&&i.espacio.imagen.ubicacion?"Imagen de "+i.espacio.nombre:"Imagen no disponible"),l(3),c(" Reserva ",i.codigo.slice(10)," "),l(2),c(" Espacio: ",i.espacio.nombre," "),l(2),c(" Sede: ",i.espacio.sede.nombre," "),l(2),c(" Categor\xEDa: ",i.espacio.categoria.nombre," "),l(4),c(" Fecha: ",e.formatearFechaReserva(i.fecha)," "),l(2),c(" Hora: ",P(19,10,i.hora_inicio,"shortTime")," "),l(5),x("ngClass",`badge-${e.pagosService.obtenerColorEstado(i.estado)}`),l(),c(" ",i.estado==="pendienteap"?"Pendiente de aprobaci\xF3n":D(25,13,i.estado)," ")}}function re(o,a){if(o&1&&(t(0,"div",11),d(1,"app-web-icon",28),t(2,"span",29),s(3," No tienes reservas que coincidan con "),t(4,"strong"),s(5),r()(),t(6,"span",29),s(7,' Intenta con otro t\xE9rmino de b\xFAsqueda o crea una haciendo click en "Reservar" '),r()()),o&2){let i=v();l(5),c('"',i.misReservasService.filtroTexto(),'"')}}var Ie=(()=>{let a=class a{constructor(){this.misReservasService=p(X),this.router=p(Q),this.environment=h,this.dreservasService=p(J),this.destroy$=new f,this.searchSubject=new f,this.pagosService=p(K)}ngOnInit(){this.searchSubject.pipe(w(300),y(),S(this.destroy$)).subscribe(e=>{this.misReservasService.setFiltroTexto(e)})}get misReservas(){return this.misReservasService.misReservasQuery.data()}getImagenUrl(e){return e?`${h.apiUrl}${e}`:""}sePuedeCancelar(e){return e.puede_cancelar&&e.estado==="pendiente"}navegarReservas(){this.router.navigate(["reservas"])}formatearFechaReserva(e){let n=typeof e=="string"?new Date(e):e;return H(n,"dd/MM/yyyy")}aplicarFiltro(e){this.searchSubject.next(e)}verDetalleReserva(e){return b(this,null,function*(){this.dreservasService.abrirModal(!0),this.dreservasService.setCargando("Cargando reserva..."),this.dreservasService.setIdMiReserva(e),yield new Promise(n=>setTimeout(n,100));try{let m=(yield this.dreservasService.miReservaQuery.refetch()).data;m?this.dreservasService.setMostrarResumenExistente(m):(this.dreservasService.cerrarModal(),console.error("No se pudo cargar la reserva. Por favor, int\xE9ntalo de nuevo."))}catch(n){console.error("Error al obtener mi reserva:",n),this.dreservasService.cerrarModal()}})}cancelarReserva(e){this.verDetalleReserva(e.id)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}};a.\u0275fac=function(n){return new(n||a)},a.\u0275cmp=T({type:a,selectors:[["app-mis-reservas",8,"page"]],hostAttrs:[1,"flex","flex-col","h-full","w-full","sm:pl-3","overflow-y-auto"],attrs:te,decls:16,vars:2,consts:[[1,"flex","flex-col","md:flex-row","lg:px-4","w-full","pb-2","justify-center","lg:justify-between","sticky","top-0","z-10","bg-base-300","sm:gap-3","lg:gap-0"],[1,"flex","max-md:pt-2","max-md:flex-row","max-md:items-center","max-md:justify-between","flex-col","w-full","lg:w-auto","gap-1","lg:gap-2"],[1,"mb-2","md:mb-0","font-bold","text-2xl","sm:text-3xl","lg:text-4xl"],["estilos","py-0"],[1,"flex","flex-col","sm:flex-row","gap-2","py-1","sm:gap-3","w-full","lg:w-auto","max-sm:px-1"],["type","text","placeholder","Buscar...",1,"input","max-sm:input-sm","input-bordered","input-primary","w-full","md:h-11","rounded-box","lg:max-w-xs","placeholder:text-gray-500","placeholder:text-sm","disabled:placeholder:text-gray-400",3,"input","value"],[1,"btn","btn-primary","max-sm:btn-sm","md:h-11","rounded-box","w-full","sm:w-auto",3,"click"],["estilos","h-5 w-5 sm:h-6 sm:w-6","nombreIcono","calendar-outline"],[1,"inline","max-sm:text-sm","text-base"],[1,"lg:pl-4","grid","w-full","grow","auto-rows-1","grid-cols-1","overflow-y-auto","max-md:gap-1","gap-2","place-items-center"],[1,"bg-base-100","rounded-box","p-3","sm:p-4","shadow-sm","w-full"],[1,"alert","text-base","xl:text-lg","max-sm:gap-1","gap-2","alert-info","alert-outline","w-full","rounded-box","flex","flex-col","items-center","justify-center"],[1,"flex","flex-wrap","w-full","gap-4","md:gap-6"],[1,"flex-shrink-0","w-full","md:w-auto"],[1,"max-md:w-full","w-38","h-full","max-h-[6.75rem]","object-cover","rounded-md","mx-auto","md:mx-0",3,"src","alt"],[1,"flex","flex-col","flex-grow"],[1,"max-sm:text-sm","text-base","font-semibold","text-base-content"],[1,"text-gray-400","max-sm:text-xs","text-sm"],[1,"flex","flex-col","md:flex-col","w-full","max-w-44"],[1,"flex","flex-col","sm:flex-row","md:flex-col"],[1,"text-base-content","font-semibold","max-sm:text-sm","text-base"],[1,"flex","w-full","flex-wrap","lg:items-center","lg:justify-between","gap-2"],[1,"badge","font-semibold","max-sm:text-xs","text-sm","w-min",3,"ngClass"],[1,"flex","gap-2","mt-1"],[1,"btn","btn-secondary","btn-sm","rounded-lg","max-sm:h-9","flex-1",3,"click"],["estilos","max-sm:h-4 h-5 max-sm:w-4 h-5","nombreIcono","eye-outline"],[1,"hidden","sm:inline","max-sm:text-sm","text-base"],[1,"sm:hidden","max-sm:text-sm","text-base"],["estilos","h-16 w-16 text-3xl","nombreIcono","search-circle-outline"],[1,"text-center"]],template:function(n,m){n&1&&(t(0,"div",0)(1,"div",1)(2,"h2",2),s(3," Mis reservas "),r(),d(4,"app-breadcrumbs",3),r(),t(5,"div",4)(6,"input",5),u("input",function(Z){return m.aplicarFiltro(Z.target.value)}),r(),t(7,"button",6),u("click",function(){return m.navegarReservas()}),d(8,"app-web-icon",7),t(9,"span",8),s(10,"Reservar"),r()()()(),t(11,"div",9),F(12,ie,33,15,"div",10,M,!1,re,8,1,"div",11),r(),d(15,"modal-dreservas")),n&2&&(l(6),x("value",m.misReservasService.filtroTexto()),l(6),j(m.misReservas))},dependencies:[V,U,B,O,W,L,z],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0});let o=a;return o})();export{Ie as default};
