import{a as He}from"./chunk-ZU7Q4APP.js";import{g as L}from"./chunk-6CQPCFUJ.js";import{a as Z}from"./chunk-3J7GGTVR.js";import{b as Fe,h as Te}from"./chunk-4HN4PAFJ.js";import{e as Ee,f as Ae}from"./chunk-N4CCYIXR.js";import{F as Ie,v as Oe}from"./chunk-UAEYNMJW.js";import{C as A,G as x,g as we,j as k,m as Se,q as Me,r as _e,s as Re,z as De}from"./chunk-YPFPCNBD.js";import{Aa as U,Ba as u,Ca as n,D as Q,Da as s,E as ee,Ea as p,Fb as xe,H as v,Ia as K,Ja as Y,Jb as ye,Ka as w,Kb as W,Lb as S,Mb as Ce,N,O as B,Oa as ne,Pa as de,Pb as C,Qa as ce,R as te,Ra as le,Rb as Pe,Sa as me,U as P,W as ae,Xa as h,Ya as pe,Za as M,_ as re,ab as he,bb as E,da as l,e as J,ha as oe,hb as ue,ia as y,ja as ie,jb as fe,k as b,na as z,pa as se,pb as g,qb as ge,rb as be,sb as c,tb as ve,va as D,wa as O,xa as T,za as H}from"./chunk-U6U25BWF.js";import"./chunk-B3LSNZRN.js";import"./chunk-WUBXWBRT.js";import{a as X,b as j}from"./chunk-AUJJZC6I.js";import"./chunk-B52GHH4C.js";import"./chunk-KZ3CI6ZI.js";import"./chunk-HC6MZPB3.js";import"./chunk-SV2ZKNWA.js";import"./chunk-IA5KSSRM.js";import"./chunk-RS5W3JWO.js";import"./chunk-XENCGOZ2.js";import"./chunk-XZRAAXKF.js";import"./chunk-7D6K5XYM.js";import"./chunk-OBXDPQ3V.js";import"./chunk-QY5CJPR3.js";import"./chunk-MCRJI3T3.js";import"./chunk-ZD4SBDZ6.js";import"./chunk-NCLOD2DI.js";import"./chunk-UYQ7EZNZ.js";import"./chunk-BAKMWPBW.js";import"./chunk-AESNPOCP.js";import"./chunk-H3ZVKW6B.js";import"./chunk-HMK4XMX7.js";import"./chunk-E7UUDSES.js";import"./chunk-JQ3FRJ6A.js";import"./chunk-3IVKBF6N.js";import"./chunk-NMYJD6OP.js";import"./chunk-C5RQ2IC2.js";import"./chunk-SV7S5NYR.js";import{j as m}from"./chunk-LVXXLD6S.js";function tt(a){a.CapacitorUtils.Synapse=new Proxy({},{get(r,i){return new Proxy({},{get(e,t){return(o,d,f)=>{let F=a.Capacitor.Plugins[i];if(F===void 0){f(new Error(`Capacitor plugin ${i} not found`));return}if(typeof F[t]!="function"){f(new Error(`Method ${t} not found in Capacitor plugin ${i}`));return}m(null,null,function*(){try{let q=yield F[t](o);d(q)}catch(q){f(q)}})}}})}})}function at(a){a.CapacitorUtils.Synapse=new Proxy({},{get(r,i){return a.cordova.plugins[i]}})}function Ue(a=!1){typeof window>"u"||(window.CapacitorUtils=window.CapacitorUtils||{},window.Capacitor!==void 0&&!a?tt(window):window.cordova!==void 0&&at(window))}var ke=j("Filesystem",{web:()=>import("./chunk-TAJYHKRL.js").then(a=>new a.FilesystemWeb)});Ue();var Qe=j("FileOpener");var je=(()=>{let r=class r{constructor(){this.platform=v(Oe)}downloadFile(e){return m(this,null,function*(){let{filename:t,mimeType:o,data:d}=e;X.isNativePlatform()?yield this.downloadFileNative(t,o,d):this.downloadFileWeb(t,d)})}downloadFileWeb(e,t){let o=window.URL.createObjectURL(t),d=document.createElement("a");d.href=o,d.download=e,document.body.appendChild(d),d.click(),document.body.removeChild(d),window.URL.revokeObjectURL(o)}downloadFileNative(e,t,o){return m(this,null,function*(){try{let d=yield this.blobToBase64(o),f=yield ke.writeFile({path:e,data:d,directory:Z.Documents});yield Qe.open({filePath:f.uri,contentType:t,openWithDefault:!0})}catch(d){throw console.error("Error al descargar archivo en plataforma nativa:",d),d}})}blobToBase64(e){return new Promise((t,o)=>{let d=new FileReader;d.onloadend=()=>{let f=d.result.split(",")[1];t(f)},d.onerror=o,d.readAsDataURL(e)})}isNativePlatform(){return X.isNativePlatform()}getDownloadDirectory(){return this.platform.is("ios")?Z.Documents:Z.Documents}};r.\u0275fac=function(t){return new(t||r)},r.\u0275prov=Q({token:r,factory:r.\u0275fac,providedIn:"root"});let a=r;return a})();var rt=["chart"],_=(()=>{let r=class r{constructor(){this.chart=c(),this.annotations=c(),this.colors=c(),this.dataLabels=c(),this.series=c(),this.stroke=c(),this.labels=c(),this.legend=c(),this.markers=c(),this.noData=c(),this.parsing=c(),this.fill=c(),this.tooltip=c(),this.plotOptions=c(),this.responsive=c(),this.xaxis=c(),this.yaxis=c(),this.forecastDataPoints=c(),this.grid=c(),this.states=c(),this.title=c(),this.subtitle=c(),this.theme=c(),this.autoUpdateSeries=c(!0),this.chartReady=be(),this.chartInstance=P(null),this.chartElement=ve.required("chart"),this.ngZone=v(se),this.isBrowser=Ce(v(re))}ngOnChanges(e){this.isBrowser&&this.ngZone.runOutsideAngular(()=>{J.schedule(()=>this.hydrate(e))})}ngOnDestroy(){this.destroy()}hydrate(e){if(this.autoUpdateSeries()&&Object.keys(e).filter(o=>o!=="series").length===0){this.updateSeries(this.series(),!0);return}this.createElement()}createElement(){return m(this,null,function*(){let{default:e}=yield import("./chunk-2ZZVYQ6T.js");window.ApexCharts||=e;let t={};["annotations","chart","colors","dataLabels","series","stroke","labels","legend","fill","tooltip","plotOptions","responsive","markers","noData","parsing","xaxis","yaxis","forecastDataPoints","grid","states","title","subtitle","theme"].forEach(f=>{let F=this[f]();F&&(t[f]=F)}),this.destroy();let d=this.ngZone.runOutsideAngular(()=>new e(this.chartElement().nativeElement,t));this.chartInstance.set(d),this.render(),this.chartReady.emit({chartObj:d})})}render(){return this.ngZone.runOutsideAngular(()=>this.chartInstance()?.render())}updateOptions(e,t,o,d){return this.ngZone.runOutsideAngular(()=>this.chartInstance()?.updateOptions(e,t,o,d))}updateSeries(e,t){return this.ngZone.runOutsideAngular(()=>this.chartInstance()?.updateSeries(e,t))}appendSeries(e,t){this.ngZone.runOutsideAngular(()=>this.chartInstance()?.appendSeries(e,t))}appendData(e){this.ngZone.runOutsideAngular(()=>this.chartInstance()?.appendData(e))}highlightSeries(e){return this.ngZone.runOutsideAngular(()=>this.chartInstance()?.highlightSeries(e))}toggleSeries(e){return this.ngZone.runOutsideAngular(()=>this.chartInstance()?.toggleSeries(e))}showSeries(e){this.ngZone.runOutsideAngular(()=>this.chartInstance()?.showSeries(e))}hideSeries(e){this.ngZone.runOutsideAngular(()=>this.chartInstance()?.hideSeries(e))}resetSeries(){this.ngZone.runOutsideAngular(()=>this.chartInstance()?.resetSeries())}zoomX(e,t){this.ngZone.runOutsideAngular(()=>this.chartInstance()?.zoomX(e,t))}toggleDataPointSelection(e,t){this.ngZone.runOutsideAngular(()=>this.chartInstance()?.toggleDataPointSelection(e,t))}destroy(){this.chartInstance()?.destroy(),this.chartInstance.set(null)}setLocale(e){this.ngZone.runOutsideAngular(()=>this.chartInstance()?.setLocale(e))}paper(){this.ngZone.runOutsideAngular(()=>this.chartInstance()?.paper())}addXaxisAnnotation(e,t,o){this.ngZone.runOutsideAngular(()=>this.chartInstance()?.addXaxisAnnotation(e,t,o))}addYaxisAnnotation(e,t,o){this.ngZone.runOutsideAngular(()=>this.chartInstance()?.addYaxisAnnotation(e,t,o))}addPointAnnotation(e,t,o){this.ngZone.runOutsideAngular(()=>this.chartInstance()?.addPointAnnotation(e,t,o))}removeAnnotation(e,t){this.ngZone.runOutsideAngular(()=>this.chartInstance()?.removeAnnotation(e,t))}clearAnnotations(e){this.ngZone.runOutsideAngular(()=>this.chartInstance()?.clearAnnotations(e))}dataURI(e){return this.chartInstance()?.dataURI(e)}};r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=y({type:r,selectors:[["apx-chart"]],viewQuery:function(t,o){t&1&&le(o.chartElement,rt,5),t&2&&me()},inputs:{chart:[1,"chart"],annotations:[1,"annotations"],colors:[1,"colors"],dataLabels:[1,"dataLabels"],series:[1,"series"],stroke:[1,"stroke"],labels:[1,"labels"],legend:[1,"legend"],markers:[1,"markers"],noData:[1,"noData"],parsing:[1,"parsing"],fill:[1,"fill"],tooltip:[1,"tooltip"],plotOptions:[1,"plotOptions"],responsive:[1,"responsive"],xaxis:[1,"xaxis"],yaxis:[1,"yaxis"],forecastDataPoints:[1,"forecastDataPoints"],grid:[1,"grid"],states:[1,"states"],title:[1,"title"],subtitle:[1,"subtitle"],theme:[1,"theme"],autoUpdateSeries:[1,"autoUpdateSeries"]},outputs:{chartReady:"chartReady"},features:[ae],decls:2,vars:0,consts:[["chart",""]],template:function(t,o){t&1&&p(0,"div",null,0)},encapsulation:2,changeDetection:0});let a=r;return a})();var R=(()=>{let r=class r{};r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=ie({type:r}),r.\u0275inj=ee({});let a=r;return a})();var Le=(()=>{let r=class r{constructor(){this.data=c.required(),this.chartOptions=g(()=>({series:[{name:"Completadas",data:this.data().map(e=>e.completadas)},{name:"Canceladas",data:this.data().map(e=>e.canceladas)},{name:"Total",data:this.data().map(e=>e.total)}],chart:{type:"line",height:350,zoom:{enabled:!1},toolbar:{show:!1}},stroke:{curve:"smooth",width:3},xaxis:{categories:this.data().map(e=>e.mes),title:{text:"Meses del a\xF1o"}},yaxis:{title:{text:"N\xFAmero de reservas"}},colors:["#84cb01","#ce013f","#9e01e2"],grid:{show:!0}}))}};r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=y({type:r,selectors:[["app-chart-reservas-mes"]],inputs:{data:[1,"data"]},decls:1,vars:7,consts:[[3,"series","chart","stroke","xaxis","yaxis","colors","grid"]],template:function(t,o){t&1&&p(0,"apx-chart",0),t&2&&u("series",o.chartOptions().series)("chart",o.chartOptions().chart)("stroke",o.chartOptions().stroke)("xaxis",o.chartOptions().xaxis)("yaxis",o.chartOptions().yaxis)("colors",o.chartOptions().colors)("grid",o.chartOptions().grid)},dependencies:[R,_,S],encapsulation:2,changeDetection:0});let a=r;return a})();var Ze=(()=>{let r=class r{constructor(){this.data=c.required(),this.chartOptions=g(()=>({series:[{name:"Promedio",data:this.data().map(e=>e.promedio)}],chart:{type:"bar",height:350,toolbar:{show:!1},zoom:{enabled:!1}},plotOptions:{bar:{horizontal:!1,borderRadius:4,dataLabels:{position:"top",colors:["#314157"]}}},yaxis:{title:{text:"Promedio de Reservas"}},xaxis:{categories:this.data().map(e=>e.hora),title:{text:"Hora del d\xEDa"},labels:{formatter:e=>e&&typeof e=="string"?e.replace(":00",""):e||""}},colors:["#ffa200","#314157"],grid:{show:!0}}))}};r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=y({type:r,selectors:[["app-chart-promedio-horas"]],inputs:{data:[1,"data"]},decls:1,vars:6,consts:[[3,"series","chart","plotOptions","xaxis","colors","grid"]],template:function(t,o){t&1&&p(0,"apx-chart",0),t&2&&u("series",o.chartOptions().series)("chart",o.chartOptions().chart)("plotOptions",o.chartOptions().plotOptions)("xaxis",o.chartOptions().xaxis)("colors",o.chartOptions().colors)("grid",o.chartOptions().grid)},dependencies:[R,_,S],encapsulation:2});let a=r;return a})();var Ve=(()=>{let r=class r{constructor(){this.data=c.required(),this.chartOptions=g(()=>{let e=this.data().filter(t=>t&&t.categoria&&t.cantidad!==void 0&&t.cantidad!==null);return e.length===0?{series:[],chart:{type:"pie",height:350,zoom:{enabled:!1},animations:{enabled:!1}},labels:[],colors:["#1244e3","#84cb01","#ffa200","#ce013f","#9e01e2","#00a1cf","#ffc408"],legend:{position:"bottom"},noData:{text:"No hay datos disponibles",align:"center",verticalAlign:"middle",style:{color:"#6B7280",fontSize:"14px"}}}:{series:e.map(t=>t.cantidad),chart:{type:"pie",height:350},labels:e.map(t=>t.categoria),colors:["#1244e3","#84cb01","#ffa200","#ce013f","#9e01e2","#00a1cf","#ffc408"],legend:{position:"bottom"}}})}};r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=y({type:r,selectors:[["app-chart-reservas-categoria"]],inputs:{data:[1,"data"]},decls:1,vars:5,consts:[[3,"series","chart","labels","colors","legend"]],template:function(t,o){t&1&&p(0,"apx-chart",0),t&2&&u("series",o.chartOptions().series)("chart",o.chartOptions().chart)("labels",o.chartOptions().labels)("colors",o.chartOptions().colors)("legend",o.chartOptions().legend)},dependencies:[R,_,S],encapsulation:2});let a=r;return a})();var $e=(()=>{let r=class r{constructor(){this.data=c.required(),this.currencyPipe=v(W),this.chartOptions=g(()=>({series:[{name:"Recaudo",data:this.data().map(e=>e.recaudo)}],chart:{type:"line",height:350,toolbar:{show:!1},zoom:{enabled:!1},animations:{enabled:!1}},stroke:{curve:"straight",width:3},xaxis:{categories:this.data().map(e=>e.mes),title:{text:"Meses del a\xF1o"}},colors:["#1244e3"],grid:{show:!0},yaxis:{title:{text:"Cantidad recaudada"},labels:{formatter:e=>this.currencyPipe.transform(e,"$","symbol","1.0-0")||""}},tooltip:{y:{formatter:e=>this.currencyPipe.transform(e,"$","symbol","1.0-0")||""}}}))}};r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=y({type:r,selectors:[["app-chart-recaudo-mensual"]],inputs:{data:[1,"data"]},features:[he([W])],decls:1,vars:7,consts:[[3,"series","chart","stroke","yaxis","xaxis","colors","grid"]],template:function(t,o){t&1&&p(0,"apx-chart",0),t&2&&u("series",o.chartOptions().series)("chart",o.chartOptions().chart)("stroke",o.chartOptions().stroke)("yaxis",o.chartOptions().yaxis)("xaxis",o.chartOptions().xaxis)("colors",o.chartOptions().colors)("grid",o.chartOptions().grid)},dependencies:[R,_,S],encapsulation:2,changeDetection:0});let a=r;return a})();function G(a,r){return L(a,r?.in).getMonth()}function qe(a,r){return L(a,r?.in).getFullYear()}var ot=x.apiUrl,Ne=(a,r,i)=>m(null,null,function*(){let e=new C;return e=e.append("mes",r.toString()),i&&(e=e.append("anio",i.toString())),b(a.get(`${ot}/dashboard/descargar-pagos-excel`,{params:e,responseType:"blob"}))});var it=x.apiUrl,Be=(a,r,i)=>m(null,null,function*(){let e=new C;return e=e.append("mes",r.toString()),i&&(e=e.append("anio",i.toString())),b(a.get(`${it}/dashboard/descargar-reservas-excel`,{params:e,responseType:"blob"}))});var st=x.apiUrl,ze=a=>m(null,null,function*(){return b(a.get(`${st}/dashboard/anios-con-reservas`))});var nt=x.apiUrl,Ke=a=>m(null,null,function*(){return b(a.get(`${nt}/dashboard/indicadores`))});var dt=x.apiUrl,Ye=(a,r,i)=>m(null,null,function*(){let e=new C;return r&&(e=e.append("anio",r.toString())),i&&(e=e.append("mes",i.toString())),b(a.get(`${dt}/dashboard/promedio-por-horas`,{params:e}))});var ct=x.apiUrl,We=(a,r)=>m(null,null,function*(){let i=new C;return r&&(i=i.append("anio",r.toString())),b(a.get(`${ct}/dashboard/recaudo-mensual`,{params:i}))});var lt=x.apiUrl,Xe=(a,r,i)=>m(null,null,function*(){let e=new C;return r&&(e=e.append("anio",r.toString())),i&&(e=e.append("mes",i.toString())),b(a.get(`${lt}/dashboard/reservas-por-categoria`,{params:e}))});var mt=x.apiUrl,Ge=(a,r)=>m(null,null,function*(){let i=new C;return r&&(i=i.append("anio",r.toString())),b(a.get(`${mt}/dashboard/reservas-por-mes`,{params:i}))});var Je=(()=>{let r=class r{constructor(){this.http=v(Pe),this._anioReservasPorMes=P(0),this._anioRecaudoMensual=P(0),this._mesPromedioHoras=P(0),this._mesReservasCategoria=P(0),this.reservasPorMesQuery=A(()=>({queryKey:["dashboard","reservas-por-mes",this._anioReservasPorMes()],queryFn:()=>Ge(this.http,this._anioReservasPorMes()),refetchInterval:6e4,select:t=>t.data})),this.promedioPorHorasQuery=A(()=>({queryKey:["dashboard","promedio-por-horas",this._mesPromedioHoras()],queryFn:()=>Ye(this.http,void 0,this._mesPromedioHoras()),refetchInterval:6e4,select:t=>t.data})),this.reservasPorCategoriaQuery=A(()=>({queryKey:["dashboard","reservas-por-categoria",this._mesReservasCategoria()],queryFn:()=>Xe(this.http,void 0,this._mesReservasCategoria()),refetchInterval:6e4,select:t=>t.data})),this.recaudoMensualQuery=A(()=>({queryKey:["dashboard","recaudo-mensual",this._anioRecaudoMensual()],queryFn:()=>We(this.http,this._anioRecaudoMensual()),refetchInterval:6e4,select:t=>t.data})),this.indicadoresQuery=A(()=>({queryKey:["dashboard","indicadores"],queryFn:()=>Ke(this.http),refetchInterval:60*1e3*3,select:t=>t.data})),this.aniosConReservasQuery=A(()=>({queryKey:["dashboard","anios-con-reservas"],queryFn:()=>ze(this.http),staleTime:1/0,select:t=>t.data})),this.anioReservasPorMes=g(()=>this._anioReservasPorMes()),this.anioRecaudoMensual=g(()=>this._anioRecaudoMensual()),this.mesPromedioHoras=g(()=>this._mesPromedioHoras()),this.mesReservasCategoria=g(()=>this._mesReservasCategoria());let e=qe(new Date);this._anioReservasPorMes.set(e),this._anioRecaudoMensual.set(e),this._mesPromedioHoras.set(G(new Date)+1),this._mesReservasCategoria.set(G(new Date)+1)}setAnioReservasPorMes(e){this._anioReservasPorMes.set(e)}setAnioRecaudoMensual(e){this._anioRecaudoMensual.set(e)}setMesPromedioHoras(e){this._mesPromedioHoras.set(e)}setMesReservasCategoria(e){this._mesReservasCategoria.set(e)}};r.\u0275fac=function(t){return new(t||r)},r.\u0275prov=Q({token:r,factory:r.\u0275fac,providedIn:"root"});let a=r;return a})();var pt=["alertaDashboard"],$=()=>[],et=()=>[1,2,3,4,5,6,7,8,9,10,11,12];function ht(a,r){a&1&&p(0,"span",7)}function ut(a,r){if(a&1&&(n(0,"span",8),h(1),s()),a&2){let i,e=w();l(),M(" ",((i=e.indicadores())==null?null:i.reservas_hoy)||0," ")}}function ft(a,r){a&1&&p(0,"span",12)}function gt(a,r){if(a&1&&(n(0,"span",8),h(1),s()),a&2){let i,e=w();l(),M(" ",((i=e.indicadores())==null?null:i.ocupacion_hoy)||0,"% ")}}function bt(a,r){a&1&&p(0,"span",15)}function vt(a,r){if(a&1&&(n(0,"span",8),h(1),s()),a&2){let i,e=w();l(),M(" ",(i=e.indicadores())==null?null:i.usuarios_hoy," ")}}function xt(a,r){a&1&&p(0,"span",18)}function yt(a,r){if(a&1&&(n(0,"span",8),h(1),ue(2,"number"),s()),a&2){let i,e=w();l(),M(" $",fe(2,1,(i=e.indicadores())==null?null:i.recaudado_hoy,"1.0-0")," ")}}function Ct(a,r){if(a&1&&(n(0,"option",26),h(1),s()),a&2){let i=r.$implicit;u("value",i),l(),M(" ",i," ")}}function Pt(a,r){a&1&&p(0,"span",36)}function wt(a,r){a&1&&p(0,"app-web-icon",37)}function St(a,r){if(a&1){let i=K();n(0,"button",35),Y("click",function(){N(i);let t=w();return B(t.descargarReservas())}),D(1,Pt,1,0,"span",36)(2,wt,1,0,"app-web-icon",37),h(3," Descargar "),s()}if(a&2){let i=w();u("disabled",i.descargandoReservas()||i.selectsDisabled()),l(),O(i.descargandoReservas()?1:2)}}function Mt(a,r){if(a&1&&(n(0,"option",26),h(1),s()),a&2){let i=r.$implicit,e=w();u("value",i),l(),M(" ",e.getNombreMes(i)," ")}}function _t(a,r){if(a&1&&(n(0,"option",26),h(1),s()),a&2){let i=r.$implicit,e=w();u("value",i),l(),M(" ",e.getNombreMes(i)," ")}}function Rt(a,r){if(a&1&&(n(0,"option",26),h(1),s()),a&2){let i=r.$implicit;u("value",i),l(),M(" ",i," ")}}function Dt(a,r){a&1&&p(0,"span",36)}function Ot(a,r){a&1&&p(0,"app-web-icon",37)}function Et(a,r){if(a&1){let i=K();n(0,"button",35),Y("click",function(){N(i);let t=w();return B(t.descargarPagos())}),D(1,Dt,1,0,"span",36)(2,Ot,1,0,"app-web-icon",37),h(3," Descargar "),s()}if(a&2){let i=w();u("disabled",i.descargandoPagos()||i.selectsDisabled()),l(),O(i.descargandoPagos()?1:2)}}var Kr=(()=>{let r=class r{constructor(){this.authService=v(Ae),this.globalLoader=v(Ee),this.dashboardService=v(Je),this.alertasService=v(He),this.injector=v(te),this.fileDownloadService=v(je),this.permisos=Fe,this.anioReservasPorMesControl=new k(0),this.anioRecaudoMensualControl=new k(0),this.mesPromedioHorasControl=new k(0),this.mesReservasCategoriaControl=new k(0),this.descargandoReservas=P(!1),this.descargandoPagos=P(!1),this.selectsDisabled=P(!1),this.reservasPorMesQuery=this.dashboardService.reservasPorMesQuery,this.promedioPorHorasQuery=this.dashboardService.promedioPorHorasQuery,this.reservasPorCategoriaQuery=this.dashboardService.reservasPorCategoriaQuery,this.recaudoMensualQuery=this.dashboardService.recaudoMensualQuery,this.indicadores=g(()=>this.dashboardService.indicadoresQuery.data()),this.usuario=g(()=>this.authService.usuario()),this.aniosConReservas=g(()=>this.dashboardService.aniosConReservasQuery.data())}ngOnInit(){this.globalLoader.hide();let e=this.dashboardService.anioReservasPorMes();this.anioReservasPorMesControl.setValue(e);let t=this.dashboardService.anioRecaudoMensual();this.anioRecaudoMensualControl.setValue(t);let o=this.dashboardService.mesPromedioHoras();this.mesPromedioHorasControl.setValue(o);let d=this.dashboardService.mesReservasCategoria();this.mesReservasCategoriaControl.setValue(d),this.anioReservasPorMesControl.valueChanges.subscribe(f=>{f&&this.dashboardService.setAnioReservasPorMes(f)}),this.anioRecaudoMensualControl.valueChanges.subscribe(f=>{f&&this.dashboardService.setAnioRecaudoMensual(f)}),this.mesPromedioHorasControl.valueChanges.subscribe(f=>{f&&this.dashboardService.setMesPromedioHoras(f)}),this.mesReservasCategoriaControl.valueChanges.subscribe(f=>{f&&this.dashboardService.setMesReservasCategoria(f)}),ge(()=>{this.selectsDisabled()?(this.anioReservasPorMesControl.disable(),this.anioRecaudoMensualControl.disable(),this.mesPromedioHorasControl.disable(),this.mesReservasCategoriaControl.disable()):(this.anioReservasPorMesControl.enable(),this.anioRecaudoMensualControl.enable(),this.mesPromedioHorasControl.enable(),this.mesReservasCategoriaControl.enable())},{injector:this.injector})}descargarReservas(){return m(this,null,function*(){if(!this.alertaDashboard)return;let e=yield this.alertasService.confirmacionConMes({tipo:"question",titulo:"Descargar Reporte de Reservas",mensaje:"Selecciona el mes para descargar el reporte de reservas en Excel.",referencia:this.alertaDashboard,botones:[{texto:"Cancelar",tipo:"cancelar",estilo:"btn-ghost"},{texto:"Descargar",tipo:"confirmar",estilo:"btn-secondary"}]});e.confirmado&&(yield this.procesarDescargaReservas(e.mes))})}descargarPagos(){return m(this,null,function*(){if(!this.alertaDashboard)return;let e=yield this.alertasService.confirmacionConMes({tipo:"question",titulo:"Descargar Reporte de Pagos",mensaje:"Selecciona el mes para descargar el reporte de pagos en Excel.",referencia:this.alertaDashboard,botones:[{texto:"Cancelar",tipo:"cancelar",estilo:"btn-ghost"},{texto:"Descargar",tipo:"confirmar",estilo:"btn-secondary"}]});e.confirmado&&(yield this.procesarDescargaPagos(e.mes))})}procesarDescargaReservas(e){return m(this,null,function*(){try{this.descargandoReservas.set(!0),this.selectsDisabled.set(!0);let t=this.anioReservasPorMesControl.value||this.dashboardService.anioReservasPorMes(),o=yield Be(this.dashboardService.http,e,t),d=`reservas-${t}-${e.toString().padStart(2,"0")}.xlsx`;yield this.fileDownloadService.downloadFile({filename:d,mimeType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",data:o}),this.alertaDashboard&&this.alertasService.success("Reporte de reservas descargado exitosamente.",3e3,this.alertaDashboard)}catch(t){console.error("Error al descargar reservas:",t),this.alertaDashboard&&this.alertasService.error("Error al descargar el reporte de reservas. Por favor, int\xE9ntalo de nuevo.",5e3,this.alertaDashboard)}finally{this.descargandoReservas.set(!1),this.selectsDisabled.set(!1)}})}procesarDescargaPagos(e){return m(this,null,function*(){try{this.descargandoPagos.set(!0),this.selectsDisabled.set(!0);let t=this.anioRecaudoMensualControl.value||this.dashboardService.anioRecaudoMensual(),o=yield Ne(this.dashboardService.http,e,t),d=`pagos-${t}-${e.toString().padStart(2,"0")}.xlsx`;yield this.fileDownloadService.downloadFile({filename:d,mimeType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",data:o}),this.alertaDashboard&&this.alertasService.success("Reporte de pagos descargado exitosamente.",3e3,this.alertaDashboard)}catch(t){console.error("Error al descargar pagos:",t),this.alertaDashboard&&this.alertasService.error("Error al descargar el reporte de pagos. Por favor, int\xE9ntalo de nuevo.",5e3,this.alertaDashboard)}finally{this.descargandoPagos.set(!1),this.selectsDisabled.set(!1)}})}getNombreMes(e){return["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"][e-1]||""}};r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=y({type:r,selectors:[["app-dashboard-main"]],viewQuery:function(t,o){if(t&1&&ne(pt,7,oe),t&2){let d;de(d=ce())&&(o.alertaDashboard=d.first)}},hostAttrs:[1,"flex","flex-col","w-full","h-full","sm:pl-3","relative","overflow-y-auto","pb-2"],decls:87,vars:21,consts:[["alertaDashboard",""],[1,"max-md:text-xl","text-3xl","text-left","text-base-content","mb-2","max-sm:mb-1"],[1,"grid","grid-cols-[repeat(auto-fit,minmax(200px,1fr))]","max-sm:grid-cols-[repeat(auto-fit,minmax(150px,1fr))]","gap-2"],[1,"max-sm:max-h-24","max-h-32","bg-success/85","shadow-lg","rounded-box","flex","justify-between","max-sm:p-2","p-4","gap-1","items-center","border-0","text-success-content"],[1,"flex","h-full","items-center","justify-start","w-1/2"],["nombreIcono","calendar-number","estilos","max-sm:h-8 h-12 max-sm:w-8 w-12 fill-success-content"],[1,"flex","flex-col","items-end","w-1/2"],[1,"loading","loading-spinner","loading-md","text-success-content"],[1,"max-sm:text-2xl","text-3xl","font-bold"],[1,"max-sm:text-xs","text-sm","text-right"],[1,"max-sm:max-h-24","max-h-32","bg-accent/85","shadow-lg","rounded-box","flex","justify-between","max-sm:p-2","p-4","gap-1","items-center","border-0","text-accent-content"],["nombreIcono","thermometer-outline","estilos","max-sm:h-8 h-12 max-sm:w-8 w-12 fill-accent-content"],[1,"loading","loading-spinner","loading-md","text-accent-content"],[1,"max-sm:max-h-24","max-h-32","bg-warning/85","shadow-lg","rounded-box","flex","justify-between","max-sm:p-2","p-4","gap-1","items-center","border-0","text-warning-content"],["nombreIcono","accessibility","estilos","max-sm:h-8 h-12 max-sm:w-8 w-12 fill-warning-content"],[1,"loading","loading-spinner","loading-md","text-warning-content"],[1,"max-sm:max-h-24","max-h-32","bg-info/85","shadow-lg","rounded-box","flex","justify-between","max-sm:p-2","p-4","gap-1","items-center","border-0","text-info-content"],["nombreIcono","wallet","estilos","max-sm:h-8 h-12 max-sm:w-8 w-12 fill-info-content"],[1,"loading","loading-spinner","loading-md","text-info-content"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-2","mt-2"],[1,"bg-base-100","shadow-lg","rounded-box","p-4"],[1,"flex","w-full","items-center","justify-between","gap-2","mb-2"],[1,"max-sm:text-lg","text-xl","max-sm:w-min","font-bold","flex-grow"],[1,"flex","gap-2","items-center"],["for","anioReservasMes",1,"label","text-sm","font-semibold","text-base-content","md:mb-0"],["id","anioReservasMes",1,"select","select-bordered","select-sm","h-8","rounded-md","pl-1",3,"formControl"],[3,"value"],["class","btn btn-sm btn-secondary p-1 h-8 rounded-md",3,"disabled","click",4,"ngIf"],[3,"data"],["for","mesPromedioHoras",1,"label","text-sm","font-semibold","text-base-content","md:mb-0"],["id","mesPromedioHoras",1,"select","select-bordered","select-sm","h-8","rounded-md","pl-1",3,"formControl"],["for","mesReservasCategoria",1,"label","text-sm","font-semibold","text-base-content","md:mb-0"],["id","mesReservasCategoria",1,"select","select-bordered","select-sm","h-8","rounded-md","pl-1",3,"formControl"],["for","anioRecaudoMensual",1,"label","text-sm","font-semibold","text-base-content","md:mb-0"],["id","anioRecaudoMensual",1,"select","select-bordered","select-sm","h-8","rounded-md","pl-1",3,"formControl"],[1,"btn","btn-sm","btn-secondary","p-1","h-8","rounded-md",3,"click","disabled"],[1,"loading","loading-spinner","loading-sm"],["nombreIcono","document-text-outline","estilos","h-5 w-5 fill-current"]],template:function(t,o){t&1&&(n(0,"h1",1),h(1," Hola "),n(2,"strong"),h(3),s(),h(4,`, bienvenido.
`),s(),n(5,"div",2)(6,"div",3)(7,"div",4),p(8,"app-web-icon",5),s(),n(9,"div",6),D(10,ht,1,0,"span",7)(11,ut,2,1,"span",8),n(12,"span",9),h(13,"Reservas hoy"),s()()(),n(14,"div",10)(15,"div",4),p(16,"app-web-icon",11),s(),n(17,"div",6),D(18,ft,1,0,"span",12)(19,gt,2,1,"span",8),n(20,"span",9),h(21,"Ocupaci\xF3n hoy"),s()()(),n(22,"div",13)(23,"div",4),p(24,"app-web-icon",14),s(),n(25,"div",6),D(26,bt,1,0,"span",15)(27,vt,2,1,"span",8),n(28,"span",9),h(29,"Usuarios hoy"),s()()(),n(30,"div",16)(31,"div",4),p(32,"app-web-icon",17),s(),n(33,"div",6),D(34,xt,1,0,"span",18)(35,yt,3,4,"span",8),n(36,"span",9),h(37,"Recaudado hoy"),s()()()(),n(38,"div",19)(39,"div",20)(40,"div",21)(41,"h2",22),h(42," Reservas por Mes "),s(),n(43,"div",23)(44,"label",24),h(45," A\xF1o: "),s(),n(46,"select",25),H(47,Ct,2,2,"option",26,T),s()(),z(49,St,4,2,"button",27),s(),p(50,"app-chart-reservas-mes",28),s(),n(51,"div",20)(52,"div",21)(53,"h2",22),h(54," Promedio por Horas "),s(),n(55,"div",23)(56,"label",29),h(57," Mes: "),s(),n(58,"select",30),H(59,Mt,2,2,"option",26,T),s()()(),p(61,"app-chart-promedio-horas",28),s(),n(62,"div",20)(63,"div",21)(64,"h2",22),h(65," Reservas por Categor\xEDa "),s(),n(66,"div",23)(67,"label",31),h(68," Mes: "),s(),n(69,"select",32),H(70,_t,2,2,"option",26,T),s()()(),p(72,"app-chart-reservas-categoria",28),s(),n(73,"div",20)(74,"div",21)(75,"h2",22),h(76," Recaudo Mensual "),s(),n(77,"div",23)(78,"label",33),h(79," A\xF1o: "),s(),n(80,"select",34),H(81,Rt,2,2,"option",26,T),s()(),z(83,Et,4,2,"button",27),s(),p(84,"app-chart-recaudo-mensual",28),s()(),p(85,"div",null,0)),t&2&&(l(3),pe(o.usuario().nombre.split(" ")[0]),l(7),O(o.dashboardService.indicadoresQuery.isPending()?10:11),l(8),O(o.dashboardService.indicadoresQuery.isPending()?18:19),l(8),O(o.dashboardService.indicadoresQuery.isPending()?26:27),l(8),O(o.dashboardService.indicadoresQuery.isPending()?34:35),l(12),u("formControl",o.anioReservasPorMesControl),l(),U(o.aniosConReservas()),l(2),u("ngIf",o.authService.tienePermisos(o.permisos.DESCARGAR_RESERVAS_MES)),l(),u("data",o.reservasPorMesQuery.data()||E(15,$)),l(8),u("formControl",o.mesPromedioHorasControl),l(),U(E(16,et)),l(2),u("data",o.promedioPorHorasQuery.data()||E(17,$)),l(8),u("formControl",o.mesReservasCategoriaControl),l(),U(E(18,et)),l(2),u("data",o.reservasPorCategoriaQuery.data()||E(19,$)),l(8),u("formControl",o.anioRecaudoMensualControl),l(),U(o.aniosConReservas()),l(2),u("ngIf",o.authService.tienePermisos(o.permisos.DESCARGAR_RECAUDO_MES)),l(),u("data",o.recaudoMensualQuery.data()||E(20,$)))},dependencies:[Ie,S,xe,ye,Te,Le,Ze,Ve,$e,De,_e,Re,Me,we,Se],styles:[".dashboard-container[_ngcontent-%COMP%]{padding:16px}.welcome-card[_ngcontent-%COMP%]{margin-bottom:20px;border-radius:12px;box-shadow:0 4px 12px #0000000d;background:linear-gradient(135deg,var(--ion-color-primary),var(--ion-color-primary-shade))}.welcome-card[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%], .welcome-card[_ngcontent-%COMP%]   ion-card-subtitle[_ngcontent-%COMP%], .welcome-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#fff}.dashboard-card[_ngcontent-%COMP%]{height:100%;border-radius:12px;transition:transform .3s ease,box-shadow .3s ease}.dashboard-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 8px 16px #0000001a}.dashboard-card[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;text-align:center}.dashboard-card[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:48px;margin-bottom:16px}.dashboard-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]{text-align:center}@media (min-width: 768px){.dashboard-container[_ngcontent-%COMP%]{padding:24px}}"],changeDetection:0});let a=r;return a})();export{Kr as DashboardMainPage};
