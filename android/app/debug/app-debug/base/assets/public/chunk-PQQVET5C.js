import{a as I,b as T}from"./chunk-KTGXZBKE.js";import{A as C,C as l,G as N}from"./chunk-YPFPCNBD.js";import{D as R,H as d,Rb as m,U as p,k as D,pb as P}from"./chunk-U6U25BWF.js";import{a as A,b as E,j as n}from"./chunk-LVXXLD6S.js";var g=N.apiUrl,f=(o,a)=>n(null,null,function*(){let i=new URLSearchParams({codigo:a.codigo}),e=`${g}/pagos/info?${i.toString()}`;return D(o.get(e))});var h=N.apiUrl,u=(o,a)=>n(null,null,function*(){let i=new URLSearchParams({page:(a.pageIndex+1).toString(),limit:a.pageSize.toString()});a.search&&i.append("search",a.search);let e=`${h}/pagos?${i.toString()}`;return D(o.get(e))});var $=(()=>{let a=class a{constructor(){this.http=d(m),this.queryClient=d(C),this._paginacion=p({pageIndex:0,pageSize:10}),this._datosPaginador=p(null),this._filtroTexto=p(""),this.paginacion=P(()=>this._paginacion()),this.datosPaginador=P(()=>this._datosPaginador()),this.filtroTexto=this._filtroTexto.asReadonly(),this.pagosQuery=l(()=>({queryKey:["pagos",this.paginacion(),this._filtroTexto()],queryFn:()=>u(this.http,E(A({},this.paginacion()),{search:this._filtroTexto()})),select:e=>(this._datosPaginador.set(e.meta),e.data)}))}setPaginacion(e){this._paginacion.set(e)}setFiltroTexto(e){this._filtroTexto.set(e),this.setPaginacion(E(A({},this._paginacion()),{pageIndex:0}))}limpiarFiltro(){this._filtroTexto.set("")}prefetchPagos(e){this.queryClient.prefetchQuery({queryKey:["pagos",e,this._filtroTexto()],queryFn:()=>u(this.http,E(A({},e),{search:this._filtroTexto()})),staleTime:1e3*60*5})}obtenerInfoPago(e){return n(this,null,function*(){return f(this.http,e)})}formatearMonto(e){return new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(typeof e=="number"?e:parseFloat(e))}formatearFecha(e){return T(I(e),"MMMM dd yyyy, h:mm a")}formatearFechaCorta(e){return T(I(e),"dd/MM/yyyy")}obtenerMensajeEstado(e){if(!e)return"Estado desconocido.";let s=e.trim().toUpperCase(),t={INICIAL:"La reserva ha sido creada correctamente.",PENDIENTEAP:"La reserva est\xE1 pendiente de aprobaci\xF3n.",APROBADA:"La reserva ha sido aprobada.",COMPLETADA:"La reserva se ha completado correctamente (pagada o agendada)."},O={OK:"Transacci\xF3n aprobada por la entidad financiera.",PENDING:"La transacci\xF3n est\xE1 pendiente de confirmaci\xF3n por parte de la entidad financiera.",EXPIRED:"La transacci\xF3n expir\xF3 antes de completarse. Inicia un nuevo proceso de pago.",NOT_AUTHORIZED:"Transacci\xF3n rechazada por la entidad financiera.",NO_AUTHORIZED:"Transacci\xF3n rechazada por la entidad financiera.",ERROR:"Ocurri\xF3 un error procesando la transacci\xF3n. Intenta nuevamente o contacta soporte."},c={PAGADA:"COMPLETADA",CONFIRMADA:"COMPLETADA",COMPLETADO:"COMPLETADA",COMPLETADA:"COMPLETADA",PENDIENTE:"PENDING",PROCESANDO:"PENDING",RECHAZADO:"NOT_AUTHORIZED",RECHAZADA:"NOT_AUTHORIZED",FAILED:"ERROR",BANK:"PENDING",CAPTURED:"PENDING",CREATED:"PENDING",ENROLLED:"OK"}[s]||s;return t[c]?t[c]:O[c]?O[c]:"Estado desconocido."}obtenerColorEstado(e){if(!e)return"primary";let r=e.trim().toUpperCase(),t={PAGADA:"COMPLETADA",CONFIRMADA:"COMPLETADA",COMPLETADO:"COMPLETADA",PENDIENTE:"PENDING",PROCESANDO:"PENDING",RECHAZADO:"NOT_AUTHORIZED",RECHAZADA:"NOT_AUTHORIZED",FAILED:"ERROR",BANK:"PENDING",CAPTURED:"PENDING",CREATED:"PENDING",ENROLLED:"OK",NO_AUTHORIZED:"NOT_AUTHORIZED",CANCELADA:"CANCELADA"}[r]||r;return["OK","COMPLETADA","APROBADA"].includes(t)?"success":["PENDING","PENDIENTEAP"].includes(t)?"warning":["NOT_AUTHORIZED","ERROR","EXPIRED","CANCELADA"].includes(t)?"error":["INICIAL"].includes(t)?"info":"primary"}obtenerMensajeEstadoBadge(e){if(!e)return"desconocido";let r=e.trim().toUpperCase(),t={PAGADA:"COMPLETADA",CONFIRMADA:"COMPLETADA",COMPLETADO:"COMPLETADA",PENDIENTE:"PENDING",PROCESANDO:"PENDING",RECHAZADO:"NOT_AUTHORIZED",RECHAZADA:"NOT_AUTHORIZED",FAILED:"ERROR",BANK:"PENDING",CAPTURED:"PENDING",CREATED:"PENDING",ENROLLED:"OK",NO_AUTHORIZED:"NOT_AUTHORIZED",CANCELADA:"CANCELADA"}[r]||r;return{INICIAL:"creada",PENDIENTEAP:"pendiente aprobaci\xF3n",APROBADA:"aprobada",COMPLETADA:"completada",CANCELADA:"cancelada",OK:"aprobado",PENDING:"pendiente",EXPIRED:"expirado",NOT_AUTHORIZED:"rechazado",ERROR:"error"}[t]||"desconocido"}};a.\u0275fac=function(r){return new(r||a)},a.\u0275prov=R({token:a,factory:a.\u0275fac,providedIn:"root"});let o=a;return o})();export{$ as a};
