import{a as Pe}from"./chunk-I7IWUYYH.js";import{a as fe,b as ue,c as _e,d as xe,f as X,g as be,h as he,i as Y,j as Ce,k as ve}from"./chunk-KWYFY7T2.js";import{a as B}from"./chunk-ZU7Q4APP.js";import{a as ge}from"./chunk-NH3QUD4I.js";import{a as z}from"./chunk-PQQVET5C.js";import"./chunk-KTGXZBKE.js";import"./chunk-LKADUWP6.js";import"./chunk-6CQPCFUJ.js";import"./chunk-AI3LD7IZ.js";import{a as me}from"./chunk-ODBDBKE7.js";import"./chunk-XPPSGRKL.js";import{h as U}from"./chunk-4HN4PAFJ.js";import{i as N}from"./chunk-AV73RGVI.js";import{f as L}from"./chunk-N4CCYIXR.js";import"./chunk-UAEYNMJW.js";import{z as pe}from"./chunk-YPFPCNBD.js";import{Aa as O,Ba as g,Ca as r,Da as i,Db as se,Ea as m,Fa as D,Ga as j,H as _,Ia as E,Ja as P,Ka as p,Lb as V,N as b,O as h,Ra as S,Sa as R,Ta as H,U as w,Xa as d,Ya as oe,Za as f,_b as de,aa as k,bc as ce,c as W,da as s,fb as ae,ha as M,hb as ie,ia as I,ib as re,lb as q,na as T,qb as le,rb as J,sb as $,ta as A,tb as y,u as ee,v as te,va as C,wa as v,z as ne,za as F}from"./chunk-U6U25BWF.js";import"./chunk-B3LSNZRN.js";import"./chunk-WUBXWBRT.js";import"./chunk-B52GHH4C.js";import"./chunk-KZ3CI6ZI.js";import"./chunk-HC6MZPB3.js";import"./chunk-SV2ZKNWA.js";import"./chunk-IA5KSSRM.js";import"./chunk-RS5W3JWO.js";import"./chunk-XENCGOZ2.js";import"./chunk-XZRAAXKF.js";import"./chunk-7D6K5XYM.js";import"./chunk-OBXDPQ3V.js";import"./chunk-QY5CJPR3.js";import"./chunk-MCRJI3T3.js";import"./chunk-ZD4SBDZ6.js";import"./chunk-NCLOD2DI.js";import"./chunk-UYQ7EZNZ.js";import"./chunk-BAKMWPBW.js";import"./chunk-AESNPOCP.js";import"./chunk-H3ZVKW6B.js";import"./chunk-HMK4XMX7.js";import"./chunk-E7UUDSES.js";import"./chunk-JQ3FRJ6A.js";import"./chunk-3IVKBF6N.js";import"./chunk-NMYJD6OP.js";import"./chunk-C5RQ2IC2.js";import"./chunk-SV7S5NYR.js";import{a as G,b as K,j as Z}from"./chunk-LVXXLD6S.js";var Ee=["dialogPagoInfo"];function Me(e,a){e&1&&(r(0,"div",7),m(1,"span",12),r(2,"span"),d(3,"Cargando informaci\xF3n del pago..."),i()())}function Ie(e,a){if(e&1){let n=E();r(0,"div",8)(1,"div",13)(2,"span"),d(3),i()(),r(4,"button",14),P("click",function(){b(n);let o=p();return h(o.onRecargar())}),d(5," Reintentar "),i()()}if(e&2){let n=p();s(3),oe(n.error())}}function Te(e,a){if(e&1&&m(0,"app-pago-info-card",9),e&2){let n=p();g("pagoInfo",n.pagoInfo())("formatearMonto",n.formatearMonto)("formatearFecha",n.formatearFecha)("obtenerMensajeEstado",n.obtenerMensajeEstado)}}var ye=(()=>{let a=class a{constructor(){this.pagosService=_(z),this.abierto=$(!1),this.cargando=$(!1),this.error=$(null),this.pagoInfo=$(null),this.cerrar=J(),this.recargar=J(),this.dialogRef=y("dialogPagoInfo"),this.formatearMonto=this.pagosService.formatearMonto.bind(this.pagosService),this.formatearFecha=this.pagosService.formatearFecha.bind(this.pagosService),this.obtenerMensajeEstado=this.pagosService.obtenerMensajeEstado.bind(this.pagosService),le(()=>{let t=this.dialogRef()?.nativeElement;t&&(this.abierto()?t.open||t.showModal():t.open&&t.close())})}onCerrar(){this.cerrar.emit()}onRecargar(){this.recargar.emit()}};a.\u0275fac=function(o){return new(o||a)},a.\u0275cmp=I({type:a,selectors:[["modal-pago-info"]],viewQuery:function(o,l){o&1&&S(l.dialogRef,Ee,5),o&2&&R()},inputs:{abierto:[1,"abierto"],cargando:[1,"cargando"],error:[1,"error"],pagoInfo:[1,"pagoInfo"]},outputs:{cerrar:"cerrar",recargar:"recargar"},decls:15,vars:1,consts:[["dialogPagoInfo",""],[1,"modal","p-0","z-50"],[1,"modal-box","max-w-4xl","w-full","relative","p-0"],[1,"sticky","top-0","bg-base-100","z-10","border-b","border-base-300","px-4","py-4","flex","justify-between","items-center"],[1,"text-lg","font-bold"],["type","button","aria-label","Cerrar modal",1,"btn","btn-xs","btn-circle","btn-neutral","btn-outline",3,"click"],["nombreIcono","close-outline","estilos","h-5 w-5"],[1,"flex","flex-col","items-center","py-12","gap-2"],[1,"flex","flex-col","items-center","gap-4","py-8"],[3,"pagoInfo","formatearMonto","formatearFecha","obtenerMensajeEstado"],[1,"modal-action","sticky","bottom-0","bg-base-100","p-2","border-t","border-base-300"],["type","button",1,"btn","btn-ghost","h-11","rounded-box",3,"click"],[1,"loading","loading-spinner","loading-lg","text-primary"],[1,"alert","alert-error","w-full"],[1,"btn","btn-primary",3,"click"]],template:function(o,l){if(o&1){let u=E();r(0,"dialog",1,0)(2,"div",2)(3,"div",3)(4,"h3",4),d(5,"Informaci\xF3n del Pago"),i(),r(6,"button",5),P("click",function(){return b(u),h(l.onCerrar())}),m(7,"app-web-icon",6),i()(),r(8,"div"),C(9,Me,4,0,"div",7)(10,Ie,6,1,"div",8)(11,Te,1,4,"app-pago-info-card",9),i(),r(12,"div",10)(13,"button",11),P("click",function(){return b(u),h(l.onCerrar())}),d(14," Cerrar "),i()()()()}o&2&&(s(9),v(l.cargando()?9:l.error()?10:l.pagoInfo()?11:-1))},dependencies:[V,ge,U],styles:[".modal-box[_ngcontent-%COMP%]{max-height:90vh;overflow-y:auto}"],changeDetection:0});let e=a;return e})();var Fe=["estadoCell"],Oe=["montoCell"],Re=["fechaCell"],Ve=["alertaPago"],ze=(e,a,n,t)=>({"badge min-w-26 !max-sm:text-xs !text-sm !font-semibold align-middle":!0,"badge-success":e,"badge-warning":a,"badge-error":n,"badge-primary":t}),Q=(e,a)=>a.id;function Ae(e,a){if(e&1&&(r(0,"div",10),d(1),ie(2,"upperFirst"),i()),e&2){let n=a.$implicit,t=p();g("ngClass",ae(4,ze,t.pagosService.obtenerColorEstado(n.getValue())==="success",t.pagosService.obtenerColorEstado(n.getValue())==="warning",t.pagosService.obtenerColorEstado(n.getValue())==="error",t.pagosService.obtenerColorEstado(n.getValue())==="primary")),s(),f(" ",re(2,2,t.pagosService.obtenerMensajeEstadoBadge(n.getValue()))," ")}}function $e(e,a){if(e&1&&(r(0,"span",11),d(1),i()),e&2){let n=a.$implicit,t=p();s(),f(" ",t.pagosService.formatearMonto(n.getValue())," ")}}function Qe(e,a){if(e&1&&(r(0,"span",12),d(1),i()),e&2){let n=a.$implicit,t=p();s(),f(" ",t.pagosService.formatearFechaCorta(n.getValue())," ")}}function ke(e,a){if(e&1&&(D(0),m(1,"span",15),j()),e&2){let n=a.$implicit;s(),g("innerHTML",n,k)}}function De(e,a){if(e&1&&T(0,ke,2,1,"ng-container",14),e&2){let n=p().$implicit;g("flexRender",n.column.columnDef.header)("flexRenderProps",n.getContext())}}function je(e,a){if(e&1&&(r(0,"th",13),C(1,De,1,2,"ng-container"),i()),e&2){let n=a.$implicit;g("colSpan",n.colSpan),s(),v(n.isPlaceholder?-1:1)}}function He(e,a){if(e&1&&(r(0,"tr"),F(1,je,2,2,"th",13,Q),i()),e&2){let n=a.$implicit;s(),O(n.headers)}}function qe(e,a){if(e&1&&(r(0,"tr")(1,"td",16)(2,"div",17),m(3,"span",18),r(4,"span"),d(5,"Cargando pagos..."),i()()()()),e&2){let n=p();s(),A("colspan",n.tablaPagos.getAllColumns().length)}}function Le(e,a){if(e&1&&(r(0,"tr")(1,"td",16)(2,"div",19)(3,"span"),d(4,"Error al cargar los pagos. Intenta nuevamente."),i()()()()),e&2){let n=p();s(),A("colspan",n.tablaPagos.getAllColumns().length)}}function Ne(e,a){if(e&1&&(r(0,"tr")(1,"td",20)(2,"span"),d(3,"No hay pagos a\xFAn..."),i()()()),e&2){let n=p();s(),A("colspan",n.tablaPagos.getAllColumns().length)}}function Ue(e,a){if(e&1&&(D(0),m(1,"div",24),j()),e&2){let n=a.$implicit;s(),g("innerHTML",n,k)}}function Be(e,a){if(e&1&&(r(0,"td",22),T(1,Ue,2,1,"ng-container",14),i()),e&2){let n=a.$implicit;s(),g("flexRender",n.column.columnDef.cell)("flexRenderProps",n.getContext())}}function Ge(e,a){if(e&1&&(D(0),m(1,"div",24),j()),e&2){let n=a.$implicit;s(),g("innerHTML",n,k)}}function Ke(e,a){if(e&1&&(r(0,"li",31)(1,"span",32),d(2),i(),T(3,Ge,2,1,"ng-container",14),i()),e&2){let n=p().$implicit,t=p(3).$implicit;p(2);let o=H(8);s(2),f(" ",n.columnDef.header,": "),s(),g("flexRender",o.getCell(n,t).column.columnDef.cell)("flexRenderProps",o.getCell(n,t).getContext())}}function We(e,a){if(e&1&&C(0,Ke,4,3,"li",31),e&2){let n=a.$implicit;p(5);let t=H(8);v(t.hiddenColumnIds().has(n.id)?0:-1)}}function Je(e,a){if(e&1&&(m(0,"div",29),r(1,"div",30)(2,"ul"),F(3,We,1,1,null,null,Q),i()()),e&2){let n=p(4);s(3),O(n.tablaPagos.getAllLeafColumns())}}function Xe(e,a){if(e&1&&(r(0,"tr",23)(1,"td")(2,"div",25)(3,"h4",26),d(4," Informaci\xF3n del pago "),i(),r(5,"div",27)(6,"span",28)(7,"strong"),d(8,"C\xF3digo:"),i(),d(9),i(),r(10,"span",12)(11,"strong"),d(12,"Creado en:"),i(),d(13),i(),r(14,"span",12)(15,"strong"),d(16,"Actualizado en:"),i(),d(17),i(),r(18,"span",12)(19,"strong"),d(20,"Ticket:"),i(),d(21),i()(),C(22,Je,5,0),i()()()),e&2){let n=p().$implicit,t=p(2),o=H(8);s(),A("colspan",n.getVisibleCells().length+1),s(8),f(" ",n.original.codigo.toUpperCase()," "),s(4),f(" ",t.pagosService.formatearFecha(n.original.creado_en)," "),s(4),f(" ",t.pagosService.formatearFecha(n.original.actualizado_en)," "),s(4),f(" ",n.original.ticket_id," "),s(),v(o.hiddenColumnIds().size!==0?22:-1)}}function Ye(e,a){if(e&1&&(r(0,"tr",21),F(1,Be,2,2,"td",22,Q),i(),C(3,Xe,23,6,"tr",23)),e&2){let n=a.$implicit;s(),O(n.getVisibleCells()),s(2),v(n.getIsExpanded()?3:-1)}}function Ze(e,a){if(e&1&&F(0,Ye,4,1,null,null,Q),e&2){let n=p();O(n.tablaPagos.getRowModel().rows)}}function et(e,a){e&1&&m(0,"app-table-expansor",33)(1,"modal-pago-info",34),e&2&&(g("isExpanded",!1),s(),g("abierto",!1))}var we=(()=>{let a=class a{constructor(){this.router=_(ce),this.route=_(de),this.authService=_(L),this.appService=_(N),this.pagosService=_(z),this.alertaService=_(B),this.Math=Math,this.estadoCell=y.required("estadoCell"),this.montoCell=y.required("montoCell"),this.fechaCell=y.required("fechaCell"),this._modalAbierto=w(!1),this._pagoInfo=w(null),this._cargandoInfo=w(!1),this._errorInfo=w(null),this._ultimoCodigo=w(null),this.modalAbierto=()=>this._modalAbierto(),this.pagoInfo=()=>this._pagoInfo(),this.cargandoInfo=()=>this._cargandoInfo(),this.errorInfo=()=>this._errorInfo(),this.columnasPorDefecto=w([{id:"expansor",header:"",size:40,cell:t=>X(Y,{inputs:{isExpanded:t.row.getIsExpanded(),disabled:this.appService.editando()},outputs:{toggleExpand:()=>this.onToggleRow(t.row)}})},{id:"fecha",accessorKey:"creado_en",header:"Fecha",size:100,cell:this.fechaCell},{id:"monto",accessorKey:"valor",header:"Monto",size:100,cell:this.montoCell},{id:"estado",accessorKey:"estado",header:"Estado",cell:this.estadoCell},{id:"usuario",accessorFn:t=>{let o=t.reserva?.usuario_reserva;return!o&&t.mensualidad&&(o=t.mensualidad.usuario),o&&`${o.persona?.primer_nombre||""} ${o.persona?.segundo_nombre||""} ${o.persona?.primer_apellido||""} ${o.persona?.segundo_apellido||""}`||"N/A"},header:"Usuario",cell:t=>`<span class="max-sm:text-sm text-base">${t.getValue()}</span>`},{id:"espacio",accessorFn:t=>{let o=t.reserva?.espacio;return!o&&t.mensualidad&&(o=t.mensualidad.espacio),o?.nombre||"N/A"},header:"Espacio",cell:t=>`<span class="max-sm:text-sm text-base">${t.getValue()}</span>`},{id:"acciones",header:"Acciones",cell:t=>{let o=[{tooltip:"Ver detalles",icono:"eye-outline",color:"secondary",disabled:this.appService.editando(),eventoClick:()=>this.verDetallesPago(t.row.original)}];return X(Pe,{inputs:{visibles:t.column.getIsVisible(),acciones:o}})}}]),this.alertaPago=y.required("alertaPago",{read:M}),this.tableState=w({expanded:{},globalFilter:""}),this.tablaPagos=he(()=>({data:this.pagosQuery.data()??[],columns:this.columnasPorDefecto(),getCoreRowModel:fe(),getPaginationRowModel:xe(),getRowCanExpand:()=>!0,autoResetExpanded:!1,getFilteredRowModel:_e(),getExpandedRowModel:ue(),manualPagination:!0,autoResetPageIndex:!1,state:{pagination:this.pagosService.paginacion(),expanded:this.tableState().expanded,globalFilter:this.tableState().globalFilter},onPaginationChange:t=>{let o=typeof t=="function"?t(this.pagosService.paginacion()):t;this.pagosService.setPaginacion({pageIndex:o.pageIndex,pageSize:o.pageSize})},onExpandedChange:t=>{let o=typeof t=="function"?t(this.tableState().expanded):t;this.tableState.update(l=>K(G({},l),{expanded:o}))}}))}ngOnInit(){}get pagosQuery(){return this.pagosService.pagosQuery}onToggleRow(t){let o=t.id,u=this.tableState().expanded[o]?{}:{[o]:!0};this.tableState.update(c=>K(G({},c),{expanded:u}))}verDetallesPago(t){this._modalAbierto.set(!0),this.cargarInfoPago(t.codigo)}onPageChange(t){this.pagosService.setPaginacion(t)}cerrarModal(){this._modalAbierto.set(!1),this._pagoInfo.set(null),this._errorInfo.set(null),this.pagosService.pagosQuery.refetch()}cargarInfoPago(t){return Z(this,null,function*(){try{this._cargandoInfo.set(!0),this._errorInfo.set(null),this._pagoInfo.set(null),this._ultimoCodigo.set(t);let{data:o}=yield this.pagosService.obtenerInfoPago({codigo:t});if(!o)throw new Error("No se encontr\xF3 informaci\xF3n del pago");this._pagoInfo.set(o)}catch(o){this._errorInfo.set(o.message||"Error al cargar la informaci\xF3n")}finally{this._cargandoInfo.set(!1)}})}recargarInfoPago(){let t=this._ultimoCodigo();t&&this.cargarInfoPago(t)}};a.\u0275fac=function(o){return new(o||a)},a.\u0275cmp=I({type:a,selectors:[["tabla-pagos"]],viewQuery:function(o,l){o&1&&(S(l.estadoCell,Fe,5),S(l.montoCell,Oe,5),S(l.fechaCell,Re,5),S(l.alertaPago,Ve,5,M)),o&2&&R(4)},decls:22,vars:13,consts:[["estadoCell",""],["montoCell",""],["fechaCell",""],["tabla","responsiveTable"],["alertaPago",""],[1,"overflow-x-auto"],["responsiveTable","",1,"table","w-full","rounded-box","table-sm","sm:table-md",3,"table"],[1,"sticky","top-0","bg-base-100","rounded-t-box"],[3,"cambioPaginacion","prefetchFunction","ngClass","estado","paginacion","mostrarInfo","mostrarSelectorTamano","mostrarExtremos","deshabilitado"],[3,"cerrar","recargar","abierto","cargando","error","pagoInfo"],[3,"ngClass"],[1,"font-bold","max-sm:text-sm","text-base","text-success"],[1,"max-sm:text-sm","text-base"],[1,"p-2","text-left","first:rounded-tl-box","last:rounded-tr-box","bg-base-100",3,"colSpan"],[4,"flexRender","flexRenderProps"],[1,"text-left","max-sm:text-sm","text-base","text-base-content",3,"innerHTML"],[1,"text-center","py-6"],[1,"flex","flex-col","items-center","gap-2"],[1,"loading","loading-spinner","loading-md","text-primary"],[1,"alert","alert-error","justify-center"],[1,"text-center","text-gray-500"],[1,"bg-base-100"],[1,"py-1"],[1,"bg-base-300","border-none"],[3,"innerHTML"],[1,"bg-base-100","rounded-lg","p-2","md:p-4","shadow-md","w-full"],[1,"text-lg","font-semibold","mb-1","md:mb-4","text-center"],[1,"grid","w-full","grid-cols-1","md:grid-cols-3","gap-4","text-sm"],[1,"max-sm:text-sm","text-base","truncate","text-ellipsis"],[1,"divider","max-md:my-1","my-4"],[1,"space-y-2"],[1,"flex","my-2","flex-row","gap-2","items-center"],[1,"font-bold","max-sm:text-sm","text-base","text-base-content"],[3,"isExpanded"],[3,"abierto"]],template:function(o,l){if(o&1){let u=E();T(0,Ae,3,9,"ng-template",null,0,q)(2,$e,2,1,"ng-template",null,1,q)(4,Qe,2,1,"ng-template",null,2,q),r(6,"div",5)(7,"table",6,3)(9,"thead",7),F(10,He,3,0,"tr",null,Q),i(),r(12,"tbody"),C(13,qe,6,1,"tr")(14,Le,5,1,"tr")(15,Ne,4,1,"tr")(16,Ze,2,0),i()()(),r(17,"app-paginador",8),P("cambioPaginacion",function(x){return b(u),h(l.onPageChange(x))})("prefetchFunction",function(x){return b(u),h(l.pagosService.prefetchPagos(x))}),i(),r(18,"modal-pago-info",9),P("cerrar",function(){return b(u),h(l.cerrarModal())})("recargar",function(){return b(u),h(l.recargarInfoPago())}),i(),m(19,"div",null,4),T(21,et,2,2,"ng-template")}o&2&&(s(7),g("table",l.tablaPagos()),s(3),O(l.tablaPagos.getHeaderGroups()),s(3),v(l.pagosQuery.isLoading()?13:l.pagosQuery.isError()?14:l.pagosQuery.data()&&l.pagosQuery.data().length===0?15:16),s(4),g("ngClass","flex flex-col sm:flex-row items-center justify-between gap-4 p-4 bg-base-100 rounded-b-box")("estado",l.pagosService.paginacion())("paginacion",l.pagosService.datosPaginador()??null)("mostrarInfo",!0)("mostrarSelectorTamano",!0)("mostrarExtremos",!0)("deshabilitado",l.pagosQuery.isFetching()),s(),g("abierto",l.modalAbierto())("cargando",l.cargandoInfo())("error",l.errorInfo())("pagoInfo",l.pagoInfo()))},dependencies:[V,se,be,Ce,me,Y,ye,ve],styles:['@charset "UTF-8";.table[_ngcontent-%COMP%]{overflow:hidden;border-radius:.5rem}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:600;font-size:.875rem;color:#fffc}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:.875rem}.row-expanded[_ngcontent-%COMP%]{background-color:#ffffff1a}.badge[_ngcontent-%COMP%]{font-size:.75rem;font-weight:500}.expanded-info[_ngcontent-%COMP%]{background:linear-gradient(to right,#ffffff0d,#ffffff1a)}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{box-shadow:0 1px 3px #0000001a,0 1px 2px #0000000f}.estado-pagado[_ngcontent-%COMP%]{color:#10b981}.estado-pendiente[_ngcontent-%COMP%]{color:#f59e0b}.estado-rechazado[_ngcontent-%COMP%]{color:#ef4444}@media (max-width: 768px){.table[_ngcontent-%COMP%], .expanded-info[_ngcontent-%COMP%]{font-size:.75rem}}'],changeDetection:0});let e=a;return e})();var tt=["alertaPagos"];function nt(e,a){if(e&1&&(r(0,"div",6)(1,"div",8)(2,"div",9)(3,"div",10),m(4,"app-web-icon",11),i(),r(5,"div",12),d(6," Completados "),i(),r(7,"div",13),d(8),i(),r(9,"div",14),d(10),i()()(),r(11,"div",8)(12,"div",9)(13,"div",15),m(14,"app-web-icon",16),i(),r(15,"div",12),d(16," Pendientes "),i(),r(17,"div",17),d(18),i(),r(19,"div",14),d(20),i()()(),r(21,"div",8)(22,"div",9)(23,"div",18),m(24,"app-web-icon",19),i(),r(25,"div",12),d(26," Rechazados "),i(),r(27,"div",20),d(28),i(),r(29,"div",14),d(30),i()()(),r(31,"div",8)(32,"div",9)(33,"div",21),m(34,"app-web-icon",22),i(),r(35,"div",12),d(36,"Total"),i(),r(37,"div",23),d(38),i(),r(39,"div",14),d(40),i()()()()),e&2){let n=p();s(8),f(" ",n.obtenerEstadisticas().completados.cantidad," "),s(2),f(" ",n.formatearMonto(n.obtenerEstadisticas().completados.total)," "),s(8),f(" ",n.obtenerEstadisticas().pendientes.cantidad," "),s(2),f(" ",n.formatearMonto(n.obtenerEstadisticas().pendientes.total)," "),s(8),f(" ",n.obtenerEstadisticas().rechazados.cantidad," "),s(2),f(" ",n.formatearMonto(n.obtenerEstadisticas().rechazados.total)," "),s(8),f(" ",n.obtenerEstadisticas().total.cantidad," "),s(2),f(" ",n.formatearMonto(n.obtenerEstadisticas().total.total)," ")}}var qt=(()=>{let a=class a{constructor(){this.alertaService=_(B),this.authService=_(L),this.appService=_(N),this.pagosService=_(z),this.alertaPago=y.required("alertaPagos",{read:M}),this.destroy$=new W,this.searchSubject=new W}ngOnInit(){this.searchSubject.pipe(ee(300),te(),ne(this.destroy$)).subscribe(t=>{this.pagosService.setFiltroTexto(t.trim())})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}aplicarFiltro(t){this.searchSubject.next(t)}limpiarFiltro(){this.pagosService.limpiarFiltro()}formatearMonto(t){return this.pagosService.formatearMonto(t)}obtenerEstadisticas(){let t=this.pagosService.pagosQuery.data()||[],o=t.filter(c=>this.pagosService.obtenerColorEstado(c.estado)==="success"),l=t.filter(c=>this.pagosService.obtenerColorEstado(c.estado)==="warning"),u=t.filter(c=>this.pagosService.obtenerColorEstado(c.estado)==="error");return{completados:{cantidad:o.length,total:o.reduce((c,x)=>c+parseFloat(x.valor),0)},pendientes:{cantidad:l.length,total:l.reduce((c,x)=>c+parseFloat(x.valor),0)},rechazados:{cantidad:u.length,total:u.reduce((c,x)=>c+parseFloat(x.valor),0)},total:{cantidad:t.length,total:t.reduce((c,x)=>c+parseFloat(x.valor),0)}}}};a.\u0275fac=function(o){return new(o||a)},a.\u0275cmp=I({type:a,selectors:[["app-pagos-main"]],viewQuery:function(o,l){o&1&&S(l.alertaPago,tt,5,M),o&2&&R()},hostAttrs:[1,"flex","flex-col","w-full","h-full","sm:pl-3","relative","overflow-y-auto"],decls:11,vars:3,consts:[["alertaPagos",""],[1,"flex","flex-col","md:flex-row","md:pr-2","w-full","pb-2","md:pb-4","items-stretch","justify-center","md:justify-between","sticky","top-0","z-30","bg-base-300","py-1"],[1,"flex","items-center","justify-center","sm:justify-start"],[1,"font-bold","text-4xl","max-sm:text-2xl","mb-1","md:mb-0"],[1,"flex","max-sm:px-1","flex-col","md:flex-row","max-md:gap-1","gap-2"],["type","text","placeholder","Buscar por c\xF3digo, usuario, ticket o fecha",1,"input","input-bordered","max-sm:input-sm","input-primary","w-full","sm:h-11","pr-10","rounded-box","md:max-w-xs","placeholder:text-gray-500","placeholder:text-sm","disabled:placeholder:text-gray-400",3,"input","disabled","value"],[1,"grid","px-1","grid-cols-2","lg:grid-cols-4","max-md:gap-1","gap-4","max-md:mb-2","mb-6"],[1,"bg-base-100","rounded-box","p-1","md:p-4"],[1,"stats","shadow","bg-base-100"],[1,"stat","max-sm:gap-x-1","max-md:gap-x-2"],[1,"stat-figure","text-success"],["nombreIcono","checkmark-circle-outline","estilos","h-8 w-8"],[1,"stat-title","font-semibold","max-sm:text-xs","text-sm"],[1,"stat-value","text-success"],[1,"stat-desc","font-semibold","max-sm:text-xs","text-sm"],[1,"stat-figure","text-warning"],["nombreIcono","time-outline","estilos","h-8 w-8"],[1,"stat-value","text-warning"],[1,"stat-figure","text-error"],["nombreIcono","close-circle-outline","estilos","h-8 w-8"],[1,"stat-value","text-error"],[1,"stat-figure","text-primary"],["nombreIcono","wallet-outline","estilos","h-8 w-8"],[1,"stat-value","text-primary"]],template:function(o,l){if(o&1){let u=E();r(0,"div",1)(1,"div",2)(2,"h2",3),d(3," Gesti\xF3n de Pagos "),i()(),r(4,"div",4)(5,"input",5),P("input",function(x){return b(u),h(l.aplicarFiltro(x.target.value))}),i()()(),C(6,nt,41,8,"div",6),r(7,"div",7),m(8,"tabla-pagos"),i(),m(9,"div",null,0)}o&2&&(s(5),g("disabled",l.appService.editando())("value",l.pagosService.filtroTexto()),s(),v(l.pagosService.pagosQuery.data()&&l.pagosService.pagosQuery.data().length>0?6:-1))},dependencies:[V,pe,U,we],styles:[".pagos-container[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto}.summary-card[_ngcontent-%COMP%]{height:100%;border-radius:12px;box-shadow:0 4px 12px #0000000d}.summary-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]{display:flex;align-items:center;padding:20px}.summary-icon[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:50%;display:flex;align-items:center;justify-content:center;margin-right:16px}.summary-icon[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:28px}.summary-data[_ngcontent-%COMP%]{flex:1}.summary-data[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{margin:0;font-size:14px;font-weight:500;color:var(--ion-color-medium)}.summary-data[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:8px 0 4px;font-size:20px;font-weight:600}.summary-data[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:12px;color:var(--ion-color-medium)}.pagos-list-card[_ngcontent-%COMP%]{margin-top:20px;border-radius:12px;box-shadow:0 4px 12px #0000000d}.pagos-list-card[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%]{font-size:18px;font-weight:600}.pagos-list-card[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--padding-start: 16px;--padding-end: 16px;--padding-top: 12px;--padding-bottom: 12px}.pagos-list-card[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-weight:500;margin-bottom:4px}.pagos-list-card[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--ion-color-medium);font-size:13px}.monto-acciones[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.monto-acciones[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-size:16px}ion-badge[_ngcontent-%COMP%]{padding:8px 12px;border-radius:16px;font-weight:500}"],changeDetection:0});let e=a;return e})();export{qt as PagosMainPage};
