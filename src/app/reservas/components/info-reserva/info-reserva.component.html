<div class="grid grid-cols-1 md:grid-cols-2 gap-1 md:gap-2">
  <!-- Espacio -->
  <div class="flex items-center">
    <app-web-icon
      nombreIcono="home-outline"
      estilos="h-6 w-6 mr-3 text-primary"
    ></app-web-icon>
    <div>
      <span class="text-sm text-base-content/70">Espacio:</span>
      <p class="font-medium">
        {{ resumen()?.nombre_espacio }}
      </p>
    </div>
  </div>

  <!-- Sede -->
  <div class="flex items-center">
    <app-web-icon
      nombreIcono="location-outline"
      estilos="h-6 w-6 mr-3 text-primary"
    ></app-web-icon>
    <div>
      <span class="text-sm text-base-content/70">Sede:</span>
      <p class="font-medium">{{ resumen()?.sede | uppercase }}</p>
    </div>
  </div>

  <!-- Fecha -->
  <div class="flex items-center">
    <app-web-icon
      nombreIcono="calendar-outline"
      estilos="h-6 w-6 mr-3 text-primary"
    ></app-web-icon>
    <div>
      <span class="text-sm text-base-content/70">Fecha:</span>
      <p class="font-medium">
        {{ resumen()?.fecha }}
      </p>
    </div>
  </div>

  <!-- Hora -->
  <div class="flex items-center">
    <app-web-icon
      nombreIcono="time-outline"
      estilos="h-6 w-6 mr-3 text-primary"
    ></app-web-icon>
    <div>
      <span class="text-sm text-base-content/70">Hora de inicio:</span>
      <p class="font-medium">{{ resumen()?.hora_inicio }}</p>
    </div>
  </div>

  <!-- Duración -->
  <div class="flex items-center">
    <app-web-icon
      nombreIcono="hourglass-outline"
      estilos="h-6 w-6 mr-3 text-primary"
    ></app-web-icon>
    <div>
      <span class="text-sm text-base-content/70">Duración:</span>
      <p class="font-medium">{{ resumen()?.duracion | formatearDuracion }}</p>
    </div>
  </div>

  <!-- Usuario -->
  <div class="flex items-center">
    <app-web-icon
      nombreIcono="person-outline"
      estilos="h-6 w-6 mr-3 text-primary"
    ></app-web-icon>
    <div>
      <span class="text-sm text-base-content/70">Reservado por:</span>
      <p class="font-medium">{{ resumen()?.usuario_reserva }}</p>
      <p class="text-sm text-base-content/50">
        {{ resumen()?.codigo_usuario }}
      </p>
    </div>
  </div>
</div>

@if (resumen()?.id && resumen()?.creado_en) {
<div class="mt-2 p-1 bg-accent/10 rounded-lg flex items-center w-full border border-accent">
  <span class="text-xs text-cyan-950 font-semibold">Reserva realizada el: {{ resumen()?.creado_en }}</span>
</div>
}

<!-- Valor del espacio -->
@if (resumen()?.valor && resumen()?.valor! > 0) {
<div class="mt-2 p-2 bg-base-100 rounded-lg border border-base-300">
  <div class="flex items-center justify-between">
    <div class="flex items-center">
      <app-web-icon
        nombreIcono="card-outline"
        estilos="h-5 w-5 max-sm:mr-1 mr-3 text-success"
      ></app-web-icon>
      <span class="max-sm:text-base text-lg font-semibold"
        >Valor del espacio:</span
      >
    </div>
    <div class="flex gap-1 items-center">
      @if (resumen()?.porcentaje_descuento && resumen()?.porcentaje_descuento! >
      0) {
      <span
        class="text-sm md:text-base line-through text-base-content/70 italic mr-2"
      >
        ${{ resumen()?.valor || 0 | number : '1.0-0' }}
      </span>
      }
      <span class="max-sm:text-xl text-2xl font-bold text-success">
        ${{ resumen()?.valor_descuento || 0 | number : '1.0-0' }}
      </span>

      @if (resumen()?.porcentaje_descuento && resumen()?.porcentaje_descuento! >
      0) {
      <ng-container>
        <span
          class="text-xs badge badge-secondary font-bold rounded px-2 py-0.5"
        >
          -{{ resumen()?.porcentaje_descuento }}%
        </span>
      </ng-container>
      }
    </div>
  </div>
</div>
}

<!-- Participantes (no incluye al reservante) -->
@if (resumen()?.jugadores && resumen()?.jugadores!.length > 0) {
<div class="mt-2 p-2 bg-base-100 rounded-lg border border-base-300">
  <div class="flex items-center mb-2">
    <app-web-icon
      nombreIcono="people-outline"
      estilos="h-5 w-5 mr-3 text-info"
    ></app-web-icon>
    <span class="text-lg font-semibold"
      >Participantes ({{ (resumen()?.jugadores)!.length }}):</span
    >
  </div>
  <p class="text-sm text-base-content/70 mb-2">
    Reservante: <strong>{{ resumen()?.usuario_reserva }}</strong
    >. La lista a continuación corresponde a los demás participantes.
  </p>
  <div class="space-y-1">
    @for (jugador of resumen()?.jugadores; track jugador.id) {
    <div
      class="flex items-center justify-between bg-info/10 rounded-lg px-3 py-1"
    >
      <div class="flex flex-col max-[380px]:max-w-1/2 gap-0.5">
        <span class="font-semibold text-wrap"
          >{{ jugador.nombre }} {{ jugador.apellido }}</span
        >
        <span class="text-sm italic text-base-content/70">
          <strong>{{ jugador.codigo_tipo_documento }}:</strong>
          {{ jugador.documento || jugador.codigo_usuario }}
          @if (jugador.ldap_uid) {
          <strong>Banner: </strong>{{ jugador.ldap_uid }}
          }
        </span>
      </div>
      <div class="badge badge-info">Confirmado</div>
    </div>
    }
  </div>
</div>
}

<!-- Elementos seleccionados (con cantidades y subtotales) -->
@if (resumen()?.detalles && resumen()?.detalles!.length > 0) {
<div class="mt-2 p-2 bg-base-100 rounded-lg border border-base-300">
  <div class="flex items-center mb-2">
    <app-web-icon
      nombreIcono="briefcase-outline"
      estilos="h-5 w-5 mr-3 text-secondary"
    ></app-web-icon>
    <span class="text-lg font-semibold">Elementos:</span>
  </div>
  <div class="space-y-1">
    @for (el of resumen()?.detalles; track el.id) {
    <div
      class="flex items-center justify-between bg-secondary/5 rounded px-2 py-1 gap-2"
    >
      <div class="flex flex-col min-w-0">
        <span class="text-sm font-medium truncate">{{ el.nombre }}</span>
        <span class="text-xs text-base-content/70">
          Cant: {{ el.cantidad_seleccionada || 1 }} x ${{
            precioElemento(el) | number : '1.0-0'
          }}
        </span>
      </div>
      <span class="text-sm font-semibold text-base-content/80">
        ${{
          precioElemento(el) * (el.cantidad_seleccionada || 1)
            | number : '1.0-0'
        }}
      </span>
    </div>
    }
  </div>
  @if (resumen()?.valor_elementos) {
  <div class="flex items-center justify-between mt-2 pt-2 border-t">
    <span class="text-sm font-semibold">Subtotal elementos:</span>
    <span class="text-sm font-bold"
      >${{ resumen()?.valor_elementos || 0 | number : '1.0-0' }}</span
    >
  </div>
  }
</div>
}

<!-- Total a pagar (espacio + elementos) -->
@if (resumen()?.valor_total_reserva) {
<div class="mt-2 p-2 bg-base-100 rounded-lg border border-base-300">
  <div class="flex items-center justify-between">
    <div class="flex items-center">
      <app-web-icon
        nombreIcono="cash-outline"
        estilos="h-5 w-5 max-sm:mr-1 mr-3 text-primary"
      ></app-web-icon>
      <span class="max-sm:text-base text-lg font-semibold"
        >Total
        {{
          ['completada', 'cancelada', 'pagada'].includes(
            resumen()?.estado ?? ''
          )
            ? 'pagado'
            : 'a pagar'
        }}:</span
      >
    </div>
    <div class="flex gap-1 items-center">
      <span class="max-sm:text-xl text-2xl font-bold text-primary">
        ${{ resumen()?.valor_total_reserva || 0 | number : '1.0-0' }}
      </span>
    </div>
  </div>
</div>
}

<!-- Agregar una sección para dar una breve información acerca del pago, si es un movimiento tiene que decir pagado con cŕeditos, si es un pago tiene que decir código del pago y estado -->

@if (resumen()?.id && resumen()?.pago !== null) {
<div
  class="text-center flex flex-col items-start text-base-content/70 mt-2 p-2 rounded-lg border"
  [ngClass]="{
    'border-success bg-success/10 text-success-content':
      obtenerInfoPago()?.estado === 'Completado',
    'border-warning bg-warning/10 text-warning-content':
      obtenerInfoPago()?.estado === 'Creado',
    'border-error bg-error/10 text-red-950':
      obtenerInfoPago()?.estado && ['Expirado', 'Fallido', 'No Autorizado', 'Error'].includes(obtenerInfoPago()?.estado || ''),
  }"
>
  <h4 class="font-semibold text-base">Información del pago</h4>
  <p class="text-sm">
    Código de pago: <strong>{{ obtenerInfoPago()?.codigoPago }}</strong>
  </p>
  <p class="text-sm">
    Valor pagado:
    <strong>
      ${{ obtenerInfoPago()?.valorPagado || 0 | number : '1.0-0' }}
    </strong>
  </p>
  <p class="text-sm">
    Estado: <strong>{{ obtenerInfoPago()?.estado }}</strong>
  </p>
</div>
}

<!-- Mensaje de éxito final -->
@if (resumen()?.estado === 'completada' && resumen()?.id) {
<div class="text-center text-base-content/70">
  <p class="text-lg">¡Tu reserva ha sido completada exitosamente!</p>
</div>
}
